{
  "hash": "7acdf08e185cd0f14a04a539cfdce92b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tjedan 9: Uzorkovanje, procjena i intervali pouzdanosti\"\nsubtitle: \"Kako iz dijela saznati nešto o cjelini\"\ndate: 2025-04-19\ncategories: [uzorkovanje, centralni granični teorem, intervali pouzdanosti, procjena parametara]\ndraft: false\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n::: {.callout-note}\n## Ishodi učenja\n\nNakon ovog predavanja moći ćete\n\n1. Objasniti razliku između populacije i uzorka te između parametra i statistike.\n2. Opisati kako veličina uzorka utječe na preciznost procjene populacijskog parametra.\n3. Objasniti što je distribucija uzorkovanja (sampling distribution) i zašto je važna.\n4. Opisati centralni granični teorem i demonstrirati ga simulacijom.\n5. Izračunati standardnu pogrešku prosjeka i objasniti njezino značenje.\n6. Konstruirati i interpretirati interval pouzdanosti za prosjek.\n7. Prepoznati uobičajene pristranosti u uzorkovanju i objasniti zašto su online ankete problematične.\n8. Kritički ocijeniti marginu pogreške u medijskim izvještajima o anketama.\n:::\n\n## Temeljni problem statistike\n\nStatistika rješava jedan temeljni problem: želimo znati nešto o cijeloj populaciji, ali nemamo pristup cijeloj populaciji. Želimo znati koliki je prosječni dnevni medijski ekran-time svih odraslih Hrvata, ali ne možemo pitati svaku od 3.5 milijuna odraslih osoba. Želimo znati preferiraju li čitatelji kratke ili dugačke članke, ali ne možemo testirati svaki članak na svakom čitatelju. Želimo znati koliki je CTR novog oglasa, ali ne možemo ga pokazati svim korisnicima interneta.\n\nUmjesto toga, uzimamo **uzorak** (manji dio populacije), mjerimo što nas zanima u uzorku i na temelju toga donosimo zaključak o cijeloj populaciji. Ovo zvuči jednostavno, ali otvara niz pitanja. Koliko veliki uzorak trebamo? Koliko možemo vjerovati procjeni iz uzorka? Kako znamo da uzorak nije pristran?\n\nOvo predavanje daje odgovore na ta pitanja. Koncepti koje ćemo naučiti (distribucija uzorkovanja, centralni granični teorem, standardna pogreška, interval pouzdanosti) su temelj za sve statističke testove koji dolaze u nastavku kolegija.\n\n---\n\n## Naši podaci: populacija i uzorci {#sec-podaci}\n\nZa ovo predavanje imamo luksuz koji u stvarnom životu nikad nemamo: poznajemo cijelu populaciju. Dataset sadrži 50 000 odraslih osoba iz fiktivnog hrvatskog grada, s podacima o dobi, spolu, obrazovanju, primarnom izvoru vijesti, povjerenju u medije i dnevnoj medijskoj konzumaciji.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- read_csv(\"../resources/datasets/media_population.csv\")\nglimpse(pop)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 50,000\nColumns: 8\n$ person_id           <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…\n$ age                 <dbl> 42, 24, 28, 68, 22, 42, 58, 19, 69, 35, 22, 69, 56…\n$ gender              <chr> \"ženski\", \"muški\", \"muški\", \"ženski\", \"muški\", \"mu…\n$ education           <chr> \"viša/prvostupnik\", \"srednja\", \"srednja\", \"osnovna…\n$ primary_news_source <chr> \"portal\", \"društvene mreže\", \"društvene mreže\", \"T…\n$ media_trust         <dbl> 4, 2, 4, 9, 1, 1, 6, 4, 6, 3, 6, 3, 2, 2, 2, 7, 7,…\n$ daily_media_min     <dbl> 178, 130, 120, 224, 127, 198, 248, 153, 293, 174, …\n$ willing_to_pay      <dbl> 0, 14, 0, 45, 0, 11, 0, 32, 42, 0, 0, 48, 0, 26, 0…\n```\n\n\n:::\n:::\n\n\nZato što poznajemo cijelu populaciju, možemo izračunati prave populacijske parametre i onda vidjeti koliko dobro ih procjenjuju uzorci različitih veličina. Ovo je pedagoški trik: u stvarnom istraživanju nikad ne znate populacijske parametre (da ih znate, ne biste trebali statistiku). Ali ovdje ih znamo pa možemo procijeniti kvalitetu naših procjena.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# PRAVI populacijski parametri (u praksi ih NIKAD ne znamo)\npop_params <- pop |>\n  summarise(\n    mu_trust = round(mean(media_trust), 2),\n    sigma_trust = round(sd(media_trust), 2),\n    mu_media_min = round(mean(daily_media_min), 1),\n    sigma_media_min = round(sd(daily_media_min), 1),\n    udio_portal = round(mean(primary_news_source == \"portal\"), 3)\n  )\n\npop_params\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n  mu_trust sigma_trust mu_media_min sigma_media_min udio_portal\n     <dbl>       <dbl>        <dbl>           <dbl>       <dbl>\n1     4.87        1.98         174.            65.5       0.304\n```\n\n\n:::\n:::\n\n\nZapamtite ove brojeve. To su istine o populaciji. Sve što radimo dalje pokušava se približiti ovim vrijednostima iz uzoraka.\n\n---\n\n## Populacija vs uzorak: terminologija {#sec-terminologija}\n\nStatistika strogo razlikuje populaciju i uzorak te njihove mjere.\n\n**Populacija** je cjelokupni skup jedinica o kojima želimo donijeti zaključak. Mjere populacije zovemo **parametri** i označavamo ih grčkim slovima: μ (prosjek), σ (standardna devijacija), π ili p (proporcija).\n\n**Uzorak** je podskup populacije koji zaista mjerimo. Mjere uzorka zovemo **statistike** i označavamo ih latinskim slovima: x̄ (prosjek uzorka), s (standardna devijacija uzorka), p̂ (proporcija uzorka).\n\nStatistike su procjene parametara. Procjena nikad nije savršena jer uzorak nije cijela populacija, ali dobra procjena može biti dovoljno blizu za praktične svrhe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Uzmimo jedan uzorak od 100 osoba\nuzorak_100 <- pop |> slice_sample(n = 100)\n\n# Usporedba parametra i statistike\ntibble(\n  mjera = c(\"Prosjek povjerenja\", \"SD povjerenja\", \"Udio portal\"),\n  populacija = c(\n    round(mean(pop$media_trust), 2),\n    round(sd(pop$media_trust), 2),\n    round(mean(pop$primary_news_source == \"portal\"), 3)\n  ),\n  uzorak_100 = c(\n    round(mean(uzorak_100$media_trust), 2),\n    round(sd(uzorak_100$media_trust), 2),\n    round(mean(uzorak_100$primary_news_source == \"portal\"), 3)\n  )\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  mjera              populacija uzorak_100\n  <chr>                   <dbl>      <dbl>\n1 Prosjek povjerenja      4.87        5.12\n2 SD povjerenja           1.98        2.09\n3 Udio portal             0.304       0.31\n```\n\n\n:::\n:::\n\n\nUzorak od 100 osoba daje procjene koje su blizu populacijskim vrijednostima, ali nisu identične. Razlika između parametra i statistike naziva se **pogreška uzorkovanja** (sampling error). Ovo nije greška u smislu da smo nešto krivo napravili. To je neizbježna posljedica toga što radimo s dijelom umjesto s cjelinom.\n\n---\n\n## Što se događa kad ponovimo uzorkovanje? {#sec-ponavljanje}\n\nKljučan uvid je da bismo, da smo uzeli drugi uzorak od 100 osoba, dobili malo drugačije rezultate. Svaki uzorak je drugačiji. Statistika varira od uzorka do uzorka.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nu1 <- pop |> slice_sample(n = 100) |> summarise(M = round(mean(media_trust), 2)) |> pull(M)\n\nset.seed(2)\nu2 <- pop |> slice_sample(n = 100) |> summarise(M = round(mean(media_trust), 2)) |> pull(M)\n\nset.seed(3)\nu3 <- pop |> slice_sample(n = 100) |> summarise(M = round(mean(media_trust), 2)) |> pull(M)\n\ncat(\"Populacijski prosjek:\", round(mean(pop$media_trust), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPopulacijski prosjek: 4.87 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Uzorak 1 (n=100):\", u1, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUzorak 1 (n=100): 4.73 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Uzorak 2 (n=100):\", u2, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUzorak 2 (n=100): 4.87 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Uzorak 3 (n=100):\", u3, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUzorak 3 (n=100): 4.8 \n```\n\n\n:::\n:::\n\n\nSvaki uzorak daje malo drugačiji prosjek. Ovo je normalno i neizbježno. Pitanje je: koliko ti prosjeci variraju? I kako ta varijacija ovisi o veličini uzorka?\n\n---\n\n## Distribucija uzorkovanja {#sec-distribucija-uzorkovanja}\n\n**Distribucija uzorkovanja** je distribucija statistike (npr. prosjeka) kroz mnogo ponovljenih uzoraka. Zamislite da uzimate 10 000 uzoraka od po 100 osoba iz populacije. Svaki uzorak daje jedan prosjek. Distribucija tih 10 000 prosjeka je distribucija uzorkovanja.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# 10 000 uzoraka od po 100 osoba\nsampling_dist <- tibble(\n  uzorak = 1:10000,\n  prosjek = map_dbl(1:10000, \\(i) {\n    pop |> slice_sample(n = 100) |> pull(media_trust) |> mean()\n  })\n)\n\n# Populacijski prosjek\nmu <- mean(pop$media_trust)\n\nsampling_dist |>\n  ggplot(aes(x = prosjek)) +\n  geom_histogram(fill = \"steelblue\", color = \"white\", bins = 50) +\n  geom_vline(xintercept = mu, color = \"firebrick\", linewidth = 1, linetype = \"dashed\") +\n  labs(\n    title = \"Distribucija uzorkovanja prosjeka povjerenja u medije\",\n    subtitle = \"10 000 uzoraka od po n = 100 iz populacije od 50 000\",\n    x = \"Prosjek uzorka\",\n    y = \"Frekvencija\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/distribucija-uzorkovanja-1.png){width=768}\n:::\n:::\n\n\nTri stvari su odmah uočljive. Prvo, distribucija je centrirana oko pravog populacijskog prosjeka (crvena crta). Ovo znači da je prosjek uzorka **nepristrana procjena** populacijskog prosjeka: ne precjenjuje ni podcjenjuje sustavno. Drugo, distribucija je približno normalna (zvonolika), čak i bez pretpostavke o obliku izvorne distribucije. Treće, distribucija je mnogo uža od distribucije pojedinačnih opažanja: prosjeci manje variraju od pojedinačnih vrijednosti.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usporedba varijabilnosti\ncat(\"SD pojedinačnih opažanja (σ):\", round(sd(pop$media_trust), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSD pojedinačnih opažanja (σ): 1.98 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SD distribucije uzorkovanja:\", round(sd(sampling_dist$prosjek), 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSD distribucije uzorkovanja: 0.2 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Omjer:\", round(sd(pop$media_trust) / sd(sampling_dist$prosjek), 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOmjer: 9.9 \n```\n\n\n:::\n:::\n\n\nSD distribucije uzorkovanja je otprilike 10 puta manji od SD pojedinačnih opažanja. Taj omjer nije slučajan: on je približno jednak √n = √100 = 10. Ovo nas vodi do ključnog koncepta.\n\n---\n\n## Standardna pogreška {#sec-se}\n\n**Standardna pogreška** (standard error, SE) je standardna devijacija distribucije uzorkovanja. Ona mjeri koliko tipično prosjeci uzoraka variraju oko populacijskog prosjeka.\n\nZa prosjek, standardna pogreška se računa formulom:\n\n$$SE = \\frac{\\sigma}{\\sqrt{n}}$$\n\ngdje je σ standardna devijacija populacije, a n veličina uzorka. U praksi ne znamo σ pa koristimo procjenu iz uzorka (s):\n\n$$SE \\approx \\frac{s}{\\sqrt{n}}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Teorijska SE za n = 100\nsigma <- sd(pop$media_trust)\nse_teorijska <- sigma / sqrt(100)\n\n# Procijenjena SE iz jednog uzorka\nset.seed(42)\nuzorak <- pop |> slice_sample(n = 100)\nse_procijenjena <- sd(uzorak$media_trust) / sqrt(100)\n\n# Empirijska SE (iz 10 000 uzoraka)\nse_empirijska <- sd(sampling_dist$prosjek)\n\ncat(\"Teorijska SE:\", round(se_teorijska, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTeorijska SE: 0.198 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Procijenjena SE (iz jednog uzorka):\", round(se_procijenjena, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProcijenjena SE (iz jednog uzorka): 0.209 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Empirijska SE (iz simulacije):\", round(se_empirijska, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEmpirijska SE (iz simulacije): 0.2 \n```\n\n\n:::\n:::\n\n\nSve tri vrijednosti su blizu jedna drugoj. Ovo potvrđuje da formula SE = s/√n dobro procjenjuje stvarnu varijabilnost prosjeka uzoraka.\n\n### Veličina uzorka i preciznost\n\nFormula SE = σ/√n odmah govori nešto fundamentalno: preciznost procjene raste s korijenom veličine uzorka, ne linearno.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\nvelicine <- c(10, 25, 50, 100, 200, 500, 1000, 2000)\n\nsim_se <- map_df(velicine, \\(n) {\n  prosjeci <- map_dbl(1:2000, \\(i) {\n    pop |> slice_sample(n = n) |> pull(media_trust) |> mean()\n  })\n  tibble(n = n, se_empirijska = sd(prosjeci), se_formula = sigma / sqrt(n))\n})\n\nsim_se |>\n  ggplot(aes(x = n)) +\n  geom_line(aes(y = se_empirijska, color = \"Empirijska (simulacija)\"), linewidth = 1) +\n  geom_line(aes(y = se_formula, color = \"Teorijska (σ/√n)\"), linewidth = 1, linetype = \"dashed\") +\n  scale_x_continuous(breaks = velicine) +\n  labs(\n    title = \"Standardna pogreška pada s veličinom uzorka\",\n    subtitle = \"Ali zakon opadajućih prinosa: od 100 do 1000 nije 10x preciznije\",\n    x = \"Veličina uzorka (n)\",\n    y = \"Standardna pogreška\",\n    color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/se-po-velicini-1.png){width=768}\n:::\n:::\n\n\nPad je strm na početku (od n=10 do n=100 je ogromno poboljšanje) ali se postepeno usporava. Da biste prepolovili SE, morate učetverostručiti uzorak. Ovo objašnjava zašto su anketni uzorci obično između 500 i 2000: povećanje iznad toga donosi malo dodatne preciznosti u odnosu na trošak.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_se |>\n  mutate(\n    se_formula = round(se_formula, 3),\n    se_empirijska = round(se_empirijska, 3),\n    raspon_95 = paste0(\"±\", round(1.96 * se_formula, 2))\n  ) |>\n  select(n, se_formula, raspon_95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 3\n      n se_formula raspon_95\n  <dbl>      <dbl> <chr>    \n1    10      0.625 ±1.23    \n2    25      0.395 ±0.77    \n3    50      0.279 ±0.55    \n4   100      0.198 ±0.39    \n5   200      0.14  ±0.27    \n6   500      0.088 ±0.17    \n7  1000      0.062 ±0.12    \n8  2000      0.044 ±0.09    \n```\n\n\n:::\n:::\n\n\nStupac `raspon_95` pokazuje koliko širok je 95% interval oko prosjeka. S uzorkom od 100, prosjek povjerenja je precizan na ±0.39 bodova. S uzorkom od 1000, preciznost je ±0.12 bodova. U praksi, odlučujete kolika je vam preciznost dovoljna i na temelju toga birate veličinu uzorka.\n\n::: {.callout-tip}\n## Praktični savjet\n\nKad čitate medijske izvještaje o anketama, uvijek tražite veličinu uzorka i marginu pogreške. Anketa s n = 500 ima marginu pogreške oko ±4.4 postotna boda za proporcije (na 95% razini). Anketa s n = 1000 ima oko ±3.1. Kad novinar kaže \"stranka A ima 32% a stranka B 29%\", razlika od 3 postotna boda je unutar margine pogreške za većinu anketa. Zaključak \"A vodi\" iz takve ankete nije opravdan.\n:::\n\n---\n\n## Centralni granični teorem {#sec-clt}\n\n**Centralni granični teorem** (Central Limit Theorem, CLT) je najvažniji teorem u cijeloj statistici. Kaže sljedeće:\n\nDistribucija uzorkovanja prosjeka je približno normalna, neovisno o obliku izvorne distribucije, pod uvjetom da je uzorak dovoljno velik.\n\nOvo je izuzetno moćno jer znači da možemo koristiti normalnu distribuciju za donošenje zaključaka o prosjecima čak i kad izvorna varijabla nije normalna.\n\nDemonstrirajmo to na varijabli `willing_to_pay` koja je jako iskrivljena (mnogo nula i dugačak desni rep).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Izvorna distribucija: daleko od normalne\npop |>\n  ggplot(aes(x = willing_to_pay)) +\n  geom_histogram(fill = \"steelblue\", color = \"white\", bins = 40) +\n  labs(\n    title = \"Distribucija spremnosti za plaćanje vijesti (populacija)\",\n    subtitle = \"Jako iskrivljena: mnogo nula, dugačak desni rep\",\n    x = \"Iznos (kn/mjesec)\",\n    y = \"Broj osoba\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/clt-izvorna-1.png){width=768}\n:::\n:::\n\n\nOvo definitivno nije normalna distribucija. Većina ljudi nije spremna platiti ništa, a oni koji jesu spremni plaćaju različite iznose.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Distribucije uzorkovanja za različite veličine uzorka\nclt_sim <- map_df(c(5, 15, 30, 100), \\(n) {\n  prosjeci <- map_dbl(1:5000, \\(i) {\n    pop |> slice_sample(n = n) |> pull(willing_to_pay) |> mean()\n  })\n  tibble(n_label = paste(\"n =\", n), n = n, prosjek = prosjeci)\n}) |>\n  mutate(n_label = fct_reorder(n_label, n))\n\nclt_sim |>\n  ggplot(aes(x = prosjek)) +\n  geom_histogram(aes(y = after_stat(density)), fill = \"steelblue\", color = \"white\", bins = 40) +\n  stat_function(fun = dnorm,\n    args = list(mean = mean(pop$willing_to_pay), \n                sd = sd(pop$willing_to_pay) / sqrt(5)),\n    data = clt_sim |> filter(n == 5),\n    color = \"firebrick\", linewidth = 0.8) +\n  facet_wrap(~n_label, scales = \"free_y\") +\n  labs(\n    title = \"Centralni granični teorem na djelu\",\n    subtitle = \"Što veći uzorak, to normalnija distribucija uzorkovanja\",\n    x = \"Prosjek uzorka (kn/mjesec)\",\n    y = \"Gustoća\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/clt-demonstracija-1.png){width=960}\n:::\n:::\n\n\nRezultat je zapanjujuć. S n = 5, distribucija prosjeka je još uvijek iskrivljena (jer je izvorni oblik još dominantan). S n = 15, već se počinje formirati zvonoliki oblik. S n = 30, distribucija je gotovo savršeno normalna. S n = 100, normalna aproksimacija je izvrsna.\n\nPravilo palca je da je n ≥ 30 obično dovoljno za CLT, ali za jako iskrivljene distribucije može trebati i više. Za približno normalne izvorne distribucije, i n = 10 može biti dovoljno.\n\n### Zašto je CLT toliko važan?\n\nCLT je razlog zašto većina statističkih testova radi. T-test pretpostavlja da je distribucija prosjeka približno normalna. Ne pretpostavlja da su individualna opažanja normalna. Zahvaljujući CLT-u, distribucija prosjeka je (približno) normalna čak i kad individualna opažanja nisu, pod uvjetom da je uzorak dovoljno velik. Ovo daje statistici ogromnu moć jer možemo koristiti iste alate (normalnu distribuciju) na gotovo svaku vrstu podataka.\n\n---\n\n## Pristranosti u uzorkovanju {#sec-pristranosti}\n\nCLT i formula za SE pretpostavljaju da je uzorak **slučajan**: svaka osoba u populaciji ima jednaku šansu biti odabrana. U praksi, ova pretpostavka je često narušena, i to uzrokuje veće probleme od male veličine uzorka.\n\n### Convenience sampling (prigodan uzorak)\n\nNajčešća pristranost u komunikološkim istraživanjima. Anketirate studente na svom kolegiju jer su dostupni. Ali studenti nisu reprezentativni za opću populaciju ni po dobi, ni po obrazovanju, ni po medijskim navikama.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# \"Populacija\" = svi\npop_prosjek_trust <- round(mean(pop$media_trust), 2)\n\n# \"Prigodan uzorak\" = samo mladi (18-24) s visokim obrazovanjem\npristrani_uzorak <- pop |>\n  filter(age <= 24, education %in% c(\"viša/prvostupnik\", \"magistar/doktor\")) |>\n  slice_sample(n = 100)\n\n# \"Slučajni uzorak\" iste veličine\nslucajni_uzorak <- pop |> slice_sample(n = 100)\n\ntibble(\n  izvor = c(\"Populacija\", \"Slučajni uzorak (n=100)\", \"Pristrani uzorak (n=100)\"),\n  prosjek_trust = c(\n    round(mean(pop$media_trust), 2),\n    round(mean(slucajni_uzorak$media_trust), 2),\n    round(mean(pristrani_uzorak$media_trust), 2)\n  ),\n  udio_portal = c(\n    round(mean(pop$primary_news_source == \"portal\"), 3),\n    round(mean(slucajni_uzorak$primary_news_source == \"portal\"), 3),\n    round(mean(pristrani_uzorak$primary_news_source == \"portal\"), 3)\n  )\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  izvor                    prosjek_trust udio_portal\n  <chr>                            <dbl>       <dbl>\n1 Populacija                        4.87       0.304\n2 Slučajni uzorak (n=100)           4.79       0.38 \n3 Pristrani uzorak (n=100)          4.33       0.27 \n```\n\n\n:::\n:::\n\n\nPristrani uzorak daje drugačije procjene od populacijskih vrijednosti. Mladi visokoobrazovani ljudi imaju drugačije medijske navike od opće populacije. Nijedna količina povećanja uzorka ne može ispraviti ovu pristranost: 10 000 studenata i dalje nije reprezentativno za opću populaciju.\n\n### Online ankete i self-selection bias\n\nOnline ankete, koje su izuzetno popularne u komunikološkim istraživanjima, pate od posebnog oblika pristranosti. Odgovaraju samo ljudi koji su online, koji su na toj platformi, koji su vidjeli poziv na anketu i koji su motivirani odgovoriti. Svaki od ovih koraka filtrira populaciju.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulacija: online anketa privlači neproporcijalno mlade korisnike mreža\nonline_uzorak <- pop |>\n  mutate(\n    vjerojatnost_odgovora = case_when(\n      age < 30 & primary_news_source == \"društvene mreže\" ~ 0.15,\n      age < 30 ~ 0.08,\n      age < 50 & primary_news_source %in% c(\"portal\", \"društvene mreže\") ~ 0.06,\n      age < 50 ~ 0.03,\n      age >= 50 & primary_news_source %in% c(\"portal\", \"društvene mreže\") ~ 0.02,\n      .default = 0.005\n    )\n  ) |>\n  mutate(odgovorio = runif(n()) < vjerojatnost_odgovora) |>\n  filter(odgovorio)\n\ncat(\"Veličina online uzorka:\", nrow(online_uzorak), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVeličina online uzorka: 2713 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Usporedba\ntribble(\n  ~karakteristika, ~populacija, ~online_uzorak,\n  \"Prosjek dobi\", round(mean(pop$age), 1), round(mean(online_uzorak$age), 1),\n  \"Udio mlađih od 30\", round(mean(pop$age < 30) * 100, 1), round(mean(online_uzorak$age < 30) * 100, 1),\n  \"Udio portal kao primarni\", round(mean(pop$primary_news_source == \"portal\") * 100, 1), round(mean(online_uzorak$primary_news_source == \"portal\") * 100, 1),\n  \"Udio društvene mreže\", round(mean(pop$primary_news_source == \"društvene mreže\") * 100, 1), round(mean(online_uzorak$primary_news_source == \"društvene mreže\") * 100, 1),\n  \"Prosjek povjerenja\", round(mean(pop$media_trust), 2), round(mean(online_uzorak$media_trust), 2)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  karakteristika           populacija online_uzorak\n  <chr>                         <dbl>         <dbl>\n1 Prosjek dobi                  42.7          31.5 \n2 Udio mlađih od 30             25.7          56.1 \n3 Udio portal kao primarni      30.4          32.1 \n4 Udio društvene mreže          27            48.7 \n5 Prosjek povjerenja             4.87          4.35\n```\n\n\n:::\n:::\n\n\nOnline uzorak je mlađi, koristi više digitalne medije i ima drugačije povjerenje u medije. Čak i s velikim uzorkom, ove procjene su pristrane jer mehanizam uzorkovanja nije slučajan.\n\n::: {.callout-important}\n## Važna napomena\n\nVeličina uzorka i kvaliteta uzorka su dva različita problema. Velik pristran uzorak je gori od malog slučajnog uzorka. Čuveni primjer je anketa Literary Digesta iz 1936. koja je imala 2.4 milijuna odgovora ali je pogrešno predvidjela američke predsjedničke izbore jer je uzorak bio pristran (bogatiji birači). Gallup je s uzorkom od samo 50 000 pogodio rezultat jer je koristio slučajno uzorkovanje. Veličina bez reprezentativnosti ne vrijedi ništa.\n:::\n\n---\n\n## Procjena proporcija {#sec-proporcije}\n\nDo sada smo se fokusirali na procjenu prosjeka. Ali u komunikologiji često procjenjujemo i proporcije (udjele). Koliki je udio ljudi koji portale koriste kao primarni izvor vijesti? Koliki je udio čitatelja koji kliknu na oglas?\n\nStandardna pogreška za proporciju ima drugačiju formulu:\n\n$$SE_p = \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}}$$\n\ngdje je p̂ procijenjena proporcija iz uzorka.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Pravi udio korisnika portala\np_populacija <- mean(pop$primary_news_source == \"portal\")\n\n# Procjena iz uzorka od 500\nuzorak_500 <- pop |> slice_sample(n = 500)\np_hat <- mean(uzorak_500$primary_news_source == \"portal\")\n\nse_p <- sqrt(p_hat * (1 - p_hat) / 500)\n\ncat(\"Populacijski udio portala:\", round(p_populacija, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPopulacijski udio portala: 0.304 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Procjena iz uzorka (n=500):\", round(p_hat, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProcjena iz uzorka (n=500): 0.318 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SE proporcije:\", round(se_p, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSE proporcije: 0.021 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Margina pogreške (95%):\", round(1.96 * se_p, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMargina pogreške (95%): 0.041 \n```\n\n\n:::\n:::\n\n\nMargina pogreške za proporcije ovisi o samoj proporciji. Najveća je kad je p̂ = 0.5 (maksimalna neizvjesnost) i smanjuje se kako se p̂ približava 0 ili 1 (veća izvjesnost). Zato medijske ankete navode \"marginu pogreške ±3%\" koja zapravo vrijedi samo za proporcije oko 50%.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# 5000 uzoraka od po 500 osoba\nprop_sim <- tibble(\n  uzorak = 1:5000,\n  p_hat = map_dbl(1:5000, \\(i) {\n    pop |> slice_sample(n = 500) |> \n      pull(primary_news_source) |>\n      (\\(x) mean(x == \"portal\"))()\n  })\n)\n\nprop_sim |>\n  ggplot(aes(x = p_hat)) +\n  geom_histogram(fill = \"steelblue\", color = \"white\", bins = 40) +\n  geom_vline(xintercept = p_populacija, color = \"firebrick\", linewidth = 1, linetype = \"dashed\") +\n  labs(\n    title = \"Distribucija uzorkovanja za udio korisnika portala\",\n    subtitle = \"5000 uzoraka od po n = 500\",\n    x = \"Procijenjen udio korisnika portala\",\n    y = \"Frekvencija\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/simulacija-proporcije-1.png){width=768}\n:::\n:::\n\n\nDistribucija proporcija uzorka je također normalna (zahvaljujući CLT) i centrirana oko prave populacijske proporcije. Ovo nam omogućuje konstrukciju intervala pouzdanosti za proporcije, što je temelj za interpretaciju anketnih rezultata.\n\n---\n\n## Interval pouzdanosti: osnovna ideja {#sec-ci-uvod}\n\nKad kažemo \"prosječno povjerenje u medije je 4.87\", to je točkasta procjena (point estimate). Problem s točkastom procjenom je da ne govori ništa o tome koliko je precizna. Je li pravi prosjek negdje između 4.5 i 5.2? Ili između 4.85 i 4.89?\n\n**Interval pouzdanosti** (confidence interval, CI) daje raspon vrijednosti unutar kojeg se, s određenom vjerojatnošću, nalazi pravi populacijski parametar.\n\nZa prosjek, 95% interval pouzdanosti je:\n\n$$CI_{95\\%} = \\bar{x} \\pm 1.96 \\times SE$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak <- pop |> slice_sample(n = 200)\n\nx_bar <- mean(uzorak$media_trust)\nse <- sd(uzorak$media_trust) / sqrt(200)\nci_lower <- x_bar - 1.96 * se\nci_upper <- x_bar + 1.96 * se\n\ncat(\"Prosjek uzorka:\", round(x_bar, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProsjek uzorka: 5.07 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SE:\", round(se, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSE: 0.145 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(ci_lower, 2), \",\", round(ci_upper, 2), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 4.79 , 5.35 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pravi populacijski prosjek:\", round(mean(pop$media_trust), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPravi populacijski prosjek: 4.87 \n```\n\n\n:::\n:::\n\n\nInterval pouzdanosti pokriva pravi populacijski prosjek (u ovom slučaju). Ali ne mora uvijek: 5% intervala iz ponovljenih uzoraka neće pokriti pravi parametar. Zato se zove 95% interval, ne 100%.\n\n### Vizualizacija: 100 intervala pouzdanosti\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\nmu_pop <- mean(pop$media_trust)\n\nci_sim <- map_df(1:100, \\(i) {\n  u <- pop |> slice_sample(n = 200)\n  xbar <- mean(u$media_trust)\n  se <- sd(u$media_trust) / sqrt(200)\n  tibble(\n    uzorak = i,\n    xbar = xbar,\n    ci_lo = xbar - 1.96 * se,\n    ci_hi = xbar + 1.96 * se,\n    pokriva_mu = ci_lo <= mu_pop & ci_hi >= mu_pop\n  )\n})\n\ncat(\"Intervala koji pokrivaju pravi prosjek:\", sum(ci_sim$pokriva_mu), \"od 100\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIntervala koji pokrivaju pravi prosjek: 95 od 100\n```\n\n\n:::\n\n```{.r .cell-code}\nci_sim |>\n  ggplot(aes(x = xbar, y = uzorak, color = pokriva_mu)) +\n  geom_point(size = 1.5) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0) +\n  geom_vline(xintercept = mu_pop, color = \"firebrick\", linewidth = 0.8, linetype = \"dashed\") +\n  scale_color_manual(values = c(\"TRUE\" = \"steelblue\", \"FALSE\" = \"#e76f51\"),\n                     labels = c(\"TRUE\" = \"Pokriva μ\", \"FALSE\" = \"Ne pokriva μ\")) +\n  labs(\n    title = \"100 intervala pouzdanosti (95%) iz 100 različitih uzoraka\",\n    subtitle = \"Crvena crta = pravi populacijski prosjek. Narančasti intervali ne pokrivaju pravi parametar.\",\n    x = \"Povjerenje u medije\",\n    y = \"Uzorak\",\n    color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/ci-vizualizacija-1.png){width=864}\n:::\n:::\n\n\nOvaj graf je jedna od najvažnijih vizualizacija u cijelom kolegiju. Svaki horizontalni interval je jedan 95% CI iz zasebnog uzorka. Većina (oko 95) pokriva pravi prosjek (crvena crta). Nekolicina (oko 5) ne pokriva. Ovo je precizno značenje 95% intervala pouzdanosti: 95% takvih intervala, konstruiranih iz ponovljenih uzoraka, pokrit će pravi parametar.\n\n::: {.callout-important}\n## Važna napomena\n\nČesta pogrešna interpretacija je \"postoji 95% šansa da je pravi prosjek unutar ovog intervala.\" Ispravna interpretacija je: \"ako bismo ponovili uzorkovanje mnogo puta i svaki put konstruirali 95% CI, 95% tih intervala bi pokrilo pravi prosjek.\" Razlika zvuči suptilno, ali je konceptualno važna. Pravi prosjek je fiksan broj (nije slučajan). Interval je slučajan (jer ovisi o uzorku). Vjerojatnost se odnosi na postupak, ne na parametar.\n:::\n\n---\n\n\n::: {.callout-note}\n## Podsjetnik\n\nU prvom dijelu predavanja naučili smo da distribucija uzorkovanja prosjeka ima oblik normalne distribucije (CLT), da se njezina širina mjeri standardnom pogreškom SE = s/√n i da 95% interval pouzdanosti pokriva prosjek ± 1.96 × SE. U ovom dijelu prelazimo na alate koji se koriste u praksi: t-distribuciju, funkciju `t.test()` i planiranje veličine uzorka.\n:::\n\n## Od z do t: mali uzorci {#sec-t-distribucija}\n\nDo sada smo koristili z = 1.96 za 95% CI. Ovo je točno kad poznajemo populacijski σ ili kad je uzorak velik (n > 100). Ali u praksi obično ne poznajemo σ pa ga procjenjujemo iz uzorka pomoću s. Za male uzorke, ova dodatna nesigurnost znači da trebamo širi interval.\n\n**t-distribucija** rješava ovaj problem. Izgleda poput normalne distribucije, ali ima deblje repove (veću vjerojatnost ekstremnijih vrijednosti). Oblik t-distribucije ovisi o **stupnjevima slobode** (degrees of freedom, df), koji su za jedan prosjek df = n − 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(-4, 4, length.out = 300)\n\nt_usporedba <- tibble(x = x) |>\n  mutate(\n    `Normalna (z)` = dnorm(x),\n    `t (df = 5)` = dt(x, df = 5),\n    `t (df = 15)` = dt(x, df = 15),\n    `t (df = 50)` = dt(x, df = 50)\n  ) |>\n  pivot_longer(-x, names_to = \"distribucija\", values_to = \"gustoca\") |>\n  mutate(distribucija = fct_relevel(distribucija, \n    \"Normalna (z)\", \"t (df = 50)\", \"t (df = 15)\", \"t (df = 5)\"))\n\nt_usporedba |>\n  ggplot(aes(x = x, y = gustoca, color = distribucija)) +\n  geom_line(linewidth = 1) +\n  scale_color_manual(values = c(\n    \"Normalna (z)\" = \"firebrick\", \n    \"t (df = 5)\" = \"#2a9d8f\", \n    \"t (df = 15)\" = \"#e9c46a\", \n    \"t (df = 50)\" = \"steelblue\"\n  )) +\n  labs(\n    title = \"t-distribucija vs normalna distribucija\",\n    subtitle = \"S više stupnjeva slobode t-distribucija konvergira prema normalnoj\",\n    x = \"Vrijednost\",\n    y = \"Gustoća\",\n    color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/t-vs-normalna-1.png){width=768}\n:::\n:::\n\n\nS df = 5 (uzorak od 6), t-distribucija ima znatno deblje repove od normalne. S df = 50, razlika je jedva vidljiva. Praktična posljedica je da za male uzorke koristimo veći multiplikator od 1.96.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  df = c(5, 10, 15, 25, 50, 100, Inf),\n  n = df + 1,\n  t_95 = round(qt(0.975, df), 3),\n  t_99 = round(qt(0.995, df), 3)\n) |>\n  mutate(n = if_else(is.infinite(df), \"∞ (normalna)\", as.character(n)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 4\n     df n             t_95  t_99\n  <dbl> <chr>        <dbl> <dbl>\n1     5 6             2.57  4.03\n2    10 11            2.23  3.17\n3    15 16            2.13  2.95\n4    25 26            2.06  2.79\n5    50 51            2.01  2.68\n6   100 101           1.98  2.63\n7   Inf ∞ (normalna)  1.96  2.58\n```\n\n\n:::\n:::\n\n\nZa n = 6 (df = 5), kritična vrijednost za 95% CI je 2.571 umjesto 1.960. Interval je značajno širi jer imamo manje podataka pa moramo biti oprezniji. Za n > 100, razlika između t i z je zanemariva i u praksi se često ignorira.\n\n---\n\n## `t.test()`: sve u jednoj funkciji {#sec-t-test}\n\nR ima ugrađenu funkciju `t.test()` koja automatski računa t-interval pouzdanosti. Za sada je koristimo samo za CI (ne za testiranje hipoteza, to dolazi sljedeći tjedan).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak_200 <- pop |> slice_sample(n = 200)\n\n# CI za prosjek povjerenja u medije\nrezultat <- t.test(uzorak_200$media_trust, conf.level = 0.95)\nrezultat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  uzorak_200$media_trust\nt = 34.961, df = 199, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 4.784028 5.355972\nsample estimates:\nmean of x \n     5.07 \n```\n\n\n:::\n:::\n\n\nFunkcija `t.test()` vraća mnogo informacija odjednom. Za interval pouzdanosti nas zanima `conf.int` i `estimate`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pristup pojedinim elementima\ncat(\"Prosjek uzorka:\", round(rezultat$estimate, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProsjek uzorka: 5.07 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(rezultat$conf.int[1], 3), \",\", round(rezultat$conf.int[2], 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 4.784 , 5.356 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Stupnjevi slobode:\", rezultat$parameter, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStupnjevi slobode: 199 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Usporedba s populacijom\ncat(\"\\nProvi populacijski prosjek:\", round(mean(pop$media_trust), 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nProvi populacijski prosjek: 4.867 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pokriva CI pravi prosjek?\", \n    mean(pop$media_trust) >= rezultat$conf.int[1] & \n    mean(pop$media_trust) <= rezultat$conf.int[2], \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPokriva CI pravi prosjek? TRUE \n```\n\n\n:::\n:::\n\n\n### Mijenjanje razine pouzdanosti\n\nMožemo tražiti i 90% ili 99% interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nci_90 <- t.test(uzorak_200$media_trust, conf.level = 0.90)$conf.int\nci_95 <- t.test(uzorak_200$media_trust, conf.level = 0.95)$conf.int\nci_99 <- t.test(uzorak_200$media_trust, conf.level = 0.99)$conf.int\n\nxbar <- mean(uzorak_200$media_trust)\n\ntibble(\n  razina = c(\"90%\", \"95%\", \"99%\"),\n  donja = round(c(ci_90[1], ci_95[1], ci_99[1]), 3),\n  gornja = round(c(ci_90[2], ci_95[2], ci_99[2]), 3),\n  sirina = round(c(diff(ci_90), diff(ci_95), diff(ci_99)), 3)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  razina donja gornja sirina\n  <chr>  <dbl>  <dbl>  <dbl>\n1 90%     4.83   5.31  0.479\n2 95%     4.78   5.36  0.572\n3 99%     4.69   5.45  0.754\n```\n\n\n:::\n:::\n\n\nVeća pouzdanost znači širi interval. 99% CI je širi od 95% jer morate pokriti više mogućih vrijednosti. Postoji kompromis između pouzdanosti i preciznosti: 100% CI bi bio od −∞ do +∞ (potpuno beskoristan ali potpuno siguran). U praksi se najčešće koristi 95% kao konvencija.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_pop <- mean(pop$media_trust)\n\ntibble(\n  razina = factor(c(\"90%\", \"95%\", \"99%\"), levels = c(\"99%\", \"95%\", \"90%\")),\n  lo = c(ci_90[1], ci_95[1], ci_99[1]),\n  hi = c(ci_90[2], ci_95[2], ci_99[2]),\n  xbar = xbar\n) |>\n  ggplot(aes(y = razina)) +\n  geom_errorbarh(aes(xmin = lo, xmax = hi), height = 0.3, linewidth = 1.2, color = \"steelblue\") +\n  geom_point(aes(x = xbar), size = 3, color = \"steelblue\") +\n  geom_vline(xintercept = mu_pop, color = \"firebrick\", linewidth = 0.8, linetype = \"dashed\") +\n  labs(\n    title = \"Veća pouzdanost = širi interval\",\n    subtitle = \"Crvena crta = pravi populacijski prosjek\",\n    x = \"Povjerenje u medije\",\n    y = \"Razina pouzdanosti\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/ci-razine-vizualizacija-1.png){width=672}\n:::\n:::\n\n\n### CI za podgrupe\n\nU praksi nas često zanima CI za specifične podgrupe, ne samo za cijeli uzorak.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak_500 <- pop |> slice_sample(n = 500)\n\nci_po_izvoru <- uzorak_500 |>\n  group_by(primary_news_source) |>\n  filter(n() >= 20) |>\n  summarise(\n    n = n(),\n    prosjek = mean(media_trust),\n    se = sd(media_trust) / sqrt(n()),\n    ci_lo = prosjek - qt(0.975, n() - 1) * se,\n    ci_hi = prosjek + qt(0.975, n() - 1) * se,\n    .groups = \"drop\"\n  )\n\n# Pravi populacijski prosjeci za usporedbu\npop_prosjeci <- pop |>\n  group_by(primary_news_source) |>\n  summarise(mu = mean(media_trust), .groups = \"drop\")\n\nci_po_izvoru |>\n  left_join(pop_prosjeci, by = \"primary_news_source\") |>\n  mutate(primary_news_source = fct_reorder(primary_news_source, prosjek)) |>\n  ggplot(aes(y = primary_news_source)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 1, color = \"steelblue\") +\n  geom_point(aes(x = prosjek), size = 3, color = \"steelblue\") +\n  geom_point(aes(x = mu), size = 3, shape = 4, color = \"firebrick\", stroke = 1.5) +\n  labs(\n    title = \"95% CI za povjerenje u medije po primarnom izvoru vijesti\",\n    subtitle = \"Plavi krug = prosjek uzorka. Crveni X = pravi populacijski prosjek.\",\n    x = \"Povjerenje u medije\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/ci-po-izvoru-1.png){width=768}\n:::\n:::\n\n\nOvaj graf je izuzetno koristan za prezentaciju rezultata. Kad se intervali dviju grupa ne preklapaju, to sugerira statistički značajnu razliku (o čemu ćemo formalno govoriti na predavanju o t-testu). Korisnici radija imaju najviše povjerenje, a korisnici društvenih mreža najmanje.\n\n::: {.callout-tip}\n## Praktični savjet\n\nKad prezentirate rezultate istraživanja, graf s intervalima pouzdanosti govori mnogo više od tablice prosjeka. Uključuje i veličinu uzorka (uži interval = više podataka) i nesigurnost procjene (širi interval = manje sigurni u točnu vrijednost). Naviknite se koristiti ovaj tip grafa.\n:::\n\n---\n\n## Interval pouzdanosti za proporcije {#sec-ci-proporcije}\n\nZa proporcije (udjele), CI se računa malo drugačije jer je SE za proporciju √(p̂(1−p̂)/n).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak_500 <- pop |> slice_sample(n = 500)\n\n# Udio koji koristi portal kao primarni izvor\np_hat <- mean(uzorak_500$primary_news_source == \"portal\")\nse_p <- sqrt(p_hat * (1 - p_hat) / 500)\nci_lo <- p_hat - 1.96 * se_p\nci_hi <- p_hat + 1.96 * se_p\n\ncat(\"Procjena p̂:\", round(p_hat, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProcjena p̂: 0.318 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SE:\", round(se_p, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSE: 0.021 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(ci_lo, 3), \",\", round(ci_hi, 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 0.277 , 0.359 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pravi populacijski udio:\", round(mean(pop$primary_news_source == \"portal\"), 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPravi populacijski udio: 0.304 \n```\n\n\n:::\n:::\n\n\n### `prop.test()` za proporcije\n\nR ima funkciju `prop.test()` koja računa CI za proporcije. Koristi malo drugačiju metodu (Wilsonov interval) koja je preciznija za male uzorke i ekstremne proporcije.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koliko koristi portal od 500 ispitanika?\nn_portal <- sum(uzorak_500$primary_news_source == \"portal\")\n\nprop_rez <- prop.test(n_portal, n = 500, conf.level = 0.95)\n\ncat(\"Procjena:\", round(prop_rez$estimate, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProcjena: 0.318 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(prop_rez$conf.int[1], 3), \",\", round(prop_rez$conf.int[2], 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 0.278 , 0.361 ]\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CI za sve izvore vijesti\nizvore <- unique(pop$primary_news_source)\n\nci_izvore <- map_df(izvore, \\(izvor) {\n  n_da <- sum(uzorak_500$primary_news_source == izvor)\n  test <- prop.test(n_da, n = 500, conf.level = 0.95)\n  tibble(\n    izvor = izvor,\n    p_hat = test$estimate,\n    ci_lo = test$conf.int[1],\n    ci_hi = test$conf.int[2]\n  )\n})\n\n# Pravi populacijski udjeli\npop_udjeli <- pop |>\n  count(primary_news_source) |>\n  mutate(udio = n / sum(n))\n\nci_izvore |>\n  left_join(pop_udjeli, by = c(\"izvor\" = \"primary_news_source\")) |>\n  mutate(izvor = fct_reorder(izvor, p_hat)) |>\n  ggplot(aes(y = izvor)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 1, color = \"steelblue\") +\n  geom_point(aes(x = p_hat), size = 3, color = \"steelblue\") +\n  geom_point(aes(x = udio), size = 3, shape = 4, color = \"firebrick\", stroke = 1.5) +\n  scale_x_continuous(labels = scales::label_percent()) +\n  labs(\n    title = \"95% CI za udio korisnika po primarnom izvoru vijesti\",\n    subtitle = \"Plavi krug = procjena iz uzorka (n=500). Crveni X = pravi populacijski udio.\",\n    x = \"Udio\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/ci-svi-izvori-1.png){width=768}\n:::\n:::\n\n\nOvaj graf otkriva nešto što medijske ankete rijetko prikazuju: nesigurnost oko svakog broja. Portal i društvene mreže se ne mogu jasno razlučiti (intervali se preklapaju). TV i radio se mogu jasno razlučiti (intervali se ne preklapaju). Ovo je razlog zašto je prikaz intervala pouzdanosti uvijek pošteniji od samih postotaka.\n\n---\n\n## Margina pogreške i planiranje uzorka {#sec-planiranje}\n\nU medijskim izvještajima o anketama čujete izraz \"margina pogreške ±3%\". Što to znači i kako se računa?\n\nMargina pogreške (margin of error, MoE) je pola širine intervala pouzdanosti. Za proporcije:\n\n$$MoE = z^* \\times \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$$\n\nAko ne znamo p̂ unaprijed, koristimo najgori slučaj p̂ = 0.5 (koji daje najširu marginu):\n\n$$MoE_{max} = \\frac{z^*}{2\\sqrt{n}}$$\n\nZa 95% CI: MoE_max = 1.96 / (2√n) ≈ 1/√n.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  n = c(100, 200, 400, 500, 800, 1000, 1500, 2000),\n  MoE_95 = round(1.96 * sqrt(0.25 / n) * 100, 1)\n) |>\n  mutate(opis = paste0(\"±\", MoE_95, \"%\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 3\n      n MoE_95 opis \n  <dbl>  <dbl> <chr>\n1   100    9.8 ±9.8%\n2   200    6.9 ±6.9%\n3   400    4.9 ±4.9%\n4   500    4.4 ±4.4%\n5   800    3.5 ±3.5%\n6  1000    3.1 ±3.1%\n7  1500    2.5 ±2.5%\n8  2000    2.2 ±2.2%\n```\n\n\n:::\n:::\n\n\nOvo objašnjava zašto su većina medijskih anketa u rasponu 500 do 1500 ispitanika. S n = 1000, margina je oko ±3.1%. S n = 2000, pada na ±2.2%. Poboljšanje je malo u odnosu na dodatni trošak i vrijeme.\n\n### Obrnuto: koliki uzorak trebam?\n\nČešće pitanje u praksi je obrnuto: imam ciljanu marginu pogreške, koliki mi uzorak treba?\n\n$$n = \\frac{z^{*2} \\times \\hat{p}(1-\\hat{p})}{MoE^2}$$\n\nZa najgori slučaj (p̂ = 0.5):\n\n$$n = \\frac{z^{*2}}{4 \\times MoE^2}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Funkcija za izračun potrebne veličine uzorka\nvelicina_uzorka <- function(moe, conf = 0.95, p = 0.5) {\n  z <- qnorm(1 - (1 - conf) / 2)\n  ceiling(z^2 * p * (1 - p) / moe^2)\n}\n\ntibble(\n  ciljna_MoE = c(\"±5%\", \"±4%\", \"±3%\", \"±2%\", \"±1%\"),\n  moe = c(0.05, 0.04, 0.03, 0.02, 0.01),\n  n_potreban = map_int(moe, velicina_uzorka)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  ciljna_MoE   moe n_potreban\n  <chr>      <dbl>      <int>\n1 ±5%         0.05        385\n2 ±4%         0.04        601\n3 ±3%         0.03       1068\n4 ±2%         0.02       2401\n5 ±1%         0.01       9604\n```\n\n\n:::\n:::\n\n\nZa marginu od ±3% trebate 1068 ispitanika. Za ±2% trebate 2401. Za ±1% trebate čak 9604. Ovo ponovno potvrđuje zakon opadajućih prinosa: svako sljedeće poboljšanje je sve skuplje.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  moe = seq(0.01, 0.10, by = 0.001)\n) |>\n  mutate(n = map_dbl(moe, velicina_uzorka)) |>\n  ggplot(aes(x = moe * 100, y = n)) +\n  geom_line(color = \"steelblue\", linewidth = 1.2) +\n  geom_hline(yintercept = c(500, 1000, 2000), linetype = \"dashed\", color = \"grey60\") +\n  annotate(\"text\", x = 9, y = c(500, 1000, 2000) + 200, \n           label = c(\"n = 500\", \"n = 1000\", \"n = 2000\"), color = \"grey40\") +\n  scale_x_reverse(breaks = seq(1, 10, 1)) +\n  scale_y_continuous(labels = scales::label_comma()) +\n  labs(\n    title = \"Potrebna veličina uzorka za zadanu marginu pogreške\",\n    subtitle = \"Najgori slučaj (p = 0.5), 95% razina pouzdanosti\",\n    x = \"Ciljna margina pogreške (%)\",\n    y = \"Potreban n\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/planiranje-vizualizacija-1.png){width=768}\n:::\n:::\n\n\n::: {.callout-tip}\n## Praktični savjet\n\nKad planirate istraživanje, odlučite o margini pogreške PRIJE nego počnete prikupljati podatke. Pitajte se: \"Koja razlika je praktično važna u mom kontekstu?\" Ako vas zanima razlikuje li se popularnost dviju platformi za 5 postotnih bodova, trebate marginu manju od 5%, znači uzorak od barem 400. Ako trebate razlučiti razlike od 2 postotna boda, trebate barem 2400 ispitanika.\n:::\n\n---\n\n## Čitanje medijskih anketa kritički {#sec-kriticko-citanje}\n\nNaučeno dosad daje nam alate za kritičku evaluaciju medijskih izvještaja o anketama. Pogledajmo tipičan primjer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulacija: medijska anketa o primarnom izvoru vijesti\nset.seed(123)\nanketa <- pop |> slice_sample(n = 800)\n\nrezultati <- anketa |>\n  count(primary_news_source) |>\n  mutate(\n    udio = n / sum(n),\n    se = sqrt(udio * (1 - udio) / sum(n)),\n    moe = 1.96 * se,\n    ci_lo = udio - moe,\n    ci_hi = udio + moe\n  ) |>\n  arrange(desc(udio))\n\nrezultati |>\n  mutate(across(c(udio, se, moe, ci_lo, ci_hi), \\(x) round(x * 100, 1)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 7\n  primary_news_source     n  udio    se   moe ci_lo ci_hi\n  <chr>               <int> <dbl> <dbl> <dbl> <dbl> <dbl>\n1 portal                257  32.1   1.7   3.2  28.9  35.4\n2 društvene mreže       206  25.8   1.5   3    22.7  28.8\n3 TV                    170  21.2   1.4   2.8  18.4  24.1\n4 radio                  92  11.5   1.1   2.2   9.3  13.7\n5 tisak                  75   9.4   1     2     7.4  11.4\n```\n\n\n:::\n:::\n\n\nNovinar piše: \"Portal je najpopularniji izvor vijesti (31%), a društvene mreže su na drugom mjestu (26%).\" Tehnički točno, ali zanemaruje intervale pouzdanosti. Kad uzmemo u obzir marginu pogreške, intervali za portal i društvene mreže se preklapaju. Ne možemo sa sigurnošću tvrditi da je portal popularniji od društvenih mreža.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrezultati |>\n  mutate(primary_news_source = fct_reorder(primary_news_source, udio)) |>\n  ggplot(aes(y = primary_news_source)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 1, color = \"steelblue\") +\n  geom_point(aes(x = udio), size = 3, color = \"steelblue\") +\n  geom_text(aes(x = ci_hi + 0.01, label = paste0(round(udio * 100, 1), \"%\")), hjust = 0) +\n  scale_x_continuous(labels = scales::label_percent(), limits = c(0, 0.42)) +\n  labs(\n    title = \"Anketni rezultati S intervalima pouzdanosti\",\n    subtitle = \"n = 800. Preklapajući intervali znače da razlike nisu statistički jasne.\",\n    x = \"Udio ispitanika\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/medijska-anketa-graf-1.png){width=768}\n:::\n:::\n\n\n### Kontrolna lista za čitanje anketa\n\nKad sretnete medijski izvještaj o anketi, postavite sedam pitanja. Koliki je uzorak? Ako ga ne navode, rezultati su sumnjivi. Kako su odabrali ispitanike? Slučajno telefonsko pozivanje ili online panel? Kolika je margina pogreške? Ako je navode samo na dnu stranice, obratite posebnu pažnju. Jesu li razlike veće od margine pogreške? Ako su razlike manje od dvostruke margine, zaključci su na klimavim nogama. Kad je anketa provedena? Stavovi se mogu promijeniti brzo. Tko je naručio anketu? Naručitelj može utjecati na formulaciju pitanja. Koliki je odaziv? Nizak odaziv (ispod 30%) sugerira self-selection bias.\n\n---\n\n## Bootstrapping: alternativni pristup {#sec-bootstrap}\n\nPonekad ne možemo pretpostaviti normalnost distribucije uzorkovanja, bilo zato što je uzorak premalen ili zato što nas zanima statistika za koju nemamo jednostavnu formulu za SE (medijan, omjer medijana i prosjeka, razlika između 90. i 10. percentila). **Bootstrap** je računalna metoda koja rješava ovaj problem.\n\nIdeja je elegantna: budući da ne možemo uzimati nove uzorke iz populacije (jer nemamo pristup cijeloj populaciji), uzimamo nove uzorke iz uzorka, s vraćanjem (with replacement).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak_50 <- pop |> slice_sample(n = 50)\n\n# 5000 bootstrap uzoraka\nboot_prosjeci <- map_dbl(1:5000, \\(i) {\n  uzorak_50 |>\n    slice_sample(n = 50, replace = TRUE) |>\n    pull(media_trust) |>\n    mean()\n})\n\n# Bootstrap CI (percentilna metoda)\nboot_ci <- quantile(boot_prosjeci, probs = c(0.025, 0.975))\n\n# Usporedba s t-testom\nt_ci <- t.test(uzorak_50$media_trust)$conf.int\n\ncat(\"Bootstrap 95% CI: [\", round(boot_ci[1], 3), \",\", round(boot_ci[2], 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBootstrap 95% CI: [ 4.02 , 5.26 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"t-test   95% CI: [\", round(t_ci[1], 3), \",\", round(t_ci[2], 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nt-test   95% CI: [ 4.02 , 5.26 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pravi prosjek:   \", round(mean(pop$media_trust), 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPravi prosjek:    4.867 \n```\n\n\n:::\n:::\n\n\nBootstrap i t-test daju vrlo slične rezultate kad su pretpostavke t-testa zadovoljene. Prednost bootstrapa je fleksibilnost: možemo ga koristiti za bilo koju statistiku.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bootstrap CI za MEDIJAN (za koji nema jednostavne formule za SE)\nboot_medijani <- map_dbl(1:5000, \\(i) {\n  uzorak_50 |>\n    slice_sample(n = 50, replace = TRUE) |>\n    pull(daily_media_min) |>\n    median()\n})\n\nboot_ci_medijan <- quantile(boot_medijani, probs = c(0.025, 0.975))\n\ncat(\"Medijan uzorka:\", median(uzorak_50$daily_media_min), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMedijan uzorka: 190 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Bootstrap 95% CI za medijan: [\", boot_ci_medijan[1], \",\", boot_ci_medijan[2], \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBootstrap 95% CI za medijan: [ 166.5 , 200 ]\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pravi populacijski medijan:\", median(pop$daily_media_min), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPravi populacijski medijan: 172 \n```\n\n\n:::\n:::\n\n\n::: {.callout-tip}\n## Kada koristiti bootstrap?\n\nKoristite bootstrap kad: nemate formulu za SE željene statistike, sumnjate u normalnost distribucije uzorkovanja, imate mali uzorak i tražite robusniju metodu, ili želite CI za medijan, percentile, omjere ili druge nestandardne mjere. Za prosjeke s n > 30, t-test je jednako dobar i jednostavniji.\n:::\n\n---\n\n## Potpuna analiza: povjerenje u medije po demografskim skupinama {#sec-analiza}\n\nSpojimo sve naučeno u jednu koherentnu analizu. Situacija: provedena je anketa na 600 ispitanika o medijskim navikama. Trebamo procijeniti povjerenje u medije ukupno i po ključnim podgrupama te interpretirati rezultate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nanketa <- pop |> slice_sample(n = 600)\n\ncat(\"Veličina uzorka:\", nrow(anketa), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVeličina uzorka: 600 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Korak 1: Ukupna procjena\nukupno <- t.test(anketa$media_trust)\ncat(\"UKUPNO POVJERENJE U MEDIJE\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUKUPNO POVJERENJE U MEDIJE\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Prosjek:\", round(ukupno$estimate, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProsjek: 5.02 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(ukupno$conf.int[1], 2), \",\", round(ukupno$conf.int[2], 2), \"]\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 4.86 , 5.18 ]\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korak 2: CI po dobnim skupinama\nanketa <- anketa |>\n  mutate(dobna_skupina = case_when(\n    age < 30 ~ \"18-29\",\n    age < 45 ~ \"30-44\",\n    age < 60 ~ \"45-59\",\n    .default = \"60+\"\n  ))\n\nci_dob <- anketa |>\n  group_by(dobna_skupina) |>\n  summarise(\n    n = n(),\n    prosjek = mean(media_trust),\n    se = sd(media_trust) / sqrt(n()),\n    ci_lo = prosjek - qt(0.975, n() - 1) * se,\n    ci_hi = prosjek + qt(0.975, n() - 1) * se,\n    .groups = \"drop\"\n  )\n\nci_dob |>\n  ggplot(aes(y = dobna_skupina)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 1, color = \"steelblue\") +\n  geom_point(aes(x = prosjek), size = 3, color = \"steelblue\") +\n  geom_text(aes(x = ci_hi + 0.05, label = paste0(\"n = \", n)), hjust = 0, size = 3.5, color = \"grey40\") +\n  labs(\n    title = \"Povjerenje u medije po dobnim skupinama\",\n    subtitle = \"95% intervali pouzdanosti. Starije skupine imaju više povjerenja.\",\n    x = \"Povjerenje u medije (1-10)\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/analiza-po-dobi-1.png){width=864}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korak 3: Unakrsna analiza: izvor vijesti × dobna skupina\nci_krizno <- anketa |>\n  group_by(primary_news_source, dobna_skupina) |>\n  filter(n() >= 10) |>\n  summarise(\n    n = n(),\n    prosjek = mean(media_trust),\n    se = sd(media_trust) / sqrt(n()),\n    ci_lo = prosjek - qt(0.975, n() - 1) * se,\n    ci_hi = prosjek + qt(0.975, n() - 1) * se,\n    .groups = \"drop\"\n  )\n\nci_krizno |>\n  ggplot(aes(y = dobna_skupina, color = primary_news_source)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 0.8,\n                 position = position_dodge(0.6)) +\n  geom_point(aes(x = prosjek), size = 2, position = position_dodge(0.6)) +\n  labs(\n    title = \"Povjerenje u medije: izvor vijesti × dobna skupina\",\n    subtitle = \"Kombinacije s manje od 10 ispitanika isključene\",\n    x = \"Povjerenje u medije (1-10)\",\n    y = NULL,\n    color = \"Primarni izvor\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/analiza-po-izvoru-i-dobi-1.png){width=960}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korak 4: Proporcije po izvoru vijesti s CI\nprop_rezultati <- anketa |>\n  count(primary_news_source) |>\n  mutate(\n    p_hat = n / sum(n),\n    test = map2(n, sum(n), \\(x, nn) prop.test(x, nn, conf.level = 0.95)),\n    ci_lo = map_dbl(test, \\(t) t$conf.int[1]),\n    ci_hi = map_dbl(test, \\(t) t$conf.int[2])\n  ) |>\n  select(-test) |>\n  arrange(desc(p_hat))\n\nprop_rezultati |>\n  mutate(primary_news_source = fct_reorder(primary_news_source, p_hat)) |>\n  ggplot(aes(y = primary_news_source)) +\n  geom_errorbarh(aes(xmin = ci_lo, xmax = ci_hi), height = 0.3, linewidth = 1, color = \"#2a9d8f\") +\n  geom_point(aes(x = p_hat), size = 3, color = \"#2a9d8f\") +\n  geom_text(aes(x = ci_hi + 0.008, label = paste0(round(p_hat * 100, 1), \"% (n=\", n, \")\")), \n            hjust = 0, size = 3.5) +\n  scale_x_continuous(labels = scales::label_percent(), limits = c(0, 0.42)) +\n  labs(\n    title = \"Preferirani izvor vijesti s intervalima pouzdanosti\",\n    subtitle = \"Anketa na 600 ispitanika. Portali i društvene mreže statistički nerazlučivi.\",\n    x = \"Udio ispitanika\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/analiza-proporcije-1.png){width=768}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korak 5: Sažetak za klijenta\ncat(\"=== SAŽETAK REZULTATA ANKETE ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== SAŽETAK REZULTATA ANKETE ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Uzorak: n =\", nrow(anketa), \"ispitanika\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUzorak: n = 600 ispitanika\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Margina pogreške za proporcije: ±\", round(1.96 * sqrt(0.25 / nrow(anketa)) * 100, 1), \"%\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMargina pogreške za proporcije: ± 4 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"1. Ukupno povjerenje u medije:\", round(ukupno$estimate, 2), \n    \"(95% CI:\", round(ukupno$conf.int[1], 2), \"-\", round(ukupno$conf.int[2], 2), \")\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. Ukupno povjerenje u medije: 5.02 (95% CI: 4.86 - 5.18 )\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   Na ljestvici od 1-10, to je ispod sredine.\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Na ljestvici od 1-10, to je ispod sredine.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"2. Najpopularniji izvori vijesti:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. Najpopularniji izvori vijesti:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (i in 1:nrow(prop_rezultati)) {\n  cat(\"   \", prop_rezultati$primary_news_source[i], \":\", \n      round(prop_rezultati$p_hat[i] * 100, 1), \"% (\",\n      round(prop_rezultati$ci_lo[i] * 100, 1), \"-\", \n      round(prop_rezultati$ci_hi[i] * 100, 1), \"%)\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    portal : 29.8 % ( 26.2 - 33.7 %)\n    društvene mreže : 27.7 % ( 24.2 - 31.5 %)\n    TV : 22.8 % ( 19.6 - 26.4 %)\n    radio : 11 % ( 8.7 - 13.8 %)\n    tisak : 8.7 % ( 6.6 - 11.3 %)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n3. Napomena: razlika između portala i društvenih mreža je unutar margine\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n3. Napomena: razlika između portala i društvenih mreža je unutar margine\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   pogreške i ne može se smatrati statistički značajnom.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   pogreške i ne može se smatrati statistički značajnom.\n```\n\n\n:::\n:::\n\n\n---\n\n## Uobičajene pogreške pri interpretaciji CI {#sec-pogreske}\n\nIntervali pouzdanosti su intuitivno privlačni ali se često krivo interpretiraju. Evo najčešćih grešaka i ispravnih verzija.\n\n**Pogrešno**: \"Postoji 95% šansa da je pravi prosjek unutar intervala [4.67, 5.01].\"\n**Ispravno**: Pravi prosjek je fiksan broj. On ili jest ili nije unutar intervala. 95% se odnosi na postupak: 95% intervala konstruiranih ovom metodom pokrit će pravi parametar.\n\n**Pogrešno**: \"95% podataka pada unutar intervala [4.67, 5.01].\"\n**Ispravno**: CI se odnosi na parametar (prosjek), ne na pojedinačna opažanja. Pojedinačne vrijednosti pokriva prediktivni interval, koji je mnogo širi.\n\n**Pogrešno**: \"Ako dva CI-a ne uključuju nulu, razlika je značajna.\"\n**Ispravno**: Nula nije relevantna za pojedinačne CI-e. Preklapanje dvaju CI-a govori o mogućoj razlici, ali formalni test zahtijeva CI za razliku (o čemu ćemo na predavanju o t-testu).\n\n**Pogrešno**: \"Širok CI znači da je mjerenje loše provedeno.\"\n**Ispravno**: Širok CI obično znači mali uzorak ili veliku varijabilnost u podacima. To nije greška, nego realnost podataka.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nuzorak_200 <- pop |> slice_sample(n = 200)\n\nxbar <- mean(uzorak_200$media_trust)\nse <- sd(uzorak_200$media_trust) / sqrt(200)\ns <- sd(uzorak_200$media_trust)\n\ntibble(\n  tip = factor(c(\"CI za prosjek (95%)\", \"Prediktivni interval (95%)\"),\n               levels = c(\"CI za prosjek (95%)\", \"Prediktivni interval (95%)\")),\n  lo = c(xbar - 1.96 * se, xbar - 1.96 * s),\n  hi = c(xbar + 1.96 * se, xbar + 1.96 * s),\n  xbar = xbar\n) |>\n  ggplot(aes(y = tip)) +\n  geom_errorbarh(aes(xmin = lo, xmax = hi), height = 0.3, linewidth = 1.2, color = \"steelblue\") +\n  geom_point(aes(x = xbar), size = 3, color = \"steelblue\") +\n  labs(\n    title = \"CI za prosjek vs prediktivni interval\",\n    subtitle = \"CI govori gdje je populacijski prosjek. Prediktivni interval govori gdje su pojedinačna opažanja.\",\n    x = \"Povjerenje u medije\",\n    y = NULL\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-09_files/figure-html/ci-vs-prediktivni-1.png){width=768}\n:::\n:::\n\n\nCI za prosjek je uzak (±0.28). Prediktivni interval je širok (±3.9). Ovo su dva potpuno različita pitanja: \"Gdje je pravi prosjek?\" vs \"Gdje će pasti sljedeće opažanje?\" Ne miješajte ih.\n\n---\n\n::: {.callout-important}\n## Ključni zaključci\n\n1. Populacija je cjelina o kojoj zaključujemo. Uzorak je dio koji mjerimo. Parametri (μ, σ) opisuju populaciju. Statistike (x̄, s) opisuju uzorak i procjenjuju parametre.\n\n2. Svaki uzorak daje malo drugačiju procjenu. Distribucija tih procjena kroz ponovljene uzorke naziva se distribucija uzorkovanja. Njezina standardna devijacija je standardna pogreška (SE).\n\n3. Standardna pogreška SE = s/√n mjeri koliko prosjeci uzoraka tipično variraju. Preciznost raste s korijenom veličine uzorka: da biste prepolovili SE, morate učetverostručiti n.\n\n4. Centralni granični teorem kaže da je distribucija uzorkovanja prosjeka približno normalna za dovoljno velik n (pravilo palca n ≥ 30), neovisno o obliku izvorne distribucije.\n\n5. Pristranost uzorka (convenience sampling, self-selection) je veći problem od male veličine uzorka. Velik pristran uzorak daje sustavno pogrešne rezultate koje ne može ispraviti nijedna statistička metoda.\n\n6. t-distribucija se koristi umjesto normalne kad procjenjujemo σ iz uzorka. Za male uzorke daje šire intervale (deblje repove). Za n > 100, razlika je zanemariva.\n\n7. `t.test()` računa interval pouzdanosti za prosjek. `prop.test()` računa CI za proporciju. Obje funkcije automatski koriste ispravne formule.\n\n8. 95% CI znači: 95% ovako konstruiranih intervala pokriva pravi parametar. NE znači \"95% šansa da je parametar unutar intervala.\" Parametar je fiksan. Interval je slučajan.\n\n9. Margina pogreške za proporcije je približno 1/√n. Za n = 1000 je ±3.1%. Za n = 400 je ±4.9%. Ovo objašnjava uobičajene veličine uzoraka u anketama.\n\n10. Kad planirate istraživanje, odredite ciljanu preciznost unaprijed i iz nje izvedite potrebnu veličinu uzorka. Formula: n = z*² × p(1−p) / MoE².\n\n11. Bootstrap je računalna alternativa za CI kad nemamo formulu za SE željene statistike. Ideja: uzorkuj iz uzorka s vraćanjem, izračunaj statistiku, ponovi mnogo puta.\n\n12. Kod čitanja medijskih anketa uvijek provjerite veličinu uzorka, metodu uzorkovanja, marginu pogreške i jesu li prijavljivane razlike veće od margine. Ako razlika između dvaju postotaka nije veća od dvostruke margine pogreške, zaključak o \"vodstvu\" jedne opcije nije opravdan.\n:::\n\n---\n\n## Zadaci za pripremu\n\n1. Učitajte `media_population.csv` i izračunajte pravi populacijski prosjek za `daily_media_min`. Zatim uzmite 50 slučajnih uzoraka veličine n = 300 i za svaki izračunajte 95% CI pomoću `t.test()`. Koliki postotak intervala pokriva pravi prosjek?\n\n2. Izračunajte potrebnu veličinu uzorka za anketu o preferencijama izvora vijesti s marginom pogreške ±2.5% na razini pouzdanosti 99%.\n\n3. Napišite funkciju `bootstrap_ci(x, stat_fn, n_boot = 5000, conf = 0.95)` koja prima vektor `x`, funkciju `stat_fn` (npr. `mean` ili `median`) i vraća bootstrap CI. Testirajte je na varijabli `daily_media_min`.\n\n---\n\n## Dodatno čitanje\n\n**Obavezno**\n\nNavarro, D. (2018). *Learning Statistics with R*, Chapter 10 (Estimating Unknown Quantities from a Sample). Besplatno dostupno na [learningstatisticswithr.com](https://learningstatisticswithr.com/lsr-0.6.pdf). Pokriva uzorkovanje, CLT i intervale pouzdanosti s R kodom i odličnim objašnjenjima.\n\nDiez, D., Çetinkaya-Rundel, M., & Barr, C. (2019). *OpenIntro Statistics* (4th edition), Chapter 5. Besplatno dostupno na [openintro.org/book/os](https://www.openintro.org/book/os/). Odličan vizualni pregled distribucije uzorkovanja i CI-a.\n\n**Preporučeno**\n\nWheelan, C. (2013). *Naked Statistics*. W. W. Norton. Poglavlja 8 i 9 pokrivaju centralni granični teorem i uzorkovanje na izuzetno pristupačan način.\n\nCumming, G. (2014). The New Statistics: Why and How. *Psychological Science*, 25(1), 7-29. Članak argumentira zašto intervali pouzdanosti i veličine učinka trebaju zamijeniti p-vrijednosti kao primarni način izvještavanja rezultata.\n\n---\n\n## Pojmovnik\n\n| Pojam | Objašnjenje |\n|---|---|\n| Populacija | Cjelokupni skup jedinica o kojima želimo donijeti zaključak. |\n| Uzorak | Podskup populacije koji zaista mjerimo. |\n| Parametar | Mjera populacije. Označava se grčkim slovima (μ, σ, π). U praksi nepoznat. |\n| Statistika | Mjera uzorka. Označava se latinskim slovima (x̄, s, p̂). Procjena parametra. |\n| Pogreška uzorkovanja | Razlika između statistike i parametra. Neizbježna posljedica rada s uzorkom. |\n| Distribucija uzorkovanja | Distribucija statistike kroz mnogo ponovljenih uzoraka. Osnova za statističko zaključivanje. |\n| Standardna pogreška (SE) | Standardna devijacija distribucije uzorkovanja. Za prosjek: SE = s/√n. |\n| Centralni granični teorem (CLT) | Distribucija uzorkovanja prosjeka je približno normalna za dovoljno velik n, neovisno o obliku izvorne distribucije. |\n| t-distribucija | Distribucija slična normalnoj ali s debljim repovima. Koristi se kad procjenjujemo σ iz uzorka. |\n| Stupnjevi slobode (df) | Parametar t-distribucije. Za jedan prosjek: df = n − 1. Više df = bliže normalnoj. |\n| Interval pouzdanosti (CI) | Raspon vrijednosti koji s određenom vjerojatnošću pokriva pravi parametar. |\n| Razina pouzdanosti | Postotak intervala koji bi pokrio parametar u ponovljenom uzorkovanju (obično 95% ili 99%). |\n| Margina pogreške (MoE) | Pola širine intervala pouzdanosti. Za proporcije ≈ 1/√n. |\n| Nepristrana procjena | Statistika čija distribucija uzorkovanja je centrirana oko pravog parametra. |\n| Convenience sampling | Uzorkovanje iz dostupne (ali nereprezentativne) skupine. Uvodi pristranost. |\n| Self-selection bias | Pristranost kad ispitanici sami odlučuju hoće li sudjelovati. Tipično za online ankete. |\n| Proporcija uzorka (p̂) | Udio uzorka koji ima neku karakteristiku. Procjena populacijske proporcije π. |\n| Bootstrap | Računalna metoda za procjenu SE i CI ponovljenim uzorkovanjem iz uzorka s vraćanjem. |\n| Prediktivni interval | Interval koji pokriva buduća pojedinačna opažanja. Mnogo širi od CI za prosjek. |\n| Točkasta procjena | Jedna brojčana vrijednost kao procjena parametra (npr. x̄ = 4.87). Ne govori o preciznosti. |\n| `t.test()` | R funkcija za t-test i t-interval pouzdanosti za prosjek. |\n| `prop.test()` | R funkcija za test i CI za proporcije. Koristi Wilsonov interval. |\n| `slice_sample()` | dplyr funkcija za slučajno uzorkovanje redova iz tibble. Argument `replace = TRUE` za bootstrap. |\n| `qt()` | R funkcija za kritične vrijednosti t-distribucije. `qt(0.975, df)` za 95% CI. |\n| `qnorm()` | R funkcija za kritične vrijednosti normalne distribucije. `qnorm(0.975)` = 1.96. |\n",
    "supporting": [
      "week-09_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}