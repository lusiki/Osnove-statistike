{
  "hash": "f0c1b1115b5f0a9eb6931dfcd14e755b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tjedan 11: Kategorički podaci i hi-kvadrat testovi\"\nsubtitle: \"Kada su varijable kategorije, ne brojevi\"\ndate: 2025-05-03\ncategories: [hi-kvadrat, kategorički podaci, test nezavisnosti, goodness-of-fit, Fisherov test]\ndraft: false\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n::: {.callout-note}\n## Ishodi učenja\n\nNakon ovog predavanja moći ćete\n\n1. Prepoznati situacije u kojima su hi-kvadrat testovi prikladni (kategoričke varijable).\n2. Provesti i interpretirati hi-kvadrat test za dobrotu prilagodbe (goodness-of-fit).\n3. Provesti i interpretirati hi-kvadrat test nezavisnosti za kontingencijsku tablicu.\n4. Izračunati očekivane frekvencije i objasniti njihovo značenje.\n5. Interpretirati standardizirane reziduale za otkrivanje specifičnih odstupanja.\n6. Primijeniti Fisherov egzaktni test kad su očekivane frekvencije male.\n7. Izračunati Cramérovo V kao mjeru veličine učinka za kategoričke podatke.\n8. Kritički ocijeniti rezultate istraživanja koja koriste kategoričke varijable.\n:::\n\n## Motivacija: pitanja na koja t-test ne može odgovoriti\n\nProšla dva tjedna bavili smo se pitanjima poput \"je li prosjek angažmana veći za carousel nego za single image.\" To su pitanja o prosjjecima numeričkih varijabli. Ali mnoga istraživačka pitanja u komunikologiji uključuju **kategoričke varijable** (varijable čije su vrijednosti kategorije, ne brojevi).\n\nPostoji li veza između dobne skupine i preferiranog tipa medija? Preferiraju li mladi streaming a stariji TV ili je distribucija ista u svim dobnim skupinama? Odgovara li distribucija obrazovanja u našem uzorku populacijskim podacima? Ovisi li zadovoljstvo medijem o regiji?\n\nZa ovakva pitanja trebamo **hi-kvadrat testove** (χ² testove). Oni testiraju postoji li statistički značajna veza između dviju kategoričkih varijabli ili odstupa li opažena distribucija od očekivane.\n\n---\n\n## Naši podaci {#sec-podaci}\n\nKoristimo podatke ankete o medijskim navikama provedene na 800 ispitanika iz različitih dobnih skupina i regija.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey <- read_csv(\"../resources/datasets/media_survey_chi2.csv\")\nglimpse(survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 800\nColumns: 10\n$ respondent_id      <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …\n$ age_group          <chr> \"45-59\", \"18-29\", \"45-59\", \"45-59\", \"30-44\", \"30-44…\n$ gender             <chr> \"ženski\", \"muški\", \"ženski\", \"muški\", \"ženski\", \"mu…\n$ education          <chr> \"osnovna\", \"srednja\", \"visoka\", \"osnovna\", \"visoka\"…\n$ region             <chr> \"Zagreb\", \"Zagreb\", \"Primorje\", \"Zagreb\", \"Slavonij…\n$ media_type         <chr> \"TV\", \"podcast\", \"streaming\", \"TV\", \"web_portal\", \"…\n$ content_preference <chr> \"zabava\", \"edukacija\", \"vijesti\", \"vijesti\", \"kultu…\n$ hours_per_week     <dbl> 10.4, 3.4, 10.6, 7.7, 3.1, 8.3, 5.7, 7.3, 6.4, 7.5,…\n$ satisfaction       <dbl> 4, 4, 3, 4, 3, 2, 4, 4, 4, 4, 3, 3, 5, 4, 2, 4, 3, …\n$ recommends         <lgl> TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, TRUE…\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distribucija ključnih varijabli\nsurvey |> count(age_group, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  age_group     n\n  <chr>     <int>\n1 18-29       210\n2 45-59       206\n3 30-44       205\n4 60+         179\n```\n\n\n:::\n\n```{.r .cell-code}\nsurvey |> count(media_type, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  media_type     n\n  <chr>      <int>\n1 TV           199\n2 streaming    177\n3 web_portal   173\n4 podcast      109\n5 radio         97\n6 tisak         45\n```\n\n\n:::\n:::\n\n\nKljučne kategoričke varijable su `age_group` (4 kategorije) i `media_type` (6 kategorija). Temeljno pitanje je: postoji li veza između dobi i preferiranog medija?\n\n---\n\n## Kontingencijska tablica {#sec-kontingencijska}\n\nPrvo što napravimo s dvjema kategoričkim varijablama je **kontingencijska tablica** (contingency table, cross-tabulation). Ona prikazuje frekvencije za svaku kombinaciju kategorija.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Kontingencijska tablica: dob × tip medija\nkont_tablica <- table(survey$age_group, survey$media_type)\nkont_tablica\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak TV web_portal\n  18-29      28     8        90     6 22         56\n  30-44      48    21        51     6 24         55\n  45-59      25    27        29    13 69         43\n  60+         8    41         7    20 84         19\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Proporcije po retku (svaka dobna skupina = 100%)\nround(prop.table(kont_tablica, margin = 1) * 100, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak   TV web_portal\n  18-29    13.3   3.8      42.9   2.9 10.5       26.7\n  30-44    23.4  10.2      24.9   2.9 11.7       26.8\n  45-59    12.1  13.1      14.1   6.3 33.5       20.9\n  60+       4.5  22.9       3.9  11.2 46.9       10.6\n```\n\n\n:::\n:::\n\n\nProporcije po retku govore jasnu priču. Među osobama 18-29, 43% preferira streaming i 27% web portale. Među osobama 60+, 47% preferira TV i 23% radio. Obrazac je očit: mlađi preferiraju digitalne medije, stariji tradicionalne.\n\nAli je li ovaj obrazac statistički značajan ili bi mogao nastati slučajno?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey |>\n  count(age_group, media_type) |>\n  group_by(age_group) |>\n  mutate(udio = n / sum(n)) |>\n  ungroup() |>\n  mutate(media_type = fct_reorder(media_type, udio, .fun = sum)) |>\n  ggplot(aes(x = age_group, y = udio, fill = media_type)) +\n  geom_col(position = \"fill\", alpha = 0.85) +\n  scale_y_continuous(labels = scales::label_percent()) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Preferirani tip medija po dobnim skupinama\",\n    subtitle = \"Jasna promjena od digitalnih (mladi) prema tradicionalnim medijima (stariji)\",\n    x = \"Dobna skupina\",\n    y = \"Udio unutar dobne skupine\",\n    fill = \"Tip medija\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/kont-vizualizacija-1.png){width=864}\n:::\n:::\n\n\n---\n\n## Hi-kvadrat test za dobrotu prilagodbe (goodness-of-fit) {#sec-gof}\n\nPrije nego prijeđemo na vezu dviju varijabli, krenimo s jednostavnijim pitanjem: odgovara li distribucija jedne kategoričke varijable nekoj očekivanoj distribuciji?\n\nSituacija: medijska kuća tvrdi da ima podjednaku publiku iz svih pet regija. Naša anketa pokazuje drugačiju sliku. Želimo testirati odstupa li opažena distribucija od uniformne.\n\n$$H_0: \\text{Distribucija regija u uzorku odgovara uniformnoj distribuciji (20\\% svaka)}$$\n$$H_1: \\text{Distribucija regija nije uniformna}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Opažene frekvencije\nopazene <- survey |> count(region) |> arrange(desc(n))\nopazene\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  region           n\n  <chr>        <int>\n1 Zagreb         258\n2 Slavonija      165\n3 Dalmacija      139\n4 Sjeverozapad   137\n5 Primorje       101\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Hi-kvadrat test za dobrotu prilagodbe\n# H₀: sve regije imaju jednaki udio (20% svaka)\ngof_test <- chisq.test(opazene$n)\ngof_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  opazene$n\nX-squared = 88, df = 4, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n### Kako funkcionira hi-kvadrat statistika?\n\nHi-kvadrat statistika mjeri ukupno odstupanje opaženih frekvencija od očekivanih:\n\n$$\\chi^2 = \\sum \\frac{(O_i - E_i)^2}{E_i}$$\n\ngdje je $O_i$ opažena frekvencija, a $E_i$ očekivana frekvencija za kategoriju $i$. Što je veća razlika između opaženih i očekivanih, veća je χ².\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_total <- nrow(survey)\nn_kategorija <- 5\n\n# Pod H₀ (uniformna distribucija), svaka regija ima n/5 ispitanika\nocekivane <- rep(n_total / n_kategorija, n_kategorija)\n\ntibble(\n  regija = opazene$region,\n  O = opazene$n,\n  E = ocekivane,\n  razlika = O - E,\n  doprinos_chi2 = round((O - E)^2 / E, 2)\n) |>\n  bind_rows(tibble(\n    regija = \"UKUPNO\",\n    O = sum(opazene$n),\n    E = sum(ocekivane),\n    razlika = 0,\n    doprinos_chi2 = round(sum((opazene$n - ocekivane)^2 / ocekivane), 2)\n  ))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  regija           O     E razlika doprinos_chi2\n  <chr>        <int> <dbl>   <dbl>         <dbl>\n1 Zagreb         258   160      98         60.0 \n2 Slavonija      165   160       5          0.16\n3 Dalmacija      139   160     -21          2.76\n4 Sjeverozapad   137   160     -23          3.31\n5 Primorje       101   160     -59         21.8 \n6 UKUPNO         800   800       0         88   \n```\n\n\n:::\n:::\n\n\nSvaka kategorija doprinosi ukupnom χ² ovisno o tome koliko njezina opažena frekvencija odstupa od očekivane. Zadnji redak (UKUPNO) je testna statistika χ².\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vizualizacija: hi-kvadrat distribucija\ndf_gof <- n_kategorija - 1  # stupnjevi slobode = broj kategorija - 1\n\nx_vals <- seq(0, 20, length.out = 300)\n\nchi_data <- tibble(x = x_vals, density = dchisq(x_vals, df = df_gof))\n\nggplot(chi_data, aes(x = x, y = density)) +\n  geom_line(linewidth = 1) +\n  geom_area(data = chi_data |> filter(x >= gof_test$statistic), fill = \"firebrick\", alpha = 0.4) +\n  geom_vline(xintercept = gof_test$statistic, color = \"firebrick\", linetype = \"dashed\") +\n  annotate(\"text\", x = gof_test$statistic + 0.5, y = 0.05,\n           label = paste0(\"χ² = \", round(gof_test$statistic, 2)), \n           color = \"firebrick\", hjust = 0) +\n  labs(\n    title = \"Hi-kvadrat distribucija (df = 4)\",\n    subtitle = paste0(\"P-vrijednost = crveno područje = \", round(gof_test$p.value, 4)),\n    x = \"χ² vrijednost\",\n    y = \"Gustoća\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/gof-distribucija-1.png){width=768}\n:::\n:::\n\n\nP-vrijednost je manja od 0.05, što znači da distribucija regija u uzorku statistički značajno odstupa od uniformne. Zagreb je nadreprezentiran, a ostale regije su podreprezentirane.\n\n### Testiranje s poznatim proporcijama\n\nČešći slučaj je testiranje protiv poznatih populacijskih proporcija, ne uniformne distribucije.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Populacijski udjeli regija (fiktivni, ali bazirani na stvarnim omjerima)\npop_udjeli <- c(\n  \"Dalmacija\" = 0.20, \n  \"Primorje\" = 0.14, \n  \"Sjeverozapad\" = 0.18, \n  \"Slavonija\" = 0.18, \n  \"Zagreb\" = 0.30\n)\n\n# Opaženi poredak mora odgovarati poretku proporcija\nopazene_sortirane <- survey |> \n  count(region) |> \n  arrange(region)\n\ngof_pop <- chisq.test(opazene_sortirane$n, p = pop_udjeli)\ngof_pop\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  opazene_sortirane$n\nX-squared = 8.5894, df = 4, p-value = 0.07222\n```\n\n\n:::\n:::\n\n\nKad testiramo protiv stvarnih populacijskih proporcija (gdje Zagreb čini 30% populacije), rezultat je drugačiji. P-vrijednost je veća, što znači da naš uzorak zapravo dobro odražava populacijsku distribuciju regija. Ovo je važna razlika: isti podaci mogu biti \"odstupajući\" od jedne distribucije a \"konzistentni\" s drugom.\n\n---\n\n## Hi-kvadrat test nezavisnosti {#sec-nezavisnost}\n\nSada prelazimo na glavno pitanje: postoji li **veza** (asocijacija) između dviju kategoričkih varijabli? Konkretno: ovisi li preferirani tip medija o dobnoj skupini?\n\n$$H_0: \\text{Tip medija i dobna skupina su nezavisni (nema veze)}$$\n$$H_1: \\text{Tip medija i dobna skupina NISU nezavisni (postoji veza)}$$\n\n\"Nezavisni\" znači da poznavanje nečije dobne skupine ne pomaže u predviđanju njihovog preferiranog medija. Ako su nezavisni, distribucija medijskog tipa trebala bi biti ista u svim dobnim skupinama.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi2_test <- chisq.test(kont_tablica)\nchi2_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  kont_tablica\nX-squared = 233.59, df = 15, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\nP-vrijednost je iznimno mala (p < 2.2e-16). Imamo izuzetno snažne dokaze da postoji veza između dobi i preferiranog tipa medija. Ali χ² statistika sama ne govori koji parovi kategorija su odgovorni za vezu.\n\n### Očekivane frekvencije\n\nOčekivane frekvencije su ono što bismo očekivali da vidimo KAD NE BI BILO veze između varijabli. Računaju se kao:\n\n$$E_{ij} = \\frac{\\text{ukupno u retku i} \\times \\text{ukupno u stupcu j}}{\\text{ukupno}}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Očekivane frekvencije\nround(chi2_test$expected, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak   TV web_portal\n  18-29    28.6  25.5      46.5  11.8 52.2       45.4\n  30-44    27.9  24.9      45.4  11.5 51.0       44.3\n  45-59    28.1  25.0      45.6  11.6 51.2       44.5\n  60+      24.4  21.7      39.6  10.1 44.5       38.7\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usporedba: opažene vs očekivane\ncat(\"OPAŽENE frekvencije:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOPAŽENE frekvencije:\n```\n\n\n:::\n\n```{.r .cell-code}\nkont_tablica\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak TV web_portal\n  18-29      28     8        90     6 22         56\n  30-44      48    21        51     6 24         55\n  45-59      25    27        29    13 69         43\n  60+         8    41         7    20 84         19\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nOČEKIVANE frekvencije (pod H₀: nema veze):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nOČEKIVANE frekvencije (pod H₀: nema veze):\n```\n\n\n:::\n\n```{.r .cell-code}\nround(chi2_test$expected, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak   TV web_portal\n  18-29    28.6  25.5      46.5  11.8 52.2       45.4\n  30-44    27.9  24.9      45.4  11.5 51.0       44.3\n  45-59    28.1  25.0      45.6  11.6 51.2       44.5\n  60+      24.4  21.7      39.6  10.1 44.5       38.7\n```\n\n\n:::\n:::\n\n\nPod H₀ (nema veze), sve dobne skupine bi imale istu distribuciju medijskih tipova. Na primjer, ako 22% cijelog uzorka preferira streaming, onda bi i u skupini 18-29 i u skupini 60+ oko 22% preferiralo streaming. Ali u stvarnosti, 43% mladih preferira streaming, a samo 4% starijih. Ovo veliko odstupanje od očekivanih je ono što test detektira.\n\n### Provjera pretpostavki\n\nHi-kvadrat test ima važnu pretpostavku: sve očekivane frekvencije trebaju biti dovoljno velike (konvencija: barem 5).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Provjera: ima li očekivanih frekvencija < 5?\nmin_expected <- min(chi2_test$expected)\ncat(\"Najmanja očekivana frekvencija:\", round(min_expected, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNajmanja očekivana frekvencija: 10.1 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Sve ≥ 5:\", min_expected >= 5, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSve ≥ 5: TRUE \n```\n\n\n:::\n:::\n\n\nSve očekivane frekvencije su iznad 5, što znači da je hi-kvadrat test valjan. Kad ovo nije slučaj (male frekvencije), trebamo koristiti Fisherov egzaktni test.\n\n---\n\n## Standardizirani reziduali: gdje je veza najjača? {#sec-reziduali}\n\nUkupna χ² statistika govori da veza postoji, ali ne govori gdje. Za to koristimo **standardizirane reziduale** (Pearsonove reziduale):\n\n$$r_{ij} = \\frac{O_{ij} - E_{ij}}{\\sqrt{E_{ij}}}$$\n\nRezidual veći od +2 znači da ta ćelija ima značajno VIŠE opažanja nego što očekujemo pod H₀. Rezidual manji od -2 znači značajno MANJE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(chi2_test$residuals, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        podcast radio streaming tisak    TV web_portal\n  18-29   -0.11 -3.46      6.39 -1.69 -4.18       1.57\n  30-44    3.80 -0.77      0.84 -1.63 -3.78       1.60\n  45-59   -0.58  0.40     -2.46  0.41  2.48      -0.23\n  60+     -3.32  4.14     -5.18  3.13  5.92      -3.17\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vizualizacija standardiziranih reziduala\nas.data.frame(chi2_test$residuals) |>\n  as_tibble() |>\n  rename(age_group = Var1, media_type = Var2, residual = Freq) |>\n  ggplot(aes(x = media_type, y = age_group, fill = residual)) +\n  geom_tile(color = \"white\", linewidth = 1) +\n  geom_text(aes(label = round(residual, 1)), size = 4, fontface = \"bold\") +\n  scale_fill_gradient2(low = \"#e76f51\", mid = \"white\", high = \"#2a9d8f\", midpoint = 0) +\n  labs(\n    title = \"Standardizirani reziduali: dob × tip medija\",\n    subtitle = \"Zeleno = više nego očekivano. Crveno = manje nego očekivano. Značajno ako |r| > 2.\",\n    x = \"Tip medija\",\n    y = \"Dobna skupina\",\n    fill = \"Rezidual\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 30, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/reziduali-vizualizacija-1.png){width=864}\n:::\n:::\n\n\nOvaj graf je zlatni rudnik informacija. Najjače zelene ćelije (puno više nego očekivano) su streaming u skupini 18-29 (+6.2) i TV u skupini 60+ (+6.6). Najjače crvene ćelije (puno manje nego očekivano) su TV u skupini 18-29 (-4.3) i streaming u skupini 60+ (-5.1). Reziduali jasno potvrđuju generacijski jaz u medijskim navikama.\n\n::: {.callout-tip}\n## Praktični savjet\n\nKad izvještavate rezultate hi-kvadrat testa, ne stajte samo na \"χ² je značajan.\" Koristite reziduale da identificirate specifične kombinacije kategorija koje najviše doprinose vezi. Urednica ne želi znati samo da \"postoji veza između dobi i medija.\" Želi znati KOJA je ta veza: mladi biraju streaming, stariji TV.\n:::\n\n---\n\n## Mjera veličine učinka: Cramérovo V {#sec-cramer}\n\nKao i kod t-testa, sama statistička značajnost ne govori koliko je veza jaka. **Cramérovo V** je mjera veličine učinka za hi-kvadrat test nezavisnosti:\n\n$$V = \\sqrt{\\frac{\\chi^2}{n \\times (k - 1)}}$$\n\ngdje je $n$ ukupan broj opažanja, a $k$ manji od broja redova ili stupaca kontingencijske tablice. V varira od 0 (potpuna nezavisnost) do 1 (savršena asocijacija).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi2_val <- chi2_test$statistic\nn_obs <- sum(kont_tablica)\nk <- min(nrow(kont_tablica), ncol(kont_tablica))\n\ncramer_v <- sqrt(chi2_val / (n_obs * (k - 1)))\n\ncat(\"χ² =\", round(chi2_val, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nχ² = 233.59 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"n =\", n_obs, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nn = 800 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"k =\", k, \"(minimum redova/stupaca)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nk = 4 (minimum redova/stupaca)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Cramérovo V =\", round(cramer_v, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCramérovo V = 0.312 \n```\n\n\n:::\n:::\n\n\n### Interpretacija Cramérovog V\n\nCohen (1988) je predložio smjernice ovisne o stupnjevima slobode. Za tablicu s k = 4 (naš slučaj):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntribble(\n  ~V, ~interpretacija,\n  \"0.06\", \"Mali učinak\",\n  \"0.17\", \"Srednji učinak\",\n  \"0.29\", \"Veliki učinak\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  V     interpretacija\n  <chr> <chr>         \n1 0.06  Mali učinak   \n2 0.17  Srednji učinak\n3 0.29  Veliki učinak \n```\n\n\n:::\n:::\n\n\nNaše V ≈ 0.31 je veliki učinak. Veza između dobi i medijskog tipa je ne samo statistički značajna nego i praktično snažna.\n\n---\n\n## Vizualizacija kategoričkih podataka {#sec-vizualizacija}\n\nKontingencijske tablice su korisne ali teške za brzo čitanje. Vizualizacije pomažu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Grupani stupčasti graf (najprikladniji za prezentaciju)\nsurvey |>\n  count(age_group, media_type) |>\n  group_by(age_group) |>\n  mutate(udio = n / sum(n)) |>\n  ungroup() |>\n  ggplot(aes(x = age_group, y = udio, fill = media_type)) +\n  geom_col(position = \"dodge\", alpha = 0.85) +\n  scale_y_continuous(labels = scales::label_percent()) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Preferirani tip medija po dobnim skupinama\",\n    subtitle = paste0(\"χ² = \", round(chi2_val, 1), \", p < 0.001, Cramérovo V = \", \n                      round(cramer_v, 2), \" (veliki učinak)\"),\n    x = \"Dobna skupina\",\n    y = \"Udio\",\n    fill = \"Tip medija\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/mozaik-ggplot-1.png){width=864}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Balon graf (dobra alternativa za kontingencijske tablice)\nsurvey |>\n  count(age_group, media_type) |>\n  group_by(age_group) |>\n  mutate(udio = n / sum(n)) |>\n  ungroup() |>\n  ggplot(aes(x = media_type, y = age_group, size = udio, color = udio)) +\n  geom_point() +\n  scale_size_continuous(range = c(2, 15), labels = scales::label_percent()) +\n  scale_color_viridis_c(option = \"D\", labels = scales::label_percent()) +\n  labs(\n    title = \"Balon graf: dob × tip medija\",\n    subtitle = \"Veći i svjetliji balon = veći udio u toj dobnoj skupini\",\n    x = \"Tip medija\",\n    y = \"Dobna skupina\",\n    size = \"Udio\", color = \"Udio\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 30, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/balon-graf-1.png){width=864}\n:::\n:::\n\n\n---\n\n## Hi-kvadrat test u praksi: korak po korak {#sec-koraci}\n\nSažmimo postupak u jasne korake koje možete primijeniti na bilo koji par kategoričkih varijabli.\n\n**Korak 1**: Formulirajte hipoteze.\n\n**Korak 2**: Napravite kontingencijsku tablicu i vizualizirajte podatke.\n\n**Korak 3**: Provjerite pretpostavke (sve očekivane frekvencije ≥ 5).\n\n**Korak 4**: Provedite test i izračunajte p-vrijednost.\n\n**Korak 5**: Izračunajte veličinu učinka (Cramérovo V).\n\n**Korak 6**: Pogledajte reziduale za specifična odstupanja.\n\n**Korak 7**: Interpretirajte u kontekstu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Primjer: postoji li veza između spola i preferencije sadržaja?\ntablica_spol <- table(survey$gender, survey$content_preference)\n\n# Korak 2: kontingencijska tablica\ntablica_spol\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         edukacija kultura sport vijesti zabava\n  muški         59      54    76     107     88\n  ženski        60      59    86     111    100\n```\n\n\n:::\n\n```{.r .cell-code}\n# Korak 3: provjera\nchi_spol <- chisq.test(tablica_spol)\ncat(\"\\nNajmanja očekivana frekvencija:\", round(min(chi_spol$expected), 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nNajmanja očekivana frekvencija: 54.2 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Korak 4: test\nchi_spol\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tablica_spol\nX-squared = 0.40693, df = 4, p-value = 0.9819\n```\n\n\n:::\n\n```{.r .cell-code}\n# Korak 5: Cramérovo V\nv_spol <- sqrt(chi_spol$statistic / (sum(tablica_spol) * (min(dim(tablica_spol)) - 1)))\ncat(\"Cramérovo V:\", round(v_spol, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCramérovo V: 0.023 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Korak 6: reziduali\ncat(\"\\nStandardizirani reziduali:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStandardizirani reziduali:\n```\n\n\n:::\n\n```{.r .cell-code}\nround(chi_spol$residuals, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         edukacija kultura sport vijesti zabava\n  muški       0.25   -0.03 -0.20    0.23  -0.24\n  ženski     -0.24    0.03  0.19   -0.22   0.23\n```\n\n\n:::\n:::\n\n\nU ovom primjeru, odnos između spola i preferencije sadržaja možda nije statistički značajan (ovisi o p-vrijednosti). Ovo je potpuno normalan rezultat: ne mora svaka veza biti značajna. Podatke treba pustiti da govore.\n\n---\n\n\n::: {.callout-note}\n## Podsjetnik\n\nU prvom dijelu naučili smo hi-kvadrat test za dobrotu prilagodbe i test nezavisnosti, očekivane frekvencije, standardizirane reziduale i Cramérovo V. U ovom dijelu pokrivamo situacije kad standardni hi-kvadrat test nije primjeren te provodimo potpunu analizu kategoričkih podataka.\n:::\n\n## Fisherov egzaktni test {#sec-fisher}\n\nHi-kvadrat test je aproksimacija koja radi dobro kad su očekivane frekvencije dovoljno velike (sve ≥ 5). Kad to nije slučaj (mali uzorak, rijetke kategorije), aproksimacija postaje nepouzdana. **Fisherov egzaktni test** računa točnu p-vrijednost bez aproksimacije.\n\nSituacija: testirate vezu između tipa CTA (call-to-action) i konverzije na malom uzorku od 40 newsletter kampanja.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mali uzorak: 40 kampanja, 2 x 2 tablica\nset.seed(42)\n\nkampanje <- tibble(\n  cta_tip = c(rep(\"direktni\", 20), rep(\"indirektni\", 20)),\n  konverzija = c(\n    sample(c(\"da\", \"ne\"), 20, replace = TRUE, prob = c(0.45, 0.55)),\n    sample(c(\"da\", \"ne\"), 20, replace = TRUE, prob = c(0.20, 0.80))\n  )\n)\n\ntablica_cta <- table(kampanje$cta_tip, kampanje$konverzija)\ntablica_cta\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n             da ne\n  direktni   12  8\n  indirektni  8 12\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Provjera ocekivanih frekvencija\nchi_cta <- chisq.test(tablica_cta, correct = FALSE)\nchi_cta$expected\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n             da ne\n  direktni   10 10\n  indirektni 10 10\n```\n\n\n:::\n:::\n\n\nNeke očekivane frekvencije su blizu 5 (ili ispod). Hi-kvadrat aproksimacija nije pouzdana. Koristimo Fisherov test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fisherov egzaktni test\nfisher.test(tablica_cta)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  tablica_cta\np-value = 0.3431\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.5370744 9.6150685\nsample estimates:\nodds ratio \n  2.203611 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usporedba tri pristupa\ncat(\"Hi-kvadrat (bez korekcije):  p =\", round(chi_cta$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHi-kvadrat (bez korekcije):  p = 0.2059 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Hi-kvadrat (Yates korekcija): p =\", round(chisq.test(tablica_cta)$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHi-kvadrat (Yates korekcija): p = 0.3428 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Fisherov egzaktni test:       p =\", round(fisher.test(tablica_cta)$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFisherov egzaktni test:       p = 0.3431 \n```\n\n\n:::\n:::\n\n\nFisherov test daje nešto drugačiju p-vrijednost od hi-kvadrata. Za male uzorke, Fisherov test je pouzdaniji. R po defaultu primjenjuje **Yatesovu korekciju kontinuiteta** na 2x2 tablice (`chisq.test` s `correct = TRUE`), što daje konzervativniju p-vrijednost, ali Fisherov test je ipak bolji izbor kad su očekivane frekvencije male.\n\n### Odds ratio iz Fisherovog testa\n\nFisherov test za 2x2 tablice automatski računa **odds ratio** (omjer šansi), što je korisna mjera veličine učinka za binarne ishode.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher_rez <- fisher.test(tablica_cta)\n\ncat(\"Odds ratio:\", round(fisher_rez$estimate, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOdds ratio: 2.2 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(fisher_rez$conf.int[1], 2), \",\", round(fisher_rez$conf.int[2], 2), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 0.54 , 9.62 ]\n```\n\n\n:::\n:::\n\n\nOdds ratio > 1 znači da je šansa konverzije veća uz direktni CTA. Odds ratio = 1 bi značio da nema razlike. CI koji ne sadrži 1 sugerira statistički značajnu razliku.\n\n::: {.callout-tip}\n## Kada koristiti koji test?\n\n**Hi-kvadrat test**: Kad su sve očekivane frekvencije >= 5 i tablica je veća od 2x2. Brz i dovoljno točan za velike uzorke.\n\n**Fisherov egzaktni test**: Kad su neke očekivane frekvencije < 5 ili je ukupni uzorak mali (< 50). Funkcionira za bilo koju veličinu tablice, ali je računalno zahtjevniji za veće tablice.\n\nU praksi, Fisherov test možete koristiti uvijek. Za velike uzorke daje identične rezultate kao hi-kvadrat. Razlika se pojavljuje samo za male uzorke, gdje je Fisherov test bolji.\n:::\n\n---\n\n## Spajanje kategorija {#sec-spajanje}\n\nPonekad kontingencijska tablica ima kategorije s vrlo malo opažanja. Umjesto da odmah pribjegnemo Fisherovom testu, možemo spojiti (kolapsirati) slične kategorije.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey <- read_csv(\"../resources/datasets/media_survey_chi2.csv\")\n\n# Originalna tablica: media_type ima 6 kategorija, neke male\ntable(survey$media_type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   podcast      radio  streaming      tisak         TV web_portal \n       109         97        177         45        199        173 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Spajanje: digitalni (streaming + web_portal + podcast) vs tradicionalni (TV + radio + tisak)\nsurvey <- survey |>\n  mutate(media_grupa = if_else(\n    media_type %in% c(\"streaming\", \"web_portal\", \"podcast\"),\n    \"digitalni\",\n    \"tradicionalni\"\n  ))\n\n# Nova tablica: 4 x 2 (preglednija i s vecim frekvencijama)\ntable(survey$age_group, survey$media_grupa)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       \n        digitalni tradicionalni\n  18-29       174            36\n  30-44       154            51\n  45-59        97           109\n  60+          34           145\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi_grupa <- chisq.test(table(survey$age_group, survey$media_grupa))\nchi_grupa\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table(survey$age_group, survey$media_grupa)\nX-squared = 198.89, df = 3, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Cramerovo V za 4 x 2 tablicu\nv_grupa <- sqrt(chi_grupa$statistic / (nrow(survey) * (min(4, 2) - 1)))\ncat(\"\\nCramerovo V:\", round(v_grupa, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCramerovo V: 0.499 \n```\n\n\n:::\n:::\n\n\nSažeta tablica je jasnija za komunikaciju rezultata. Umjesto šest kategorija, imamo jednu binarnu podjelu: digitalni vs tradicionalni mediji. Veza s dobi je i dalje izuzetno značajna i velika.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey |>\n  count(age_group, media_grupa) |>\n  group_by(age_group) |>\n  mutate(udio = n / sum(n)) |>\n  ungroup() |>\n  ggplot(aes(x = age_group, y = udio, fill = media_grupa)) +\n  geom_col(alpha = 0.85) +\n  scale_y_continuous(labels = scales::label_percent()) +\n  scale_fill_manual(values = c(\"digitalni\" = \"#2a9d8f\", \"tradicionalni\" = \"#e76f51\")) +\n  geom_text(aes(label = paste0(round(udio * 100), \"%\")), \n            position = position_stack(vjust = 0.5), color = \"white\", fontface = \"bold\") +\n  labs(\n    title = \"Digitalni vs tradicionalni mediji po dobnim skupinama\",\n    subtitle = paste0(\"chi2 = \", round(chi_grupa$statistic, 1), \", p < 0.001, V = \", \n                      round(v_grupa, 2)),\n    x = \"Dobna skupina\",\n    y = \"Udio\",\n    fill = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/spajanje-vizualizacija-1.png){width=768}\n:::\n:::\n\n\nPriča je sada kristalno jasna: 85% osoba 18-29 preferira digitalne medije, ali samo 26% osoba 60+. Generacijski jaz je masivan.\n\n---\n\n## Stratificirana analiza {#sec-stratifikacija}\n\nPonekad nas zanima je li veza između dviju varijabli konzistentna unutar podgrupa treće varijable. Na primjer: postoji li veza između medijskog tipa i zadovoljstva, ali odvojeno za svaku dobnu skupinu?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Zadovoljstvo kategorizirano: nisko (1-2), srednje (3), visoko (4-5)\nsurvey <- survey |>\n  mutate(satisfaction_cat = case_when(\n    satisfaction <= 2 ~ \"nisko\",\n    satisfaction == 3 ~ \"srednje\",\n    satisfaction >= 4 ~ \"visoko\"\n  ))\n\n# Hi-kvadrat test po dobnim skupinama\nsurvey |>\n  group_by(age_group) |>\n  summarise(\n    n = n(),\n    chi2 = chisq.test(table(media_grupa, satisfaction_cat))$statistic,\n    p = chisq.test(table(media_grupa, satisfaction_cat))$p.value,\n    V = {\n      tab <- table(media_grupa, satisfaction_cat)\n      sqrt(chisq.test(tab)$statistic / (n() * (min(dim(tab)) - 1)))\n    },\n    .groups = \"drop\"\n  ) |>\n  mutate(\n    chi2 = round(chi2, 2),\n    p = round(p, 4),\n    V = round(V, 3),\n    znacajno = p < 0.05\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  age_group     n  chi2      p     V znacajno\n  <chr>     <int> <dbl>  <dbl> <dbl> <lgl>   \n1 18-29       210  3.8  0.150  0.135 FALSE   \n2 30-44       205  4.44 0.108  0.147 FALSE   \n3 45-59       206  6.47 0.0394 0.177 TRUE    \n4 60+         179  4.85 0.0884 0.165 FALSE   \n```\n\n\n:::\n:::\n\n\nStratificirana analiza može otkriti da veza koja postoji ukupno ne postoji u svim podgrupama (ili obrnuto). Ovo je povezano s Simpsonovim paradoksom: agregirani rezultati mogu biti obmanjujući.\n\n---\n\n## Simpsonov paradoks {#sec-simpson}\n\n**Simpsonov paradoks** nastaje kad se smjer veze promijeni kad kontroliramo treću varijablu. Ovo je jedan od najvažnijih koncepata za razumijevanje kategoričkih podataka u komunikologiji.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Konstruirani primjer: dva portala, CTR po tipu uredaja\nsimpson <- tribble(\n  ~portal, ~uredaj, ~klikovi, ~prikazi,\n  \"Portal A\", \"mobitel\",  80, 1000,\n  \"Portal A\", \"desktop\", 180,  500,\n  \"Portal B\", \"mobitel\",  30,  500,\n  \"Portal B\", \"desktop\",  80,  200\n) |>\n  mutate(ctr = round(klikovi / prikazi * 100, 1))\n\n# Ukupni CTR\nsimpson |>\n  group_by(portal) |>\n  summarise(\n    ukupno_klikovi = sum(klikovi),\n    ukupno_prikazi = sum(prikazi),\n    ukupni_ctr = round(ukupno_klikovi / ukupno_prikazi * 100, 1),\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  portal   ukupno_klikovi ukupno_prikazi ukupni_ctr\n  <chr>             <dbl>          <dbl>      <dbl>\n1 Portal A            260           1500       17.3\n2 Portal B            110            700       15.7\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CTR po uredaju\nsimpson |>\n  select(portal, uredaj, ctr, prikazi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  portal   uredaj    ctr prikazi\n  <chr>    <chr>   <dbl>   <dbl>\n1 Portal A mobitel     8    1000\n2 Portal A desktop    36     500\n3 Portal B mobitel     6     500\n4 Portal B desktop    40     200\n```\n\n\n:::\n:::\n\n\nPortal B ima viši CTR na SVAKOM uređaju (mobitel: 6.0% vs 8.0%, desktop: 36.0% vs 40.0%). Ali Portal A može imati viši ukupni CTR! Razlog je u tome što Portal A ima mnogo više mobilnog prometa (1000 od 1500 prikaza) koji ima nizak CTR, dok Portal B ima relativno više desktop prometa s visokim CTR-om. Kad agregiramo, neravnomjerna raspodjela uređaja \"prevagne\" i stvori obmanjujuće ukupne brojke.\n\n::: {.callout-warning}\n## Upozorenje\n\nSimpsonov paradoks nije rijedak kuriozitet. U komunikološkim istraživanjima je čest jer se grupe (dobne, regionalne, platformske) razlikuju po veličini i karakteristikama. Kad god uspoređujete kategoričke podatke agregirano, zapitajte se: bi li se zaključak promijenio kad biste razdvojili po nekoj trećoj varijabli?\n:::\n\n---\n\n## McNemarov test za uparene proporcije {#sec-mcnemar}\n\nKad imate uparene kategoričke podatke (isti ispitanici mjereni dva puta), standardni hi-kvadrat test nije primjeren. Za tu situaciju koristimo **McNemarov test**.\n\nSituacija: 200 ispitanika je pitano preferiraju li online ili tiskane vijesti, jednom na početku i jednom na kraju semestra.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Simulacija: pomak prema onlineu kroz semestar\nn_mc <- 200\nprije <- sample(c(\"online\", \"tisak\"), n_mc, replace = TRUE, prob = c(0.55, 0.45))\n\n# Poslije: neki presli na online, malo ih preslo na tisak\nposlije <- prije\npromijenili <- sample(1:n_mc, 40)\nfor (i in promijenili[1:30]) poslije[i] <- \"online\"\nfor (i in promijenili[31:40]) poslije[i] <- \"tisak\"\n\nmc_tablica <- table(Prije = prije, Poslije = poslije)\nmc_tablica\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Poslije\nPrije    online tisak\n  online     95     4\n  tisak      15    86\n```\n\n\n:::\n:::\n\n\nOva tablica se čita ovako: na dijagonali su ispitanici koji NISU promijenili mišljenje. Izvan dijagonale su oni koji jesu. McNemarov test testira je li broj promjena u jednom smjeru (tisak na online) značajno veći od broja promjena u drugom (online na tisak).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcnemar.test(mc_tablica)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMcNemar's Chi-squared test with continuity correction\n\ndata:  mc_tablica\nMcNemar's chi-squared = 5.2632, df = 1, p-value = 0.02178\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koliko je preslo u kojem smjeru?\ntisak_na_online <- mc_tablica[\"tisak\", \"online\"]\nonline_na_tisak <- mc_tablica[\"online\", \"tisak\"]\n\ncat(\"Presli tisak na online:\", tisak_na_online, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPresli tisak na online: 15 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Presli online na tisak:\", online_na_tisak, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPresli online na tisak: 4 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Neto pomak prema onlineu:\", tisak_na_online - online_na_tisak, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeto pomak prema onlineu: 11 \n```\n\n\n:::\n:::\n\n\nMcNemarov test pokazuje je li pomak prema online vijestima statistički značajan. Više ispitanika je prešlo s tiska na online nego obrnuto.\n\n::: {.callout-important}\n## Kada koristiti McNemarov test?\n\nKad imate **iste ispitanike** mjerene dva puta na istoj binarnoj varijabli. Primjeri: preferencija prije i poslije kampanje, stav prije i poslije vijesti, izbor prije i poslije redizajna. McNemarov test je za kategoričke podatke ono što je upareni t-test za numeričke.\n:::\n\n---\n\n## Potpuna analiza: medijske navike i demografija {#sec-analiza}\n\nProvedimo kompletnu analizu kategoričkih podataka na našem datasetu. Istražujemo tri pitanja: (1) Ovisi li tip medija o dobi? (2) Ovisi li o regiji? (3) Ovisi li preferencija sadržaja o obrazovanju?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pitanje 1: Dob x tip medija (detaljno, svih 6 tipova)\ntab1 <- table(survey$age_group, survey$media_type)\ntest_q1 <- chisq.test(tab1)\nv1 <- sqrt(test_q1$statistic / (sum(tab1) * (min(dim(tab1)) - 1)))\n\ncat(\"=== PITANJE 1: Dob x Tip medija ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== PITANJE 1: Dob x Tip medija ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"chi2(\", (nrow(tab1)-1)*(ncol(tab1)-1), \") = \", round(test_q1$statistic, 1),\n    \", p < 0.001, V = \", round(v1, 2), \"\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nchi2(15) = 233.6, p < 0.001, V = 0.31\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija: Jaka veza. Mladi preferiraju streaming i portale,\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: Jaka veza. Mladi preferiraju streaming i portale,\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"stariji TV i radio.\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nstariji TV i radio.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Koji reziduali su najjaci?\nrez_df <- as.data.frame(test_q1$residuals) |>\n  as_tibble() |>\n  rename(age = Var1, media = Var2, r = Freq) |>\n  filter(abs(r) > 2) |>\n  arrange(desc(abs(r)))\n\ncat(\"Celije s |rezidual| > 2:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCelije s |rezidual| > 2:\n```\n\n\n:::\n\n```{.r .cell-code}\nrez_df |>\n  mutate(r = round(r, 1), smjer = if_else(r > 0, \"VISE nego ocekivano\", \"MANJE nego ocekivano\")) |>\n  print(n = 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 4\n   age   media          r smjer               \n   <fct> <fct>      <dbl> <chr>               \n 1 18-29 streaming    6.4 VISE nego ocekivano \n 2 60+   TV           5.9 VISE nego ocekivano \n 3 60+   streaming   -5.2 MANJE nego ocekivano\n 4 18-29 TV          -4.2 MANJE nego ocekivano\n 5 60+   radio        4.1 VISE nego ocekivano \n 6 30-44 podcast      3.8 VISE nego ocekivano \n 7 30-44 TV          -3.8 MANJE nego ocekivano\n 8 18-29 radio       -3.5 MANJE nego ocekivano\n 9 60+   podcast     -3.3 MANJE nego ocekivano\n10 60+   web_portal  -3.2 MANJE nego ocekivano\n11 60+   tisak        3.1 VISE nego ocekivano \n12 45-59 TV           2.5 VISE nego ocekivano \n13 45-59 streaming   -2.5 MANJE nego ocekivano\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pitanje 2: Regija x tip medija (digitalni vs tradicionalni)\ntab2 <- table(survey$region, survey$media_grupa)\ntest_q2 <- chisq.test(tab2)\nv2 <- sqrt(test_q2$statistic / (sum(tab2) * (min(dim(tab2)) - 1)))\n\ncat(\"=== PITANJE 2: Regija x Digitalni/Tradicionalni ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== PITANJE 2: Regija x Digitalni/Tradicionalni ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"chi2(\", (nrow(tab2)-1)*(ncol(tab2)-1), \") = \", round(test_q2$statistic, 2),\n    \", p = \", round(test_q2$p.value, 4), \", V = \", round(v2, 3), \"\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nchi2(4) = 9.01, p = 0.0609, V = 0.106\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\", if_else(test_q2$p.value < 0.05,\n    \"Postoji znacajna razlika medju regijama.\",\n    \"Nema znacajne razlike medju regijama.\"), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: Nema znacajne razlike medju regijama. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Proporcije digitalnih po regiji\nsurvey |>\n  group_by(region) |>\n  summarise(\n    n = n(),\n    udio_digitalni = round(mean(media_grupa == \"digitalni\") * 100, 1),\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(udio_digitalni))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  region           n udio_digitalni\n  <chr>        <int>          <dbl>\n1 Sjeverozapad   137           65.7\n2 Slavonija      165           61.8\n3 Zagreb         258           55  \n4 Dalmacija      139           54  \n5 Primorje       101           49.5\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pitanje 3: Obrazovanje x preferencija sadrzaja\ntab3 <- table(survey$education, survey$content_preference)\nchi3 <- chisq.test(tab3)\nv3 <- sqrt(chi3$statistic / (sum(tab3) * (min(dim(tab3)) - 1)))\n\ncat(\"=== PITANJE 3: Obrazovanje x Preferencija sadrzaja ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== PITANJE 3: Obrazovanje x Preferencija sadrzaja ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"chi2(\", (nrow(tab3)-1)*(ncol(tab3)-1), \") = \", round(chi3$statistic, 2), \n    \", p = \", round(chi3$p.value, 4), \", V = \", round(v3, 3), \"\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nchi2(12) = 10.48, p = 0.5742, V = 0.066\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\", if_else(chi3$p.value < 0.05, \n    \"Postoji znacajna veza.\", \n    \"Nema znacajne veze.\"), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: Nema znacajne veze. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Vizualizacija\nsurvey |>\n  mutate(education = factor(education, levels = c(\"osnovna\", \"srednja\", \"visa\", \"visoka\"))) |>\n  count(education, content_preference) |>\n  group_by(education) |>\n  mutate(udio = n / sum(n)) |>\n  ungroup() |>\n  ggplot(aes(x = education, y = udio, fill = content_preference)) +\n  geom_col(position = \"dodge\", alpha = 0.85) +\n  scale_y_continuous(labels = scales::label_percent()) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Preferencija sadrzaja po razini obrazovanja\",\n    subtitle = paste0(\"chi2 = \", round(chi3$statistic, 1), \", p = \", round(chi3$p.value, 3), \n                      \", V = \", round(v3, 2)),\n    x = \"Razina obrazovanja\",\n    y = \"Udio\",\n    fill = \"Sadrzaj\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-11_files/figure-html/analiza-q3-1.png){width=864}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sazetak svih testova\ncat(\"================================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   SAZETAK ANALIZE KATEGORICKIH PODATAKA\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   SAZETAK ANALIZE KATEGORICKIH PODATAKA\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"================================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ntibble(\n  pitanje = c(\"Dob x Tip medija\", \"Regija x Dig./Trad.\", \"Obrazovanje x Sadrzaj\"),\n  chi2 = round(c(test_q1$statistic, test_q2$statistic, chi3$statistic), 1),\n  df = c((nrow(tab1)-1)*(ncol(tab1)-1), (nrow(tab2)-1)*(ncol(tab2)-1), (nrow(tab3)-1)*(ncol(tab3)-1)),\n  p = c(format(test_q1$p.value, scientific = TRUE, digits = 2),\n        round(test_q2$p.value, 4), round(chi3$p.value, 4)),\n  V = round(c(v1, v2, v3), 3),\n  velicina = c(\n    if_else(v1 > 0.29, \"veliki\", if_else(v1 > 0.17, \"srednji\", \"mali\")),\n    if_else(v2 > 0.29, \"veliki\", if_else(v2 > 0.17, \"srednji\", \"mali\")),\n    if_else(v3 > 0.29, \"veliki\", if_else(v3 > 0.17, \"srednji\", \"mali\"))\n  )\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 6\n  pitanje                chi2    df p           V velicina\n  <chr>                 <dbl> <dbl> <chr>   <dbl> <chr>   \n1 Dob x Tip medija      234.     15 2.9e-41 0.312 veliki  \n2 Regija x Dig./Trad.     9       4 0.0609  0.106 mali    \n3 Obrazovanje x Sadrzaj  10.5    12 0.5742  0.066 mali    \n```\n\n\n:::\n:::\n\n\nAnaliza otkriva jasan obrazac. Veza između dobi i tipa medija je najjača i najvažnija: generacijski jaz u medijskim navikama je velik i statistički nedvojben. Regionalne razlike u digitalnim vs tradicionalnim medijima su mnogo manje (ako uopće postoje). Veza obrazovanja i preferencije sadržaja varira ovisno o uzorku.\n\n---\n\n## Uobičajene pogreške i ograničenja {#sec-pogreske}\n\nHi-kvadrat testovi su jednostavni za provesti ali lako ih je krivo primijeniti ili interpretirati.\n\n**Pogreška 1: Korištenje postotaka umjesto frekvencija.** Chi2 test zahtijeva frekvencije (apsolutne brojeve), ne postotke ili proporcije. `chisq.test(c(30, 20, 50))` je ispravno. `chisq.test(c(0.30, 0.20, 0.50))` će dati besmislene rezultate jer misli da ukupno imate 1 opažanje.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# KRIVO: postoci\ncat(\"KRIVO (postoci):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKRIVO (postoci):\n```\n\n\n:::\n\n```{.r .cell-code}\nchisq.test(c(0.30, 0.20, 0.50))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  c(0.3, 0.2, 0.5)\nX-squared = 0.14, df = 2, p-value = 0.9324\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nISPRAVNO (frekvencije):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nISPRAVNO (frekvencije):\n```\n\n\n:::\n\n```{.r .cell-code}\nchisq.test(c(30, 20, 50))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  c(30, 20, 50)\nX-squared = 14, df = 2, p-value = 0.0009119\n```\n\n\n:::\n:::\n\n\n**Pogreška 2: Pretjerana granularnost.** Tablica 10 x 8 s ukupno 100 opažanja imat će mnogo ćelija s malim frekvencijama. Bolje je spojiti kategorije i imati manje ali punije ćelije.\n\n**Pogreška 3: Kauzalna interpretacija.** Chi2 test detektira asocijaciju (vezu), ne kauzalnost. Činjenica da su dob i medijski tip povezani ne znači da dob uzrokuje preferenciju (možda je obrazovanje, socioekonomski status ili kohorta efekt). Za kauzalne zaključke trebate eksperimentalni dizajn ili napredne metode.\n\n**Pogreška 4: Zaboravljanje veličine učinka.** Kao i kod t-testa, p-vrijednost ovisi o veličini uzorka. S dovoljno velikim uzorkom, i trivijalna veza postaje \"statistički značajna.\" Uvijek izvijestite Cramérovo V uz chi2 i p.\n\n**Pogreška 5: Testiranje iste hipoteze više puta.** Ako testirate 10 parova varijabli, imate isti problem višestrukog testiranja kao kod t-testa. Koristite korekciju (Bonferroni ili BH).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Testiramo sve parove kategorickih varijabli\nparovi <- list(\n  c(\"age_group\", \"media_type\"),\n  c(\"age_group\", \"content_preference\"),\n  c(\"age_group\", \"media_grupa\"),\n  c(\"gender\", \"media_type\"),\n  c(\"gender\", \"content_preference\"),\n  c(\"education\", \"media_type\"),\n  c(\"education\", \"content_preference\"),\n  c(\"region\", \"media_grupa\")\n)\n\nmulti_chi <- map_df(parovi, \\(par) {\n  tab <- table(survey[[par[1]]], survey[[par[2]]])\n  test <- chisq.test(tab)\n  tibble(\n    var1 = par[1],\n    var2 = par[2],\n    chi2 = round(test$statistic, 1),\n    p = test$p.value\n  )\n}) |>\n  mutate(\n    p_adj = p.adjust(p, method = \"BH\"),\n    znacajno_orig = p < 0.05,\n    znacajno_adj = p_adj < 0.05\n  ) |>\n  arrange(p)\n\nmulti_chi |>\n  mutate(p = format(p, scientific = TRUE, digits = 2),\n         p_adj = format(p_adj, scientific = TRUE, digits = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 7\n  var1      var2                chi2 p       p_adj   znacajno_orig znacajno_adj\n  <chr>     <chr>              <dbl> <chr>   <chr>   <lgl>         <lgl>       \n1 age_group media_grupa        199.  7.3e-43 5.9e-42 TRUE          TRUE        \n2 age_group media_type         234.  2.9e-41 1.2e-40 TRUE          TRUE        \n3 age_group content_preference  59.7 2.5e-08 6.8e-08 TRUE          TRUE        \n4 education media_type          25.5 4.4e-02 8.8e-02 TRUE          FALSE       \n5 region    media_grupa          9   6.1e-02 9.8e-02 FALSE         FALSE       \n6 education content_preference  10.5 5.7e-01 7.2e-01 FALSE         FALSE       \n7 gender    media_type           3.5 6.3e-01 7.2e-01 FALSE         FALSE       \n8 gender    content_preference   0.4 9.8e-01 9.8e-01 FALSE         FALSE       \n```\n\n\n:::\n:::\n\n\nNakon BH korekcije, možda se neki marginalno značajni rezultati izgube. Ovo je cijena korektnog pristupa višestrukom testiranju.\n\n---\n\n## Pomoćna funkcija za kompletni hi-kvadrat izvještaj {#sec-funkcija}\n\nU praksi često ponavljamo iste korake za svaki par varijabli. Napišimo funkciju koja automatizira cijeli postupak.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi_izvjestaj <- function(data, var1, var2) {\n  tab <- table(data[[var1]], data[[var2]])\n  test <- chisq.test(tab)\n  v <- sqrt(test$statistic / (sum(tab) * (min(dim(tab)) - 1)))\n  min_exp <- min(test$expected)\n  \n  cat(\"======================================\\n\")\n  cat(var1, \"x\", var2, \"\\n\")\n  cat(\"======================================\\n\")\n  cat(\"Dimenzije tablice:\", nrow(tab), \"x\", ncol(tab), \"\\n\")\n  cat(\"Najm. ocekivana frekvencija:\", round(min_exp, 1), \"\\n\")\n  \n  if (min_exp < 5) {\n    cat(\"Ocekivane frekvencije < 5. Koristim Fisherov test.\\n\")\n    fisher <- fisher.test(tab, simulate.p.value = TRUE)\n    cat(\"P-vrijednost (Fisher):\", round(fisher$p.value, 4), \"\\n\")\n  } else {\n    cat(\"chi2(\", (nrow(tab)-1)*(ncol(tab)-1), \") = \", \n        round(test$statistic, 2), \"\\n\", sep = \"\")\n    cat(\"P-vrijednost:\", format(test$p.value, scientific = TRUE, digits = 3), \"\\n\")\n  }\n  \n  cat(\"Cramerovo V:\", round(v, 3), \"\\n\")\n  cat(\"Odluka:\", if_else(test$p.value < 0.05, \n    \"Postoji statisticki znacajna veza.\", \n    \"Nema statisticki znacajne veze.\"), \"\\n\\n\")\n  \n  invisible(list(table = tab, test = test, V = v))\n}\n\n# Primjeri koristenja\nchi_izvjestaj(survey, \"age_group\", \"media_type\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n======================================\nage_group x media_type \n======================================\nDimenzije tablice: 4 x 6 \nNajm. ocekivana frekvencija: 10.1 \nchi2(15) = 233.59\nP-vrijednost: 2.93e-41 \nCramerovo V: 0.312 \nOdluka: Postoji statisticki znacajna veza. \n```\n\n\n:::\n\n```{.r .cell-code}\nchi_izvjestaj(survey, \"gender\", \"content_preference\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n======================================\ngender x content_preference \n======================================\nDimenzije tablice: 2 x 5 \nNajm. ocekivana frekvencija: 54.2 \nchi2(4) = 0.41\nP-vrijednost: 9.82e-01 \nCramerovo V: 0.023 \nOdluka: Nema statisticki znacajne veze. \n```\n\n\n:::\n:::\n\n\nOva funkcija automatski provjerava pretpostavke, odabire odgovarajući test i računa veličinu učinka. Možete je koristiti u svim budućim analizama kategoričkih podataka.\n\n---\n\n## Pregled svih testova za kategoričke podatke {#sec-pregled}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntribble(\n  ~test, ~situacija, ~R_kod,\n  \"chi2 goodness-of-fit\", \"Jedna varijabla vs ocekivana distribucija\", \"chisq.test(frekvencije, p = proporcije)\",\n  \"chi2 nezavisnosti\", \"Veza dviju kategorickih varijabli\", \"chisq.test(table(x, y))\",\n  \"Fisherov egzaktni\", \"Male ocekivane frekvencije ili mali n\", \"fisher.test(table(x, y))\",\n  \"McNemarov test\", \"Uparene kategoricke varijable\", \"mcnemar.test(table(prije, poslije))\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  test                 situacija                                 R_kod          \n  <chr>                <chr>                                     <chr>          \n1 chi2 goodness-of-fit Jedna varijabla vs ocekivana distribucija chisq.test(fre…\n2 chi2 nezavisnosti    Veza dviju kategorickih varijabli         chisq.test(tab…\n3 Fisherov egzaktni    Male ocekivane frekvencije ili mali n     fisher.test(ta…\n4 McNemarov test       Uparene kategoricke varijable             mcnemar.test(t…\n```\n\n\n:::\n:::\n\n\n---\n\n::: {.callout-important}\n## Ključni zaključci\n\n1. Hi-kvadrat testovi se koriste kad su varijable kategoričke. Test za dobrotu prilagodbe uspoređuje jednu varijablu s očekivanom distribucijom. Test nezavisnosti testira vezu dviju varijabli.\n\n2. Chi2 statistika mjeri ukupno odstupanje opaženih od očekivanih frekvencija: chi2 = suma (O minus E)^2 / E. Veći chi2 = jači dokaz protiv H0.\n\n3. Očekivane frekvencije pod H0 su E = (ukupno u retku puta ukupno u stupcu) / ukupno. Pretpostavka: sve E >= 5.\n\n4. Standardizirani reziduali identificiraju specifične ćelije koje najviše doprinose vezi. |r| > 2 je značajno. Uvijek ih izvijestite jer chi2 sam ne govori gdje je veza najjača.\n\n5. Cramérovo V mjeri jačinu veze (0 do 1). Za k = 4: V oko 0.06 mali, V oko 0.17 srednji, V oko 0.29 veliki učinak. Uvijek ga izvijestite uz chi2 i p.\n\n6. Fisherov egzaktni test koristite kad su očekivane frekvencije < 5 ili je uzorak mali. Za 2x2 tablice automatski daje odds ratio.\n\n7. Spajanje kategorija (kolapsiranje) je legitiman pristup kad su neke kategorije prerijetke. Digitalni vs tradicionalni mediji je informativnije od šest odvojenih kategorija.\n\n8. Simpsonov paradoks upozorava da agregirani rezultati mogu biti obmanjujući. Uvijek provjerite rezultate stratificirane po relevantnoj trećoj varijabli.\n\n9. McNemarov test je za uparene kategoričke podatke (isti ispitanici, dva mjerenja). Ekvivalent uparenom t-testu za kategoričke varijable.\n\n10. Hi-kvadrat test detektira asocijaciju, ne kauzalnost. Veza dobi i medijskog tipa ne znači da dob uzrokuje preferenciju.\n\n11. Višestruko testiranje je problem i kod hi-kvadrat testova. Koristite BH ili Bonferroni korekciju kad testirate mnogo parova varijabli.\n\n12. Kompletni izvještaj uključuje kontingencijsku tablicu, vizualizaciju (stacked/dodged barplot), chi2 s df i p, Cramérovo V s interpretacijom, reziduale za specifična odstupanja i praktičnu interpretaciju u kontekstu istraživačkog pitanja.\n:::\n\n---\n\n## Zadaci za pripremu\n\n1. Učitajte `media_survey_chi2.csv`. Testirajte postoji li veza između regije i preferencije sadržaja (`content_preference`). Izračunajte Cramérovo V i interpretirajte ga. Koji reziduali su najjači?\n\n2. Kreirajte novu varijablu `zadovoljni` (satisfaction >= 4 = \"da\", inače \"ne\"). Testirajte postoji li veza između `media_grupa` (digitalni/tradicionalni) i `zadovoljni` pomoću Fisherovog egzaktnog testa. Interpretirajte odds ratio.\n\n3. Napišite funkciju `chi_vizualizacija(data, var1, var2)` koja prima podatke i imena dviju varijabli te automatski crta grupani barplot s rezultatima testa u podnaslovu.\n\n---\n\n## Dodatno čitanje\n\n**Obavezno**\n\nNavarro, D. (2018). *Learning Statistics with R*, Chapter 12 (Categorical Data Analysis). Besplatno dostupno na [learningstatisticswithr.com](https://learningstatisticswithr.com/lsr-0.6.pdf). Pokriva hi-kvadrat testove s R kodom.\n\n**Preporučeno**\n\nAgresti, A. (2018). *An Introduction to Categorical Data Analysis* (3rd edition). Wiley. Poglavlja 1-3. Referentni udžbenik za kategoričke podatke.\n\nWickham, H. & Grolemund, G. (2017). *R for Data Science*. O'Reilly. Besplatno na [r4ds.had.co.nz](https://r4ds.had.co.nz). Poglavlja o faktorima i vizualizaciji kategoričkih podataka.\n\n---\n\n## Pojmovnik\n\n| Pojam | Objašnjenje |\n|---|---|\n| Kategorička varijabla | Varijabla čije su vrijednosti kategorije (npr. spol, regija, tip medija). Nema smisleni numerički poredak (nominalna) ili ima (ordinalna). |\n| Kontingencijska tablica | Tablica frekvencija za sve kombinacije dviju kategoričkih varijabli. Temelj za test nezavisnosti. |\n| Hi-kvadrat statistika | Mjera ukupnog odstupanja opaženih od očekivanih frekvencija. |\n| Goodness-of-fit test | Testira odgovara li distribucija jedne varijable očekivanoj distribuciji. df = k minus 1. |\n| Test nezavisnosti | Testira postoji li veza između dviju kategoričkih varijabli. df = (r minus 1)(c minus 1). |\n| Očekivana frekvencija | Frekvencija pod H0. Za test nezavisnosti: E = (redak total puta stupac total) / ukupno. |\n| Standardizirani rezidual | (O minus E) / korijen(E). Doprinos svake ćelije ukupnom chi2. Značajno ako |r| > 2. |\n| Cramérovo V | Mjera veličine učinka za hi-kvadrat test. V = korijen(chi2/(n(k minus 1))). Raspon 0 do 1. |\n| Fisherov egzaktni test | Točan test za male uzorke ili male očekivane frekvencije. Ne koristi chi2 aproksimaciju. |\n| Odds ratio (omjer šansi) | Mjera asocijacije za 2x2 tablice. OR = 1 znači nema veze. OR > 1 ili < 1 znači veza postoji. |\n| Yatesova korekcija | Korekcija kontinuiteta za 2x2 tablice. R je primjenjuje po defaultu u `chisq.test()`. |\n| McNemarov test | Test za uparene kategoričke podatke (isti ispitanici, dva mjerenja). |\n| Simpsonov paradoks | Smjer veze se promijeni kad kontroliramo treću varijablu. Agregirani rezultati obmanjuju. |\n| Stratificirana analiza | Provođenje testa odvojeno za podgrupe treće varijable. Otkriva Simpsonov paradoks. |\n| Spajanje kategorija | Kolapsiranje rijetkih kategorija u šire grupe. Povećava očekivane frekvencije i preglednost. |\n| `chisq.test()` | R funkcija za hi-kvadrat test. Prima vektor frekvencija (gof) ili kontingencijsku tablicu. |\n| `fisher.test()` | R funkcija za Fisherov egzaktni test. Prima kontingencijsku tablicu. |\n| `mcnemar.test()` | R funkcija za McNemarov test. Prima 2x2 tablicu uparenih podataka. |\n| `table()` | R funkcija za kreiranje kontingencijske tablice. `table(x, y)` za dvije varijable. |\n| `prop.table()` | Pretvara frekvencije u proporcije. `margin = 1` za retke, `margin = 2` za stupce. |\n| `p.adjust()` | Korekcija p-vrijednosti za višestruko testiranje. `method = \"BH\"` je preporučen. |\n",
    "supporting": [
      "week-11_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}