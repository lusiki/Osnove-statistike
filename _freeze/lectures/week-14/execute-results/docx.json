{
  "hash": "a751cb90b0a3ebca811dc8682b13f1d9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tjedan 14: Linearna regresija\"\nsubtitle: \"Predvidjanje i objašnjavanje s modelima\"\ndate: 2025-05-24\ncategories: [regresija, korelacija, R-kvadrat, dijagnostika, višestruka regresija]\ndraft: false\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n::: {.callout-note}\n## Ishodi učenja\n\nNakon ovog predavanja moći ćete\n\n1. Objasniti razliku između korelacije i regresije.\n2. Provesti jednostavnu linearnu regresiju u R-u i interpretirati koeficijente.\n3. Interpretirati R-kvadrat kao mjeru kvalitete modela.\n4. Provjeriti pretpostavke linearne regresije dijagnostičkim grafovima.\n5. Provesti višestruku regresiju s više prediktora i interpretirati parcijalne koeficijente.\n6. Usporediti modele pomoću R-kvadrata, prilagodenog R-kvadrata i AIC-a.\n7. Prepoznati uobičajene probleme (multikolinearnost, utjecajne točke, nelinearnost).\n8. Napisati kompletni izvještaj regresijske analize.\n:::\n\n## Motivacija: što pokreće angažman?\n\nSocial media menadžerica želi znati: koji faktori utječu na angažman Instagram objava? Duljina teksta? Broj hashtagova? Tip sadržaja? Vrijeme objave? I koliko dobro možemo predvidjeti angažman na temelju tih faktora?\n\nANOVA (prošli tjedan) odgovara na pitanje \"razlikuju li se grupe.\" Regresija ide dalje: modelira odnos između jedne ili više nezavisnih varijabli (prediktora) i zavisne varijable (ishoda), kvantificira snagu i smjer svakog odnosa, i omogućuje predvidjanje novih opažanja.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposts <- read_csv(\"../resources/datasets/social_engagement.csv\")\nglimpse(posts)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 400\nColumns: 14\n$ post_id         <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ day             <chr> \"utorak\", \"ponedjeljak\", \"petak\", \"nedjelja\", \"subota\"…\n$ time_slot       <chr> \"18-21\", \"09-12\", \"21-24\", \"12-15\", \"15-18\", \"18-21\", …\n$ content_type    <chr> \"foto\", \"tekst\", \"carousel\", \"foto\", \"carousel\", \"reel…\n$ topic           <chr> \"iza_kulisa\", \"proizvod\", \"zabava\", \"zabava\", \"proizvo…\n$ text_length     <dbl> 290, 34, 35, 162, 240, 189, 300, 228, 242, 97, 136, 17…\n$ num_hashtags    <dbl> 0, 17, 19, 14, 20, 9, 25, 21, 6, 12, 0, 23, 27, 27, 20…\n$ has_cta         <dbl> 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, …\n$ num_mentions    <dbl> 3, 1, 1, 4, 0, 4, 4, 1, 1, 1, 2, 4, 1, 4, 4, 4, 3, 0, …\n$ followers       <dbl> 15095, 15312, 14749, 14728, 15336, 14722, 15168, 14805…\n$ engagement_rate <dbl> 4.93, 2.26, 7.32, 5.58, 4.03, 6.58, 3.51, 6.74, 2.03, …\n$ likes           <dbl> 594, 284, 860, 583, 500, 692, 447, 816, 212, 548, 476,…\n$ comments        <dbl> 120, 76, 174, 81, 93, 138, 88, 195, 45, 150, 87, 33, 4…\n$ shares          <dbl> 78, 32, 115, 91, 70, 124, 41, 59, 45, 92, 80, 34, 25, …\n```\n\n\n:::\n:::\n\n\n---\n\n## Od korelacije do regresije {#sec-korelacija}\n\nKorelacija mjeri jačinu i smjer linearne veze između dviju varijabli. Regresija ide korak dalje: definira jednadžbu pravca koja opisuje tu vezu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korelacije numeričkih prediktora s engagement_rate\nposts |>\n  select(engagement_rate, text_length, num_hashtags, num_mentions, followers) |>\n  cor() |>\n  round(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                engagement_rate text_length num_hashtags num_mentions followers\nengagement_rate           1.000       0.040       -0.411       -0.016    -0.132\ntext_length               0.040       1.000        0.008        0.061    -0.025\nnum_hashtags             -0.411       0.008        1.000        0.031     0.062\nnum_mentions             -0.016       0.061        0.031        1.000     0.092\nfollowers                -0.132      -0.025        0.062        0.092     1.000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposts |>\n  ggplot(aes(x = num_hashtags, y = engagement_rate)) +\n  geom_point(alpha = 0.3, color = \"steelblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"firebrick\") +\n  labs(\n    title = \"Broj hashtagova i engagement rate\",\n    subtitle = paste0(\"r = \", round(cor(posts$num_hashtags, posts$engagement_rate), 3)),\n    x = \"Broj hashtagova\",\n    y = \"Engagement rate (%)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/scatter-hashtags-1.png)\n:::\n:::\n\n\nKorelacija između broja hashtagova i engagement ratea je negativna (r ≈ -0.41). Ali pozor: ovo ne znači nužno da više hashtagova uzrokuje niži angažman. Možda je veza nelinearna (optimalni broj hashtagova postoji). Ovo ćemo istražiti u dijagnostici.\n\n---\n\n## Jednostavna linearna regresija {#sec-jednostavna}\n\nJednostavna linearna regresija modelira vezu jednog prediktora (X) i ishoda (Y):\n\n$$Y = b_0 + b_1 X + \\varepsilon$$\n\ngdje je $b_0$ odsječak (intercept, vrijednost Y kad je X = 0), $b_1$ nagib (slope, promjena Y za svaku jedinicu promjene u X), a $\\varepsilon$ greška (rezidual, ono što model ne objašnjava).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Jednostavna regresija: text_length -> engagement_rate\nmodel1 <- lm(engagement_rate ~ text_length, data = posts)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = engagement_rate ~ text_length, data = posts)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9713 -1.4744 -0.0468  1.5489  6.1332 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 4.034491   0.238994  16.881   <2e-16 ***\ntext_length 0.001034   0.001299   0.796    0.426    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.102 on 398 degrees of freedom\nMultiple R-squared:  0.001591,\tAdjusted R-squared:  -0.0009177 \nF-statistic: 0.6342 on 1 and 398 DF,  p-value: 0.4263\n```\n\n\n:::\n:::\n\n\n### Čitanje regresijskog outputa\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkoef <- coef(model1)\n\ncat(\"Jednadžba: engagement_rate = \", round(koef[1], 3), \" + \", \n    round(koef[2], 5), \" * text_length\\n\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nJednadžba: engagement_rate = 4.034 + 0.00103 * text_length\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Intercept (b0 = \", round(koef[1], 2), \"): Ocekivani engagement rate\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Intercept (b0 = 4.03): Ocekivani engagement rate\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  kad je text_length = 0 (teorijska vrijednost, nema prakticnog znacenja).\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  kad je text_length = 0 (teorijska vrijednost, nema prakticnog znacenja).\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Slope (b1 = \", round(koef[2], 4), \"): Za svaki dodatni znak u tekstu,\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Slope (b1 = 0.001): Za svaki dodatni znak u tekstu,\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  engagement rate se mijenja za \", round(koef[2], 4), \" postotnih bodova.\\n\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  engagement rate se mijenja za 0.001 postotnih bodova.\n```\n\n\n:::\n\n```{.r .cell-code}\n# R-kvadrat\nr2 <- summary(model1)$r.squared\ncat(\"R-kvadrat:\", round(r2, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR-kvadrat: 0.0016 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\", round(r2 * 100, 1), \"% varijabilnosti u engagement rateu\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: 0.2 % varijabilnosti u engagement rateu\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"je objasnjeno duljinom teksta. To je vrlo malo.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nje objasnjeno duljinom teksta. To je vrlo malo.\n```\n\n\n:::\n:::\n\n\nR-kvadrat je nizak jer duljina teksta sama nije dobar prediktor angažmana. Trebamo više prediktora (višestruka regresija).\n\n### Vizualizacija regresijskog pravca\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposts |>\n  ggplot(aes(x = text_length, y = engagement_rate)) +\n  geom_point(alpha = 0.25, color = \"grey50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"firebrick\", fill = \"firebrick\", alpha = 0.2) +\n  annotate(\"text\", x = 250, y = 9, \n           label = paste0(\"Y = \", round(koef[1], 2), \" + \", round(koef[2], 4), \"X\\nR² = \", round(r2, 3)),\n           color = \"firebrick\", hjust = 0) +\n  labs(\n    title = \"Jednostavna linearna regresija: duljina teksta i angažman\",\n    subtitle = \"Sivi pojas = 95% CI za regresijski pravac\",\n    x = \"Duljina teksta (znakovi)\",\n    y = \"Engagement rate (%)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/regresijski-pravac-1.png)\n:::\n:::\n\n\n---\n\n## Što su reziduali? {#sec-reziduali}\n\n**Reziduali** su razlike između opaženih i predvidjenih vrijednosti:\n\n$$e_i = Y_i - \\hat{Y}_i$$\n\nRegresija minimizira sumu kvadriranih reziduala (OLS, Ordinary Least Squares). Reziduali nam govore koliko model griješi za svako pojedino opažanje.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dodajmo predvidjene vrijednosti i reziduale u podatke\nposts_pred <- posts |>\n  mutate(\n    predicted = predict(model1),\n    residual = residuals(model1)\n  )\n\n# Prikaz reziduala za prvih 20 objava\nposts_pred |>\n  slice(1:20) |>\n  ggplot(aes(x = text_length, y = engagement_rate)) +\n  geom_segment(aes(xend = text_length, yend = predicted), color = \"steelblue\", alpha = 0.5) +\n  geom_point(color = \"grey30\", size = 2) +\n  geom_point(aes(y = predicted), color = \"firebrick\", size = 2, shape = 17) +\n  geom_smooth(data = posts, method = \"lm\", se = FALSE, color = \"firebrick\", linewidth = 0.5) +\n  labs(\n    title = \"Reziduali: razlika izmedu opazenih i predvidjenih vrijednosti\",\n    subtitle = \"Crni krugovi = opazeno. Crveni trokuti = predvidjeno. Plave linije = reziduali.\",\n    x = \"Duljina teksta\",\n    y = \"Engagement rate (%)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/reziduali-prikaz-1.png)\n:::\n:::\n\n\n---\n\n## Pretpostavke linearne regresije {#sec-pretpostavke}\n\nLinearna regresija ima četiri ključne pretpostavke: linearnost (veza između X i Y je linearna), nezavisnost reziduala, homoskedastičnost (jednaka varijanca reziduala za sve vrijednosti X) i normalnost reziduala.\n\n### Dijagnostički grafovi\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(model1)\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/dijagnostika-4-1.png)\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\nČetiri standardna dijagnostička grafa:\n\n**Residuals vs Fitted** (gore lijevo): Provjerava linearnost i homoskedastičnost. Želimo ravnu crvenu liniju oko nule i ravnomjerno raspršene točke. Ako vidimo oblik lijevka ili krivulju, pretpostavka je narušena.\n\n**Normal Q-Q** (gore desno): Provjerava normalnost reziduala. Točke trebaju ležati blizu dijagonale.\n\n**Scale-Location** (dolje lijevo): Provjerava homoskedastičnost. Želimo ravnu liniju i ravnomjerno raspršene točke.\n\n**Residuals vs Leverage** (dolje desno): Identificira utjecajne točke. Opažanja s visokim leverageom i velikim rezidualima (izvan Cookovih udaljenosti) mogu neprimjereno utjecati na model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residuals vs Fitted u ggplot (preglednije)\nposts_pred |>\n  ggplot(aes(x = predicted, y = residual)) +\n  geom_point(alpha = 0.3, color = \"steelblue\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"firebrick\") +\n  labs(\n    title = \"Reziduali vs predvidjene vrijednosti\",\n    subtitle = \"Crvena linija blizu nule = linearnost zadovoljena. Lijevak = heteroskedasticnost.\",\n    x = \"Predvidjene vrijednosti\",\n    y = \"Reziduali\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/dijagnostika-ggplot-1.png)\n:::\n:::\n\n\n---\n\n## Višestruka regresija {#sec-visestruka}\n\nJednostavna regresija s jednim prediktorom rijetko je dovoljna. **Višestruka regresija** uključuje više prediktora:\n\n$$Y = b_0 + b_1 X_1 + b_2 X_2 + ... + b_k X_k + \\varepsilon$$\n\nSvaki koeficijent $b_i$ sada predstavlja **parcijalni efekt**: promjenu Y za jediničnu promjenu $X_i$, **uz kontrolu svih ostalih prediktora** (držeći ih konstantnima).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visestruka regresija: vise prediktora\nmodel2 <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + num_mentions, data = posts)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = engagement_rate ~ text_length + num_hashtags + has_cta + \n    num_mentions, data = posts)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3636 -1.4502 -0.1389  1.4289  6.1080 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   5.3126047  0.3129882  16.974   <2e-16 ***\ntext_length   0.0009983  0.0011825   0.844   0.3991    \nnum_hashtags -0.0964910  0.0106738  -9.040   <2e-16 ***\nhas_cta       0.4833190  0.1967471   2.457   0.0145 *  \nnum_mentions  0.0051079  0.0592290   0.086   0.9313    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.908 on 395 degrees of freedom\nMultiple R-squared:  0.1833,\tAdjusted R-squared:  0.175 \nF-statistic: 22.16 on 4 and 395 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkoef2 <- coef(model2)\nr2_m2 <- summary(model2)$r.squared\nadj_r2_m2 <- summary(model2)$adj.r.squared\n\ncat(\"=== Model 2: Visestruka regresija ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== Model 2: Visestruka regresija ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Jednadžba:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nJednadžba:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"engagement = \", round(koef2[1], 2), \"\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nengagement = 5.31\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (i in 2:length(koef2)) {\n  cat(\"  \", if_else(koef2[i] >= 0, \"+ \", \"- \"), round(abs(koef2[i]), 4), \n      \" * \", names(koef2)[i], \"\\n\", sep = \"\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  + 0.001 * text_length\n  - 0.0965 * num_hashtags\n  + 0.4833 * has_cta\n  + 0.0051 * num_mentions\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nR-kvadrat:            \", round(r2_m2, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nR-kvadrat:             0.183 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Prilagodeni R-kvadrat:\", round(adj_r2_m2, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPrilagodeni R-kvadrat: 0.175 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\", round(r2_m2 * 100, 1), \"% varijabilnosti objasnjeno.\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: 18.3 % varijabilnosti objasnjeno.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija koeficijenata (sve uz kontrolu ostalih prediktora):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija koeficijenata (sve uz kontrolu ostalih prediktora):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  num_hashtags: Svaki dodatni hashtag mijenja engagement za \", \n    round(koef2[\"num_hashtags\"], 3), \" bodova.\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  num_hashtags: Svaki dodatni hashtag mijenja engagement za -0.096 bodova.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  has_cta: Objave s CTA imaju u prosjeku \", round(koef2[\"has_cta\"], 2), \n    \" bodova visi engagement.\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  has_cta: Objave s CTA imaju u prosjeku 0.48 bodova visi engagement.\n```\n\n\n:::\n:::\n\n\n### Usporedba modela\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model 3: dodajmo content_type\nmodel3 <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + \n               num_mentions + content_type, data = posts)\n\n# Model 4: dodajmo jos i topic\nmodel4 <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + \n               num_mentions + content_type + topic, data = posts)\n\n# Usporedba\ntibble(\n  model = c(\"M1: text_length\", \"M2: + hashtags, cta, mentions\", \n            \"M3: + content_type\", \"M4: + topic\"),\n  R2 = round(c(summary(model1)$r.squared, summary(model2)$r.squared,\n               summary(model3)$r.squared, summary(model4)$r.squared), 3),\n  adj_R2 = round(c(summary(model1)$adj.r.squared, summary(model2)$adj.r.squared,\n                    summary(model3)$adj.r.squared, summary(model4)$adj.r.squared), 3),\n  AIC = round(c(AIC(model1), AIC(model2), AIC(model3), AIC(model4)), 1)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  model                            R2 adj_R2   AIC\n  <chr>                         <dbl>  <dbl> <dbl>\n1 M1: text_length               0.002 -0.001 1733.\n2 M2: + hashtags, cta, mentions 0.183  0.175 1659.\n3 M3: + content_type            0.376  0.365 1558.\n4 M4: + topic                   0.406  0.389 1546.\n```\n\n\n:::\n:::\n\n\nSvaki dodani prediktor povećava R-kvadrat. **Prilagodeni R-kvadrat** penalizira dodavanje prediktora koji ne poboljšavaju model dovoljno. **AIC** (Akaike Information Criterion) je još jedna mjera: niži AIC = bolji model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = engagement_rate ~ text_length + num_hashtags + has_cta + \n    num_mentions + content_type + topic, data = posts)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-4.287 -1.338  0.044  1.188  4.681 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            5.414266   0.344605  15.712  < 2e-16 ***\ntext_length            0.001666   0.001026   1.624  0.10525    \nnum_hashtags          -0.092638   0.009218 -10.050  < 2e-16 ***\nhas_cta                0.511429   0.170347   3.002  0.00285 ** \nnum_mentions           0.009737   0.051568   0.189  0.85033    \ncontent_typefoto      -1.186807   0.220401  -5.385 1.26e-07 ***\ncontent_typereel       0.761525   0.233632   3.260  0.00121 ** \ncontent_typetekst     -1.800942   0.271146  -6.642 1.05e-10 ***\ntopiciza_kulisa        0.330852   0.283879   1.165  0.24454    \ntopickorisnik_sadrzaj  0.341487   0.284489   1.200  0.23073    \ntopicproizvod         -0.339511   0.244766  -1.387  0.16621    \ntopiczabava            0.644505   0.241529   2.668  0.00794 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.642 on 388 degrees of freedom\nMultiple R-squared:  0.4061,\tAdjusted R-squared:  0.3892 \nF-statistic: 24.12 on 11 and 388 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vizualizacija koeficijenata modela 4\ntidy_m4 <- broom::tidy(model4, conf.int = TRUE) |>\n  filter(term != \"(Intercept)\") |>\n  mutate(\n    znacajno = p.value < 0.05,\n    term = fct_reorder(term, estimate)\n  )\n\ntidy_m4 |>\n  ggplot(aes(y = term, x = estimate, color = znacajno)) +\n  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.3, linewidth = 0.8) +\n  geom_point(size = 3) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  scale_color_manual(values = c(\"TRUE\" = \"#2a9d8f\", \"FALSE\" = \"#e76f51\"),\n                     labels = c(\"TRUE\" = \"p < .05\", \"FALSE\" = \"p >= .05\")) +\n  labs(\n    title = \"Koeficijenti visestruke regresije (Model 4)\",\n    subtitle = \"Tocka = procjena, pojas = 95% CI. Zeleno = znacajno.\",\n    x = \"Procjena koeficijenta (promjena u engagement rate)\",\n    y = NULL, color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/koeficijenti-vizualizacija-1.png)\n:::\n:::\n\n\n---\n\n## R-kvadrat i prilagodeni R-kvadrat {#sec-r-kvadrat}\n\n**R-kvadrat** (R²) je proporcija varijabilnosti Y-a objašnjena modelom:\n\n$$R^2 = 1 - \\frac{SS_{residual}}{SS_{total}} = \\frac{SS_{model}}{SS_{total}}$$\n\nProblem: R² uvijek raste (ili ostaje isti) kad dodamo prediktor, čak i ako je beskoristan. **Prilagodeni R²** penalizira dodavanje nepotrebnih prediktora:\n\n$$R^2_{adj} = 1 - \\frac{(1 - R^2)(n - 1)}{n - k - 1}$$\n\ngdje je n broj opažanja, a k broj prediktora.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Demonstracija: dodavanje random prediktora\nset.seed(42)\nposts_demo <- posts |>\n  mutate(random1 = rnorm(n()), random2 = rnorm(n()), random3 = rnorm(n()))\n\nmodel_base <- lm(engagement_rate ~ num_hashtags + has_cta + content_type, data = posts_demo)\nmodel_rand <- lm(engagement_rate ~ num_hashtags + has_cta + content_type + \n                   random1 + random2 + random3, data = posts_demo)\n\ncat(\"Model bez random prediktora:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel bez random prediktora:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  R2 =\", round(summary(model_base)$r.squared, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  R2 = 0.3721 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Adj R2 =\", round(summary(model_base)$adj.r.squared, 4), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Adj R2 = 0.3641 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Model S random prediktorima:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel S random prediktorima:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  R2 =\", round(summary(model_rand)$r.squared, 4), \"(veci! ali lazno)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  R2 = 0.3807 (veci! ali lazno)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Adj R2 =\", round(summary(model_rand)$adj.r.squared, 4), \"(korigira za lazno poboljsanje)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Adj R2 = 0.368 (korigira za lazno poboljsanje)\n```\n\n\n:::\n:::\n\n\n::: {.callout-important}\n## Važna napomena o R-kvadratu\n\nR² nije \"ocjena\" modela. R² = 0.20 može biti odličan za predvidjanje ljudskog ponašanja (koje je inherentno varijabilno) a R² = 0.90 može biti loš za fizikalni zakon. Kontekst je ključan. U komunikološkim istraživanjima, R² između 0.10 i 0.30 je uobičajen i prihvatljiv.\n:::\n\n---\n\n\n::: {.callout-note}\n## Podsjetnik\n\nU prvom dijelu naučili smo jednostavnu i višestruku linearnu regresiju, interpretaciju koeficijenata, R-kvadrat, dijagnostičke grafove i usporedbu modela. U ovom dijelu pokrivamo naprednu dijagnostiku, standardizirane koeficijente i potpunu analizu.\n:::\n\n## Multikolinearnost i VIF {#sec-vif}\n\n**Multikolinearnost** nastaje kad su prediktori međusobno jako korelirani. Kad je to slučaj, model teško razdvaja njihove individualne efekte, koeficijenti postaju nestabilni i standardne greške narastu.\n\n**VIF** (Variance Inflation Factor) mjeri koliko je varijanca koeficijenta povećana zbog korelacije s drugim prediktorima.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposts <- read_csv(\"../resources/datasets/social_engagement.csv\")\n\nmodel4 <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + \n               num_mentions + content_type + topic, data = posts)\n\n# VIF za svaki prediktor (rucno za numericke)\nmodel_num <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + num_mentions, data = posts)\n\n# VIF = 1 / (1 - R2_j), gdje je R2_j R-kvadrat kad regresiramo Xj na sve ostale prediktore\nvif_manual <- function(data, prediktori, target_pred) {\n  formula_vif <- as.formula(paste(target_pred, \"~\", paste(setdiff(prediktori, target_pred), collapse = \" + \")))\n  r2_j <- summary(lm(formula_vif, data = data))$r.squared\n  1 / (1 - r2_j)\n}\n\nnum_preds <- c(\"text_length\", \"num_hashtags\", \"has_cta\", \"num_mentions\")\n\nvif_vals <- map_dbl(num_preds, ~vif_manual(posts, num_preds, .x))\ntibble(prediktor = num_preds, VIF = round(vif_vals, 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  prediktor      VIF\n  <chr>        <dbl>\n1 text_length   1.01\n2 num_hashtags  1   \n3 has_cta       1.01\n4 num_mentions  1.01\n```\n\n\n:::\n:::\n\n\nPravilo palca: VIF < 5 je prihvatljiv. VIF > 10 ukazuje na ozbiljnu multikolinearnost. Naši prediktori imaju niske VIF-ove, što znači da su relativno nezavisni jedni od drugih.\n\n::: {.callout-warning}\n## Što učiniti kad je VIF visok?\n\nOpcije su: ukloniti jedan od koreliranih prediktora, kombinirati korelirane prediktore u jednu mjeru (npr. prosjek ili faktor), koristiti regulariziranu regresiju (ridge, lasso), ili prihvatiti šire CI i opreznije interpretirati.\n:::\n\n---\n\n## Nelinearni odnosi {#sec-nelinearnost}\n\nLinearna regresija pretpostavlja linearne odnose. Ali stvarni odnosi često nisu linearni. Na primjer, broj hashtagova i angažman: previše hashtagova može biti jednako loše kao premalo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatterplot s LOESS krivuljom umjesto ravnog pravca\nposts |>\n  ggplot(aes(x = num_hashtags, y = engagement_rate)) +\n  geom_point(alpha = 0.2, color = \"grey50\") +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"steelblue\", linetype = \"dashed\") +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"firebrick\") +\n  labs(\n    title = \"Linearni vs nelinearni odnos: hashtagovi i angažman\",\n    subtitle = \"Plava = linearni model. Crvena = LOESS (fleksibilni). Oblik obrnuto U sugerira nelinearnost.\",\n    x = \"Broj hashtagova\",\n    y = \"Engagement rate (%)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/nelinearnost-provjera-1.png)\n:::\n:::\n\n\nLOESS krivulja sugerira obrnuto U: angažman je najveći oko 8-12 hashtagova i opada s previše ili premalo. Linearni model ovo ne može uhvatiti.\n\n### Polinomijalna regresija\n\nMožemo dodati kvadratni član da uhvatimo zakrivljenost:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model s kvadratnim clanom za hashtagove\nmodel_poly <- lm(engagement_rate ~ num_hashtags + I(num_hashtags^2) + \n                   has_cta + content_type + topic, data = posts)\n\n# Usporedba: linearni vs polinomijalni\nmodel_lin <- lm(engagement_rate ~ num_hashtags + has_cta + content_type + topic, data = posts)\n\ncat(\"Linearni model:      Adj R² =\", round(summary(model_lin)$adj.r.squared, 3), \n    \", AIC =\", round(AIC(model_lin), 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinearni model:      Adj R² = 0.388 , AIC = 1544.4 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Polinomijalni model: Adj R² =\", round(summary(model_poly)$adj.r.squared, 3), \n    \", AIC =\", round(AIC(model_poly), 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPolinomijalni model: Adj R² = 0.494 , AIC = 1469.7 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koeficijenti za hashtag efekt\nkoef_poly <- coef(model_poly)\ncat(\"num_hashtags:    \", round(koef_poly[\"num_hashtags\"], 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnum_hashtags:     0.2033 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"num_hashtags^2:  \", round(koef_poly[\"I(num_hashtags^2)\"], 5), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnum_hashtags^2:   -0.00977 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Optimalni broj hashtagova (vrh parabole)\noptimal_h <- -koef_poly[\"num_hashtags\"] / (2 * koef_poly[\"I(num_hashtags^2)\"])\ncat(\"Optimalni broj hashtagova:\", round(optimal_h), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOptimalni broj hashtagova: 10 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predvidjene vrijednosti za razlicite brojeve hashtagova\nhashtag_pred <- tibble(\n  num_hashtags = 0:30,\n  has_cta = 0,\n  content_type = \"carousel\",\n  topic = \"zabava\"\n) |>\n  mutate(\n    pred_lin = predict(model_lin, newdata = pick(everything())),\n    pred_poly = predict(model_poly, newdata = pick(everything()))\n  )\n\nhashtag_pred |>\n  pivot_longer(c(pred_lin, pred_poly), names_to = \"model\", values_to = \"predicted\") |>\n  mutate(model = if_else(model == \"pred_lin\", \"Linearni\", \"Polinomijalni\")) |>\n  ggplot(aes(x = num_hashtags, y = predicted, color = model)) +\n  geom_line(linewidth = 1.2) +\n  geom_vline(xintercept = round(optimal_h), linetype = \"dashed\", color = \"grey50\") +\n  annotate(\"text\", x = round(optimal_h) + 0.5, y = max(hashtag_pred$pred_poly) - 0.2,\n           label = paste0(\"Optimum: ~\", round(optimal_h), \" hashtagova\"), hjust = 0) +\n  scale_color_manual(values = c(\"Linearni\" = \"steelblue\", \"Polinomijalni\" = \"firebrick\")) +\n  labs(\n    title = \"Predvidjeni engagement po broju hashtagova\",\n    subtitle = \"Polinomijalni model hvata obrnuto-U oblik: optimum oko 10 hashtagova\",\n    x = \"Broj hashtagova\",\n    y = \"Predvidjeni engagement rate (%)\",\n    color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/poly-vizualizacija-1.png)\n:::\n:::\n\n\n---\n\n## Standardizirani koeficijenti {#sec-standardizirani}\n\nNestandardizirani koeficijenti su u originalnim jedinicama (postotni bodovi angažmana po dodatnom hashtagu). Problem: ne možemo direktno usporediti koeficijente različitih prediktora jer su na različitim skalama.\n\n**Standardizirani koeficijenti** (beta koeficijenti) izražavaju promjenu Y u SD jedinicama za promjenu od 1 SD u X. Ovo omogućuje usporedbu relativne važnosti prediktora.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardizacija numerickih prediktora\nposts_std <- posts |>\n  mutate(across(c(text_length, num_hashtags, num_mentions), scale))\n\nmodel_std <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + \n                  num_mentions + content_type + topic, data = posts_std)\n\n# Usporedba nestandardiziranih i standardiziranih koeficijenata\nbroom::tidy(model4) |>\n  filter(term != \"(Intercept)\") |>\n  select(term, b = estimate) |>\n  left_join(\n    broom::tidy(model_std) |>\n      filter(term != \"(Intercept)\") |>\n      select(term, beta = estimate),\n    by = \"term\"\n  ) |>\n  mutate(across(c(b, beta), \\(x) round(x, 3))) |>\n  arrange(desc(abs(beta)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 11 × 3\n   term                       b   beta\n   <chr>                  <dbl>  <dbl>\n 1 content_typetekst     -1.80  -1.80 \n 2 content_typefoto      -1.19  -1.19 \n 3 num_hashtags          -0.093 -0.83 \n 4 content_typereel       0.762  0.762\n 5 topiczabava            0.645  0.645\n 6 has_cta                0.511  0.511\n 7 topickorisnik_sadrzaj  0.341  0.341\n 8 topicproizvod         -0.34  -0.34 \n 9 topiciza_kulisa        0.331  0.331\n10 text_length            0.002  0.135\n11 num_mentions           0.01   0.016\n```\n\n\n:::\n:::\n\n\nStandardizirani koeficijenti (beta) omogućuju usporedbu: koji prediktor ima najveći efekt na angažman? Rangiranje po apsolutnoj vrijednosti beta otkriva koje varijable su najvažnije.\n\n---\n\n## Utjecajne točke: Cookova udaljenost {#sec-cook}\n\nNeka opažanja mogu neprimjereno utjecati na regresijski pravac. **Cookova udaljenost** mjeri koliko bi se model promijenio kad bismo uklonili to opažanje.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposts_diag <- posts |>\n  mutate(\n    cook = cooks.distance(model4),\n    leverage = hatvalues(model4),\n    std_residual = rstandard(model4)\n  )\n\n# Cookova udaljenost\nposts_diag |>\n  mutate(post_id = row_number()) |>\n  ggplot(aes(x = post_id, y = cook)) +\n  geom_col(fill = \"steelblue\", alpha = 0.5) +\n  geom_hline(yintercept = 4 / nrow(posts), linetype = \"dashed\", color = \"firebrick\") +\n  annotate(\"text\", x = nrow(posts) - 30, y = 4/nrow(posts) + 0.002, \n           label = \"Prag: 4/n\", color = \"firebrick\") +\n  labs(\n    title = \"Cookova udaljenost za svako opažanje\",\n    subtitle = \"Opazanja iznad praga mogu neprimjereno utjecati na model\",\n    x = \"Opažanje\",\n    y = \"Cookova udaljenost\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/cook-1.png)\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koje objave su najutjecajnije?\nprag_cook <- 4 / nrow(posts)\nutjecajne <- posts_diag |> filter(cook > prag_cook) |> nrow()\n\ncat(\"Prag Cook's distance:\", round(prag_cook, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPrag Cook's distance: 0.01 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Broj utjecajnih tocaka:\", utjecajne, \"od\", nrow(posts), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBroj utjecajnih tocaka: 19 od 400 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Usporedba modela s i bez utjecajnih tocaka\nposts_clean <- posts_diag |> filter(cook <= prag_cook)\nmodel4_clean <- lm(engagement_rate ~ text_length + num_hashtags + has_cta + \n                     num_mentions + content_type + topic, data = posts_clean)\n\ncat(\"\\nS utjecajnim tockama:   Adj R² =\", round(summary(model4)$adj.r.squared, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nS utjecajnim tockama:   Adj R² = 0.389 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Bez utjecajnih tocaka:  Adj R² =\", round(summary(model4_clean)$adj.r.squared, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBez utjecajnih tocaka:  Adj R² = 0.466 \n```\n\n\n:::\n:::\n\n\n---\n\n## Potpuna analiza: izvještaj za menadžericu {#sec-analiza}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Finalni model s polinomom za hashtagove\nmodel_final <- lm(engagement_rate ~ text_length + num_hashtags + I(num_hashtags^2) + \n                    has_cta + content_type + topic, data = posts)\nsummary(model_final)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = engagement_rate ~ text_length + num_hashtags + I(num_hashtags^2) + \n    has_cta + content_type + topic, data = posts)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9183 -1.0226  0.0508  0.9011  3.9764 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            3.9765594  0.3404994  11.679  < 2e-16 ***\ntext_length            0.0009147  0.0009352   0.978 0.328663    \nnum_hashtags           0.2002828  0.0338197   5.922 7.01e-09 ***\nI(num_hashtags^2)     -0.0096729  0.0010821  -8.939  < 2e-16 ***\nhas_cta                0.5436919  0.1545645   3.518 0.000487 ***\ncontent_typefoto      -1.0559718  0.2008621  -5.257 2.42e-07 ***\ncontent_typereel       0.8676736  0.2123747   4.086 5.34e-05 ***\ncontent_typetekst     -1.7379822  0.2465704  -7.049 8.31e-12 ***\ntopiciza_kulisa        0.3120734  0.2580244   1.209 0.227218    \ntopickorisnik_sadrzaj  0.5538109  0.2599251   2.131 0.033746 *  \ntopicproizvod         -0.2953335  0.2227455  -1.326 0.185660    \ntopiczabava            0.6838707  0.2196727   3.113 0.001988 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.495 on 388 degrees of freedom\nMultiple R-squared:  0.5075,\tAdjusted R-squared:  0.4935 \nF-statistic: 36.34 on 11 and 388 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residuals vs Fitted za finalni model\ntibble(fitted = fitted(model_final), resid = residuals(model_final)) |>\n  ggplot(aes(x = fitted, y = resid)) +\n  geom_point(alpha = 0.3, color = \"steelblue\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"firebrick\") +\n  labs(title = \"Dijagnostika finalnog modela: Reziduali vs Predvidjeno\",\n       x = \"Predvidjene vrijednosti\", y = \"Reziduali\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/finalni-dijagnostika-1.png)\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predvidjeni engagement po content_type (kontrolirajuci ostale)\npred_content <- expand_grid(\n  text_length = mean(posts$text_length),\n  num_hashtags = 10,\n  has_cta = c(0, 1),\n  content_type = unique(posts$content_type),\n  topic = \"zabava\"\n) |>\n  mutate(predicted = predict(model_final, newdata = pick(everything())),\n         has_cta_label = if_else(has_cta == 1, \"S CTA\", \"Bez CTA\"))\n\npred_content |>\n  ggplot(aes(x = fct_reorder(content_type, predicted), y = predicted, fill = has_cta_label)) +\n  geom_col(position = \"dodge\", alpha = 0.85) +\n  scale_fill_manual(values = c(\"S CTA\" = \"#2a9d8f\", \"Bez CTA\" = \"#e76f51\")) +\n  labs(\n    title = \"Predvidjeni engagement po tipu sadržaja i CTA\",\n    subtitle = \"Kontrolirano za text_length, hashtagove i temu\",\n    x = NULL,\n    y = \"Predvidjeni engagement rate (%)\",\n    fill = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-14_files/figure-docx/analiza-content-type-1.png)\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr2_final <- summary(model_final)$adj.r.squared\nf_final <- summary(model_final)$fstatistic\n\ncat(\"================================================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   IZVJESTAJ: PREDIKTORI ANGAŽMANA INSTAGRAM OBJAVA\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   IZVJESTAJ: PREDIKTORI ANGAŽMANA INSTAGRAM OBJAVA\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"================================================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"UZORAK: \", nrow(posts), \" objava s Instagram poslovnog profila.\\n\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nUZORAK: 400 objava s Instagram poslovnog profila.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"MODEL: Visestruka regresija s polinomom za hashtagove.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMODEL: Visestruka regresija s polinomom za hashtagove.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  F(\", f_final[2], \", \", f_final[3], \") = \", round(f_final[1], 1), \n    \", p < .001\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  F(11, 388) = 36.3, p < .001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Prilagodeni R² = \", round(r2_final, 3), \n    \" (\", round(r2_final * 100, 1), \"% varijabilnosti objasnjeno)\\n\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Prilagodeni R² = 0.493 (49.3% varijabilnosti objasnjeno)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"KLJUCNI PREDIKTORI (po snazi efekta):\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKLJUCNI PREDIKTORI (po snazi efekta):\n```\n\n\n:::\n\n```{.r .cell-code}\n# Najvazniji znacajni koeficijenti\ntidy_final <- broom::tidy(model_final) |>\n  filter(term != \"(Intercept)\", p.value < 0.05) |>\n  arrange(desc(abs(estimate)))\n\nfor (i in 1:min(8, nrow(tidy_final))) {\n  r <- tidy_final[i, ]\n  cat(\"  \", r$term, \": b = \", round(r$estimate, 3), \n      \", p \", if_else(r$p.value < 0.001, \"< .001\", paste0(\"= \", round(r$p.value, 3))), \"\\n\", sep = \"\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  content_typetekst: b = -1.738, p < .001\n  content_typefoto: b = -1.056, p < .001\n  content_typereel: b = 0.868, p < .001\n  topiczabava: b = 0.684, p = 0.002\n  topickorisnik_sadrzaj: b = 0.554, p = 0.034\n  has_cta: b = 0.544, p < .001\n  num_hashtags: b = 0.2, p < .001\n  I(num_hashtags^2): b = -0.01, p < .001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nPRAKTICNE PREPORUKE:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nPRAKTICNE PREPORUKE:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  1. Preferirajte reelove i carousele (najvisi engagement).\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1. Preferirajte reelove i carousele (najvisi engagement).\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  2. Koristite oko 10 hashtagova (optimum obrnuto-U krivulje).\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  2. Koristite oko 10 hashtagova (optimum obrnuto-U krivulje).\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  3. Uvijek ukljucite CTA (poziv na akciju).\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  3. Uvijek ukljucite CTA (poziv na akciju).\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  4. Tema korisnickog sadrzaja i zabave generira najvisi angažman.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  4. Tema korisnickog sadrzaja i zabave generira najvisi angažman.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  5. Duljina teksta ima minimalan efekt; fokusirajte se na sadrzaj.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  5. Duljina teksta ima minimalan efekt; fokusirajte se na sadrzaj.\n```\n\n\n:::\n:::\n\n\n---\n\n## Ograničenja regresije {#sec-ogranicenja}\n\nLinearna regresija je moćan alat ali ima jasna ograničenja.\n\n**Korelacija nije kauzalnost.** Regresija otkriva asocijacije, ne uzročno-posljedične veze. Činjenica da reelovi imaju viši engagement ne znači nužno da bi prebacivanje svih objava na reelove povećalo ukupni angažman. Možda su reelovi novi pa dobivaju algoritamski boost, ili ih koriste samo za određene teme.\n\n**Model je dobar koliko i podaci.** Regresija ne može uhvatiti prediktore koje nismo mjerili (kvaliteta fotografije, trending tema, algoritamske promjene). To je razlog zašto R² nikad neće biti 1.\n\n**Ekstrapolacija je opasna.** Model je treniran na podacima s 0-30 hashtagova. Predvidjanje za 50 hashtagova bi bilo ekstrapolacija izvan raspona podataka i nepouzdano.\n\n**Pretpostavke moraju biti zadovoljene.** Ako dijagnostički grafovi pokazuju ozbiljna odstupanja (nelinearnost, heteroskedastičnost, nenormalne reziduale), rezultati mogu biti nepouzdani. Transformacije ili alternativni modeli mogu pomoći.\n\n---\n\n::: {.callout-important}\n## Ključni zaključci\n\n1. Linearna regresija modelira vezu između prediktora (X) i ishoda (Y). Jednostavna: Y = b0 + b1X. Višestruka: Y = b0 + b1X1 + b2X2 + ...\n\n2. `lm(y ~ x1 + x2, data)` provodi regresiju. `summary()` daje koeficijente, SE, t, p, R² i F-test.\n\n3. Svaki koeficijent u višestrukoj regresiji je parcijalni efekt: promjena Y za jediničnu promjenu X uz kontrolu svih ostalih prediktora.\n\n4. R-kvadrat je proporcija varijabilnosti objašnjena modelom. Prilagodeni R² korigira za broj prediktora. U društvenim znanostima, R² = 0.10 do 0.30 je uobičajen.\n\n5. AIC omogućuje usporedbu modela: niži AIC = bolji model. Penalizira dodavanje nepotrebnih prediktora.\n\n6. Pretpostavke: linearnost, nezavisnost, homoskedastičnost, normalnost reziduala. Dijagnostički grafovi (`plot(model)`) ih provjeravaju.\n\n7. VIF mjeri multikolinearnost. VIF < 5 je prihvatljiv. VIF > 10 je problematičan. Visok VIF znači da su prediktori previsoko korelirani.\n\n8. Nelinearne odnose možemo uhvatiti polinomom: `I(x^2)` dodaje kvadratni član. LOESS krivulja otkriva nelinearnost vizualno.\n\n9. Standardizirani koeficijenti (beta) omogućuju usporedbu relativne važnosti prediktora na istoj skali (SD jedinice).\n\n10. Cookova udaljenost identificira utjecajne točke. Prag: 4/n. Provedite analizu s i bez utjecajnih točaka za provjeru stabilnosti.\n\n11. Regresija otkriva asocijacije, ne kauzalnost. Ekstrapolacija izvan raspona podataka je nepouzdana. Model je dobar koliko i podaci.\n\n12. Kompletni izvještaj: opis uzorka i modela, F-test i R², značajni koeficijenti s interpretacijom, dijagnostika pretpostavki, vizualizacija efekata i praktične preporuke.\n:::\n\n---\n\n## Zadaci za pripremu\n\n1. Učitajte `social_engagement.csv`. Provedite jednostavnu regresiju `engagement_rate ~ num_hashtags`. Interpretirajte koeficijent i R². Pogledajte dijagnostičke grafove. Dodajte kvadratni član `I(num_hashtags^2)` i usporedite modele.\n\n2. Izradite višestruki model s barem 4 prediktora. Izračunajte VIF za numeričke prediktore. Napišite rezultate u APA formatu.\n\n3. Kreirajte graf koji prikazuje predvidjeni engagement za svaku kombinaciju content_type i topic (pri prosječnim vrijednostima ostalih prediktora). Koja kombinacija je najuspješnija?\n\n---\n\n## Dodatno čitanje\n\n**Obavezno**\n\nNavarro, D. (2018). *Learning Statistics with R*, Chapter 15 (Linear Regression). Besplatno dostupno na [learningstatisticswithr.com](https://learningstatisticswithr.com/lsr-0.6.pdf). Pokriva jednostavnu i višestruku regresiju s R kodom.\n\n**Preporučeno**\n\nJames, G., Witten, D., Hastie, T., & Tibshirani, R. (2021). *An Introduction to Statistical Learning* (2nd edition). Springer. Poglavlje 3. Besplatno na [statlearning.com](https://www.statlearning.com). Moderniji pristup regresijskom modeliranju.\n\nFox, J. & Weisberg, S. (2019). *An R Companion to Applied Regression* (3rd edition). SAGE. Referentni priručnik za regresijsku dijagnostiku u R-u.\n\n---\n\n## Pojmovnik\n\n| Pojam | Objašnjenje |\n|---|---|\n| Linearna regresija | Modeliranje linearne veze između prediktora (X) i ishoda (Y). Y = b0 + b1X + e. |\n| Jednostavna regresija | Regresija s jednim prediktorom. |\n| Višestruka regresija | Regresija s dva ili više prediktora. Koeficijenti su parcijalni efekti. |\n| Koeficijent (b, slope) | Promjena Y za jediničnu promjenu X, uz kontrolu ostalih prediktora. |\n| Intercept (b0) | Predvidjeni Y kad su svi prediktori jednaki nuli. Često bez praktičnog značenja. |\n| Parcijalni efekt | Efekt jednog prediktora uz kontrolu (držanje konstantnima) svih ostalih. |\n| Rezidual (e) | Razlika između opaženog i predvidjenog Y. e = Y minus Y_hat. |\n| R-kvadrat (R²) | Proporcija varijabilnosti Y-a objašnjena modelom. 0 = model ne objašnjava ništa. 1 = savršeno. |\n| Prilagodeni R² | R² korigiran za broj prediktora. Koristi se za usporedbu modela s razlicitim brojem prediktora. |\n| AIC | Akaike Information Criterion. Niži = bolji model. Penalizira kompleksnost. |\n| OLS | Ordinary Least Squares. Metoda koja minimizira sumu kvadriranih reziduala. |\n| Dummy varijabla | Binarna (0/1) varijabla za kodiranje kategorija. R ih automatski kreira u `lm()`. |\n| VIF | Variance Inflation Factor. Mjeri multikolinearnost. VIF < 5 prihvatljivo, > 10 problematicno. |\n| Multikolinearnost | Visoka korelacija između prediktora. Čini koeficijente nestabilnima. |\n| Cookova udaljenost | Mjera utjecaja pojedinog opažanja na model. Prag: 4/n. |\n| Leverage | Koliko je opažanje ekstremno u prostoru prediktora. Visok leverage = potencijalno utjecajno. |\n| Standardizirani koeficijent (beta) | Koeficijent izražen u SD jedinicama. Omogućuje usporedbu prediktora. |\n| Polinomijalna regresija | Dodavanje kvadratnog (ili višeg) člana za uhvatiti nelinearne odnose. `I(x^2)`. |\n| Homoskedastičnost | Jednaka varijanca reziduala za sve predvidjene vrijednosti. Pretpostavka regresije. |\n| Ekstrapolacija | Predvidjanje izvan raspona podataka. Nepouzdano jer model nije treniran za te vrijednosti. |\n| `lm()` | R funkcija za linearnu regresiju. `lm(y ~ x1 + x2, data = ...)`. |\n| `summary()` | Na `lm()` objektu daje koeficijente, SE, t, p, R² i F-test. |\n| `predict()` | Generira predvidjene vrijednosti. `predict(model, newdata = ...)` za nova opažanja. |\n| `residuals()` | Izvlači reziduale iz modela. |\n| `broom::tidy()` | Pretvara model output u tibble s koeficijentima, SE, t, p i CI. |\n| `AIC()` | R funkcija za izračun AIC-a. `AIC(model1, model2)` za usporedbu. |\n",
    "supporting": [
      "week-14_files\\figure-docx"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}