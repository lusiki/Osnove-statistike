{
  "hash": "cf74c57ddf520b0e9531b6f7b8bc1dec",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tjedan 13: Usporedba više grupa ANOVA-om\"\nsubtitle: \"Kad t-test nije dovoljan\"\ndate: 2025-05-17\ncategories: [ANOVA, F-test, post-hoc, Tukey, eta-kvadrat, Kruskal-Wallis]\ndraft: false\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n::: {.callout-note}\n## Ishodi učenja\n\nNakon ovog predavanja moći ćete\n\n1. Objasniti zašto višestruki t-testovi nisu primjereni za usporedbu više od dviju grupa.\n2. Provesti i interpretirati jednosmjernu ANOVA-u u R-u.\n3. Objasniti logiku F-statistike kao omjera varijabilnosti između i unutar grupa.\n4. Provjeriti pretpostavke ANOVA-e (normalnost, homogenost varijance).\n5. Primijeniti post-hoc testove (Tukey HSD) za identifikaciju specifičnih razlika.\n6. Izračunati eta-kvadrat kao mjeru veličine učinka za ANOVA-u.\n7. Primijeniti Kruskal-Wallisov test kao neparametrijsku alternativu.\n8. Provesti kompletnu analizu s izvještajem.\n:::\n\n## Motivacija: vjerodostojnost vijesti po izvoru\n\nIstraživačko pitanje: percipiraju li ljudi istu vijest kao više ili manje vjerodostojnu ovisno o tome iz kojeg izvora dolazi? Konkretno: razlikuje li se percipirana vjerodostojnost vijesti ovisno o tome pripisuje li se izvoru TV, web portal, društvena mreža, tisak ili podcast?\n\nImamo pet grupa. Prošli tjedan naučili smo t-test za usporedbu dviju grupa. Zašto ne bismo jednostavno proveli t-test za svaki par?\n\n### Problem višestrukih t-testova\n\nS pet grupa imamo 10 mogućih parova (5 choose 2 = 10). Ako svaki test provodimo na razini alfa = 0.05, vjerojatnost barem jednog lažno pozitivnog rezultata je:\n\n$$P(\\text{barem 1 greska}) = 1 - (1 - 0.05)^{10} = 1 - 0.95^{10} \\approx 0.40$$\n\nS 10 testova, šansa za barem jedan lažno pozitivni rezultat je oko 40%. To je potpuno neprihvatljivo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Inflacija greske tipa I s brojem testova\nn_grupa <- 2:10\nn_parova <- choose(n_grupa, 2)\nalpha_inflated <- 1 - (1 - 0.05)^n_parova\n\ntibble(grupe = n_grupa, parovi = n_parova, alpha = alpha_inflated) |>\n  ggplot(aes(x = grupe, y = alpha)) +\n  geom_line(linewidth = 1.2, color = \"firebrick\") +\n  geom_point(size = 3, color = \"firebrick\") +\n  geom_hline(yintercept = 0.05, linetype = \"dashed\", color = \"grey50\") +\n  annotate(\"text\", x = 9.5, y = 0.07, label = \"alfa = 0.05\", color = \"grey50\") +\n  scale_y_continuous(labels = scales::label_percent(), limits = c(0, 1)) +\n  labs(\n    title = \"Inflacija greske tipa I s brojem grupa\",\n    subtitle = \"S 5 grupa (10 parova) sansa za lazno pozitivni rezultat je ~40%\",\n    x = \"Broj grupa\",\n    y = \"Vjerojatnost barem jedne greske tipa I\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/inflacija-alfa-1.png){width=768}\n:::\n:::\n\n\nANOVA rješava ovaj problem: testira sve grupe odjednom jednim testom, održavajući alfa na 0.05.\n\n---\n\n## Naši podaci {#sec-podaci}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncred <- read_csv(\"../resources/datasets/news_credibility.csv\")\nglimpse(cred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 300\nColumns: 10\n$ participant_id <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, …\n$ news_source    <chr> \"TV\", \"TV\", \"TV\", \"TV\", \"TV\", \"TV\", \"TV\", \"TV\", \"TV\", \"…\n$ age_group      <chr> \"30-44\", \"18-29\", \"45-59\", \"45-59\", \"45-59\", \"18-29\", \"…\n$ education      <chr> \"visa\", \"srednja\", \"visoka\", \"srednja\", \"srednja\", \"sre…\n$ topic          <chr> \"zdravlje\", \"zdravlje\", \"tehnologija\", \"politika\", \"zdr…\n$ media_literacy <chr> \"visoka\", \"niska\", \"srednja\", \"srednja\", \"srednja\", \"vi…\n$ credibility    <dbl> 4.2, 5.4, 4.2, 3.3, 5.8, 4.4, 3.8, 4.1, 5.6, 5.7, 5.4, …\n$ trust_general  <dbl> 3.5, 3.8, 4.5, 3.6, 6.3, 4.3, 3.4, 3.6, 7.0, 4.7, 6.1, …\n$ share_intent   <dbl> 2, 3, 2, 2, 2, 2, 3, 2, 2, 5, 2, 2, 3, 2, 3, 3, 3, 1, 3…\n$ reading_time   <dbl> 3.9, 4.5, 4.1, 1.9, 4.9, 4.6, 1.7, 2.8, 5.0, 3.6, 3.7, …\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncred |>\n  group_by(news_source) |>\n  summarise(\n    n = n(),\n    M = round(mean(credibility), 2),\n    SD = round(sd(credibility), 2),\n    Min = min(credibility),\n    Max = max(credibility),\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(M))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 6\n  news_source         n     M    SD   Min   Max\n  <chr>           <int> <dbl> <dbl> <dbl> <dbl>\n1 TV                 65  5.23  0.98   3.3   7  \n2 tisak              55  5.06  1.12   2.7   7  \n3 web_portal         65  4.29  1.05   1.6   7  \n4 podcast            55  4.12  1.17   1     6.6\n5 drustvena_mreza    60  3.49  1.27   1     6.1\n```\n\n\n:::\n:::\n\n\nTV i tisak imaju najvišu percipiranu vjerodostojnost (M > 5), društvena mreža najnižu (M < 3.5). Razlike su očite, ali jesu li statistički značajne kad uzmemo u obzir varijabilnost unutar svake grupe?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncred |>\n  mutate(news_source = fct_reorder(news_source, credibility)) |>\n  ggplot(aes(x = news_source, y = credibility, fill = news_source)) +\n  geom_boxplot(alpha = 0.7, outlier.shape = NA) +\n  geom_jitter(width = 0.2, alpha = 0.2, size = 1.5) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Percipirana vjerodostojnost vijesti po izvoru\",\n    subtitle = \"TV i tisak najvise, drustvena mreza najnize\",\n    x = NULL,\n    y = \"Vjerodostojnost (1-7)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/vizualizacija-osnovna-1.png){width=864}\n:::\n:::\n\n\n---\n\n## Logika ANOVA-e {#sec-logika}\n\nANOVA (Analysis of Variance) uspoređuje varijabilnost IZMEĐU grupa s varijabilnošću UNUTAR grupa.\n\nIntuicija je sljedeća. Ako se grupe stvarno razlikuju, prosjeci grupa bit će razbacani daleko jedni od drugih (velika varijabilnost između grupa). Istovremeno, unutar svake grupe postoji prirodna varijabilnost pojedinaca. Ako je varijabilnost između grupa puno veća od varijabilnosti unutar grupa, onda su razlike između grupa \"stvarne\" (nije samo šum).\n\n$$F = \\frac{\\text{varijabilnost IZMEĐU grupa}}{\\text{varijabilnost UNUTAR grupa}} = \\frac{MS_{between}}{MS_{within}}$$\n\nAko F je blizu 1, varijabilnost između grupa je podjednaka onoj unutar grupa (nema učinka). Ako je F puno veći od 1, grupe se značajno razlikuju.\n\n### Dekompozicija varijance: SS\n\nUkupnu varijabilnost podataka rastavimo na dva dijela:\n\n$$SS_{total} = SS_{between} + SS_{within}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rucni izracun dekompozicije varijance\ngrand_mean <- mean(cred$credibility)\n\n# SS_total: ukupno odstupanje svakog opazanja od grand mean\nss_total <- sum((cred$credibility - grand_mean)^2)\n\n# SS_between: odstupanje grupnih prosjeka od grand mean (ponderano s n)\ngroup_stats <- cred |>\n  group_by(news_source) |>\n  summarise(n = n(), M = mean(credibility), .groups = \"drop\")\n\nss_between <- sum(group_stats$n * (group_stats$M - grand_mean)^2)\n\n# SS_within: odstupanje opazanja od njihovog grupnog prosjeka\nss_within <- cred |>\n  left_join(group_stats |> select(news_source, M), by = \"news_source\") |>\n  summarise(ss = sum((credibility - M)^2)) |>\n  pull(ss)\n\ncat(\"SS_total:  \", round(ss_total, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSS_total:   492 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SS_between:\", round(ss_between, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSS_between: 122.8 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SS_within: \", round(ss_within, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSS_within:  369.2 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Provjera:  \", round(ss_between + ss_within, 1), \" (treba biti = SS_total)\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProvjera:   492  (treba biti = SS_total)\n```\n\n\n:::\n\n```{.r .cell-code}\n# Stupnjevi slobode\nk <- nrow(group_stats)   # broj grupa\nN <- nrow(cred)           # ukupno opazanja\ndf_between <- k - 1\ndf_within <- N - k\n\n# Mean Squares\nms_between <- ss_between / df_between\nms_within <- ss_within / df_within\n\n# F statistika\nf_stat <- ms_between / ms_within\np_val <- pf(f_stat, df_between, df_within, lower.tail = FALSE)\n\ncat(\"df_between:\", df_between, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndf_between: 4 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"df_within: \", df_within, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndf_within:  295 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"MS_between:\", round(ms_between, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMS_between: 30.69 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"MS_within: \", round(ms_within, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMS_within:  1.25 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"F =\", round(f_stat, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nF = 24.52 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p =\", format(p_val, scientific = TRUE, digits = 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np = 1.55e-17 \n```\n\n\n:::\n:::\n\n\nMS_between (varijabilnost između grupa) je mnogo veća od MS_within (varijabilnost unutar grupa). F je velik, p je izuzetno mali. Grupe se značajno razlikuju.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vizualizacija: ukupna vs objašnjena varijanca\ncred_plot <- cred |>\n  left_join(group_stats |> select(news_source, group_mean = M), by = \"news_source\") |>\n  mutate(news_source = fct_reorder(news_source, group_mean))\n\ncred_plot |>\n  ggplot(aes(x = news_source, y = credibility)) +\n  geom_hline(yintercept = grand_mean, color = \"firebrick\", linewidth = 1, linetype = \"dashed\") +\n  geom_jitter(width = 0.15, alpha = 0.25, color = \"grey50\") +\n  stat_summary(fun = mean, geom = \"point\", size = 4, color = \"steelblue\") +\n  stat_summary(fun = mean, geom = \"crossbar\", width = 0.4, color = \"steelblue\", \n               fun.min = mean, fun.max = mean) +\n  annotate(\"text\", x = 0.5, y = grand_mean + 0.15, label = \"Grand mean\", \n           color = \"firebrick\", hjust = 0, fontface = \"italic\") +\n  labs(\n    title = \"ANOVA logika: razlike izmedu grupnih prosjeka vs varijabilnost unutar grupa\",\n    subtitle = \"Plavi crossbar = grupni prosjek. Crvena linija = ukupni prosjek. Sive tocke = pojedinci.\",\n    x = NULL, y = \"Vjerodostojnost (1-7)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/ss-vizualizacija-1.png){width=960}\n:::\n:::\n\n\n---\n\n## ANOVA u R-u {#sec-anova-r}\n\nR koristi funkciju `aov()` za ANOVA-u. Sintaksa je formula pristup: `aov(y ~ grupa, data = ...)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Jednosmjerna ANOVA\nmodel <- aov(credibility ~ news_source, data = cred)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nnews_source   4  122.8  30.692   24.52 <2e-16 ***\nResiduals   295  369.2   1.252                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nANOVA tablica sadrži sve elemente koje smo ručno izračunali: df, SS (Sum Sq), MS (Mean Sq), F vrijednost i p-vrijednost (Pr(>F)). Rezultat potvrđuje: postoji statistički značajna razlika u percipiranoj vjerodostojnosti ovisno o izvoru vijesti.\n\nAli ANOVA je **omnibus test**: govori da se barem dvije grupe razlikuju, ali ne govori KOJE. Za to trebamo post-hoc testove (drugi dio).\n\n---\n\n## Pretpostavke ANOVA-e {#sec-pretpostavke}\n\nANOVA ima tri pretpostavke: nezavisnost opažanja (dizajn istraživanja), normalnost distribucije unutar svake grupe (ili dovoljno velik n), homogenost varijance (jednake varijance u svim grupama).\n\n### Provjera normalnosti\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# QQ plotovi po grupi\ncred |>\n  ggplot(aes(sample = credibility)) +\n  stat_qq(color = \"steelblue\", alpha = 0.5) +\n  stat_qq_line(color = \"firebrick\") +\n  facet_wrap(~news_source) +\n  labs(\n    title = \"QQ plotovi za vjerodostojnost po izvoru vijesti\",\n    x = \"Teoretski kvantili\",\n    y = \"Opazeni kvantili\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/normalnost-1.png){width=864}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shapiro-Wilk po grupi\ncred |>\n  group_by(news_source) |>\n  summarise(\n    n = n(),\n    shapiro_W = round(shapiro.test(credibility)$statistic, 4),\n    shapiro_p = round(shapiro.test(credibility)$p.value, 4),\n    normalno = shapiro_p >= 0.05,\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 5\n  news_source         n shapiro_W shapiro_p normalno\n  <chr>           <int>     <dbl>     <dbl> <lgl>   \n1 TV                 65     0.970     0.117 TRUE    \n2 drustvena_mreza    60     0.973     0.198 TRUE    \n3 podcast            55     0.977     0.367 TRUE    \n4 tisak              55     0.975     0.309 TRUE    \n5 web_portal         65     0.992     0.964 TRUE    \n```\n\n\n:::\n:::\n\n\nNeke grupe možda ne prolaze Shapiro-Wilk test. Ali s n > 50 po grupi, ANOVA je robusna na umjerena odstupanja od normalnosti (CLT). Također možemo provjeriti normalnost **reziduala** modela:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reziduali modela\ntibble(reziduali = residuals(model)) |>\n  ggplot(aes(sample = reziduali)) +\n  stat_qq(color = \"steelblue\") +\n  stat_qq_line(color = \"firebrick\") +\n  labs(\n    title = \"QQ plot reziduala ANOVA modela\",\n    subtitle = \"Ako su reziduali normalni, pretpostavka je zadovoljena\",\n    x = \"Teoretski kvantili\",\n    y = \"Reziduali\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/normalnost-reziduali-1.png){width=768}\n:::\n:::\n\n\n### Provjera homogenosti varijance: Levenov test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rucna provjera: omjer najvece i najmanje varijance\nvar_by_group <- cred |>\n  group_by(news_source) |>\n  summarise(var = var(credibility), sd = round(sd(credibility), 2), .groups = \"drop\")\n\nvar_by_group\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  news_source       var    sd\n  <chr>           <dbl> <dbl>\n1 TV              0.963  0.98\n2 drustvena_mreza 1.63   1.27\n3 podcast         1.36   1.17\n4 tisak           1.25   1.12\n5 web_portal      1.11   1.05\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nOmjer max/min varijance:\", round(max(var_by_group$var) / min(var_by_group$var), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nOmjer max/min varijance: 1.69 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Pravilo palca: ako je omjer < 3, homogenost je prihvatljiva.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPravilo palca: ako je omjer < 3, homogenost je prihvatljiva.\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Levenov test (rucna implementacija bazirana na apsolutnim devijacijama)\ncred_levene <- cred |>\n  left_join(group_stats |> select(news_source, group_median = M), by = \"news_source\") |>\n  mutate(abs_dev = abs(credibility - group_median))\n\nlevene_anova <- aov(abs_dev ~ news_source, data = cred_levene)\nlevene_p <- summary(levene_anova)[[1]][[\"Pr(>F)\"]][1]\n\ncat(\"Levenov test (ANOVA na apsolutnim devijacijama):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevenov test (ANOVA na apsolutnim devijacijama):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p =\", round(levene_p, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np = 0.1895 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Homogenost varijance:\", if_else(levene_p >= 0.05, \"zadovoljena\", \"narusena\"), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHomogenost varijance: zadovoljena \n```\n\n\n:::\n:::\n\n\nAko je Levenov test značajan (varijance nejednake), koristimo **Welchovu ANOVA-u** koja ne pretpostavlja jednake varijance:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Welchova ANOVA (ne pretpostavlja jednake varijance)\noneway.test(credibility ~ news_source, data = cred, var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  credibility and news_source\nF = 23.513, num df = 4.00, denom df = 145.15, p-value = 5.312e-15\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usporedba klasicne i Welchove ANOVA\nklasicna <- summary(model)[[1]]\nwelch <- oneway.test(credibility ~ news_source, data = cred, var.equal = FALSE)\n\ncat(\"Klasicna ANOVA:  F(\", df_between, \",\", N - k, \") = \", \n    round(klasicna$`F value`[1], 2), \", p < 0.001\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKlasicna ANOVA:  F(4,295) = 24.52, p < 0.001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Welchova ANOVA:  F(\", welch$parameter[1], \",\", round(welch$parameter[2], 1), \n    \") = \", round(welch$statistic, 2), \", p < 0.001\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWelchova ANOVA:  F(4,145.2) = 23.51, p < 0.001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nOba pristupa daju isti zakljucak.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nOba pristupa daju isti zakljucak.\n```\n\n\n:::\n:::\n\n\n::: {.callout-tip}\n## Praktični savjet\n\nKao i kod t-testa, preporučujemo Welchovu ANOVA-u (`oneway.test(y ~ grupa, var.equal = FALSE)`) kao standardni izbor. Kad su varijance jednake, daje iste rezultate kao klasična ANOVA. Kad su nejednake, daje točnije rezultate. Klasičnu ANOVA-u (`aov()`) koristite kad trebate rezidualne dijagnostike ili post-hoc testove koji zahtijevaju `aov` objekt.\n:::\n\n---\n\n## Vizualizacija ANOVA rezultata {#sec-vizualizacija}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prosjeci s 95% CI\ncred |>\n  group_by(news_source) |>\n  summarise(\n    M = mean(credibility),\n    SE = sd(credibility) / sqrt(n()),\n    CI_lo = M - 1.96 * SE,\n    CI_hi = M + 1.96 * SE,\n    .groups = \"drop\"\n  ) |>\n  mutate(news_source = fct_reorder(news_source, M)) |>\n  ggplot(aes(x = news_source, y = M, color = news_source)) +\n  geom_point(size = 4) +\n  geom_errorbar(aes(ymin = CI_lo, ymax = CI_hi), width = 0.2, linewidth = 1) +\n  geom_hline(yintercept = grand_mean, linetype = \"dashed\", color = \"grey50\") +\n  scale_color_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Prosjeci s 95% intervalima pouzdanosti\",\n    subtitle = \"Nepreklapajuci CI sugeriraju znacajnu razliku izmedu grupa\",\n    x = NULL,\n    y = \"Percipirana vjerodostojnost (1-7)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/mean-ci-plot-1.png){width=864}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Violin plot s prosjekom\ncred |>\n  mutate(news_source = fct_reorder(news_source, credibility)) |>\n  ggplot(aes(x = news_source, y = credibility, fill = news_source)) +\n  geom_violin(alpha = 0.5) +\n  geom_boxplot(width = 0.15, fill = \"white\", outlier.shape = NA) +\n  stat_summary(fun = mean, geom = \"point\", size = 3, color = \"firebrick\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    title = \"Distribucija vjerodostojnosti po izvoru\",\n    subtitle = \"Violin = oblik distribucije. Crvena tocka = prosjek. Bijeli box = medijan i IQR.\",\n    x = NULL,\n    y = \"Vjerodostojnost (1-7)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/violin-plot-1.png){width=864}\n:::\n:::\n\n\n\n\n::: {.callout-note}\n## Podsjetnik\n\nU prvom dijelu naučili smo logiku ANOVA-e (F = varijabilnost između / varijabilnost unutar), dekompoziciju varijance (SS_total = SS_between + SS_within), pretpostavke (normalnost, homogenost varijance) i osnovno provođenje `aov()` i `oneway.test()`. ANOVA je pokazala da se grupe značajno razlikuju (p < 0.001). Sada utvrđujemo KOJE se grupe razlikuju.\n:::\n\n## Post-hoc testovi: Tukey HSD {#sec-tukey}\n\nANOVA je omnibus test: govori da se barem dvije grupe razlikuju, ali ne govori koje. **Post-hoc testovi** uspoređuju sve parove grupa uz kontrolu greške tipa I.\n\nNajčešći post-hoc test je **Tukey HSD** (Honestly Significant Difference). On testira sve parove istovremeno i prilagođava p-vrijednosti tako da ukupna greška tipa I ostane na alfa = 0.05.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncred <- read_csv(\"../resources/datasets/news_credibility.csv\")\nmodel <- aov(credibility ~ news_source, data = cred)\n\n# Tukey HSD\ntukey_rez <- TukeyHSD(model)\ntukey_rez\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = credibility ~ news_source, data = cred)\n\n$news_source\n                                 diff         lwr        upr     p adj\npodcast-drustvena_mreza     0.6316667  0.05842531  1.2049080 0.0225724\ntisak-drustvena_mreza       1.5680303  0.99478894  2.1412717 0.0000000\nTV-drustvena_mreza          1.7408974  1.19114360  2.2906513 0.0000000\nweb_portal-drustvena_mreza  0.8039744  0.25422052  1.3537282 0.0007187\ntisak-podcast               0.9363636  0.35079309  1.5219342 0.0001538\nTV-podcast                  1.1092308  0.54663279  1.6718287 0.0000013\nweb_portal-podcast          0.1723077 -0.39029029  0.7349057 0.9177070\nTV-tisak                    0.1728671 -0.38973085  0.7354651 0.9168041\nweb_portal-tisak           -0.7640559 -1.32665392 -0.2014580 0.0021451\nweb_portal-TV              -0.9369231 -1.47556963 -0.3982765 0.0000279\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preglednija tablica\ntukey_df <- as_tibble(tukey_rez$news_source, rownames = \"par\") |>\n  mutate(\n    razlika = round(diff, 2),\n    CI_lo = round(lwr, 2),\n    CI_hi = round(upr, 2),\n    p = round(`p adj`, 4),\n    znacajno = p < 0.05\n  ) |>\n  select(par, razlika, CI_lo, CI_hi, p, znacajno) |>\n  arrange(p)\n\ntukey_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n   par                        razlika CI_lo CI_hi      p znacajno\n   <chr>                        <dbl> <dbl> <dbl>  <dbl> <lgl>   \n 1 tisak-drustvena_mreza         1.57  0.99  2.14 0      TRUE    \n 2 TV-drustvena_mreza            1.74  1.19  2.29 0      TRUE    \n 3 TV-podcast                    1.11  0.55  1.67 0      TRUE    \n 4 web_portal-TV                -0.94 -1.48 -0.4  0      TRUE    \n 5 tisak-podcast                 0.94  0.35  1.52 0.0002 TRUE    \n 6 web_portal-drustvena_mreza    0.8   0.25  1.35 0.0007 TRUE    \n 7 web_portal-tisak             -0.76 -1.33 -0.2  0.0021 TRUE    \n 8 podcast-drustvena_mreza       0.63  0.06  1.2  0.0226 TRUE    \n 9 TV-tisak                      0.17 -0.39  0.74 0.917  FALSE   \n10 web_portal-podcast            0.17 -0.39  0.73 0.918  FALSE   \n```\n\n\n:::\n:::\n\n\nTablica pokazuje razliku prosjeka za svaki par, 95% CI za tu razliku i prilagođenu p-vrijednost. Značajni parovi (p < 0.05) su oni gdje CI ne uključuje nulu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vizualizacija Tukey rezultata\ntukey_df |>\n  mutate(par = fct_reorder(par, razlika)) |>\n  ggplot(aes(y = par)) +\n  geom_errorbarh(aes(xmin = CI_lo, xmax = CI_hi, color = znacajno), \n                 height = 0.3, linewidth = 1) +\n  geom_point(aes(x = razlika, color = znacajno), size = 3) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  scale_color_manual(values = c(\"TRUE\" = \"#2a9d8f\", \"FALSE\" = \"#e76f51\"),\n                     labels = c(\"TRUE\" = \"p < .05\", \"FALSE\" = \"p >= .05\")) +\n  labs(\n    title = \"Tukey HSD: razlike izmedu svih parova izvora\",\n    subtitle = \"Zeleno = znacajna razlika. CI koji ne sadrzi 0 = znacajno.\",\n    x = \"Razlika u vjerodostojnosti\",\n    y = NULL,\n    color = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/tukey-vizualizacija-1.png){width=960}\n:::\n:::\n\n\nIz grafa se jasno vide obrasci: društvena mreža ima značajno nižu vjerodostojnost od svih drugih izvora. TV i tisak nemaju značajnu razliku međusobno (oba su visoki). Podcast i web portal su u sredini.\n\n### Compact letter display\n\nČesta praksa u izvještavanju je grupiranje izvora koji se NE razlikuju značajno. To zovemo \"compact letter display\" (CLD).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rucna interpretacija Tukey rezultata u grupe\n# Grupe koje se NE razlikuju znacajno dijele isto slovo\ngroup_stats <- cred |>\n  group_by(news_source) |>\n  summarise(M = round(mean(credibility), 2), .groups = \"drop\") |>\n  arrange(desc(M))\n\ncat(\"Grupiranje izvora (isti skup slova = nema znacajne razlike):\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGrupiranje izvora (isti skup slova = nema znacajne razlike):\n```\n\n\n:::\n\n```{.r .cell-code}\n# Na temelju Tukey rezultata:\nznacajni_parovi <- tukey_df |> filter(znacajno) |> pull(par)\ncat(\"Znacajno razliciti parovi:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nZnacajno razliciti parovi:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (p in znacajni_parovi) cat(\"  \", p, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   tisak-drustvena_mreza \n   TV-drustvena_mreza \n   TV-podcast \n   web_portal-TV \n   tisak-podcast \n   web_portal-drustvena_mreza \n   web_portal-tisak \n   podcast-drustvena_mreza \n```\n\n\n:::\n:::\n\n\n---\n\n## Veličina učinka: eta-kvadrat {#sec-eta}\n\nKao i kod t-testa, p-vrijednost ne govori koliko je učinak velik. **Eta-kvadrat** (eta2) je mjera veličine učinka za ANOVA-u:\n\n$$\\eta^2 = \\frac{SS_{between}}{SS_{total}}$$\n\nEta-kvadrat je proporcija ukupne varijabilnosti koja je objašnjena grupnom pripadnošću. Interpretira se kao R-kvadrat u regresiji.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Iz ANOVA tablice\nanova_table <- summary(model)[[1]]\nss_between <- anova_table$`Sum Sq`[1]\nss_within <- anova_table$`Sum Sq`[2]\nss_total <- ss_between + ss_within\n\neta2 <- ss_between / ss_total\n\ncat(\"SS_between:\", round(ss_between, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSS_between: 122.8 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SS_total:  \", round(ss_total, 1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSS_total:   492 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Eta-kvadrat:\", round(eta2, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEta-kvadrat: 0.25 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Interpretacija:\", round(eta2 * 100, 1), \"% varijabilnosti u vjerodostojnosti\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInterpretacija: 25 % varijabilnosti u vjerodostojnosti\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"je objasnjeno izvorom vijesti.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nje objasnjeno izvorom vijesti.\n```\n\n\n:::\n:::\n\n\n### Interpretacija eta-kvadrata\n\nCohen (1988) je predložio smjernice:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntribble(\n  ~eta2, ~interpretacija,\n  \"0.01\", \"Mali ucinak\",\n  \"0.06\", \"Srednji ucinak\",\n  \"0.14\", \"Veliki ucinak\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  eta2  interpretacija\n  <chr> <chr>         \n1 0.01  Mali ucinak   \n2 0.06  Srednji ucinak\n3 0.14  Veliki ucinak \n```\n\n\n:::\n:::\n\n\nNaš eta2 ≈ 0.25 je veliki učinak. Izvor vijesti objašnjava značajan dio varijabilnosti u percipiranoj vjerodostojnosti.\n\n### Omega-kvadrat: manje pristrana mjera\n\nEta-kvadrat je pristran (precjenjuje veličinu učinka u populaciji). **Omega-kvadrat** je manje pristrana alternativa:\n\n$$\\omega^2 = \\frac{SS_{between} - (k-1) \\cdot MS_{within}}{SS_{total} + MS_{within}}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nms_within <- anova_table$`Mean Sq`[2]\nk <- length(unique(cred$news_source))\n\nomega2 <- (ss_between - (k - 1) * ms_within) / (ss_total + ms_within)\n\ncat(\"Eta-kvadrat:  \", round(eta2, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEta-kvadrat:   0.25 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Omega-kvadrat:\", round(omega2, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOmega-kvadrat: 0.239 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Razlika je mala za velike uzorke, ali omega2 je tocnija procjena.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRazlika je mala za velike uzorke, ali omega2 je tocnija procjena.\n```\n\n\n:::\n:::\n\n\n::: {.callout-tip}\n## Praktični savjet\n\nIzvijestite eta-kvadrat (jer je poznatiji) ili omega-kvadrat (jer je manje pristran). Za objavljivanje u časopisima, sve češće se traži omega-kvadrat. U praksi, za n > 50 po grupi, razlika je minimalna.\n:::\n\n---\n\n## Planirane usporedbe {#sec-kontrasti}\n\nPonekad unaprijed znamo koje usporedbe nas zanimaju. Umjesto da uspoređujemo sve parove (Tukey), možemo specificirati **planirane usporedbe** (contrasts). Ovo je snažniji pristup jer testira manje hipoteza.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Planirana usporedba 1: tradicionalni (TV + tisak) vs digitalni (portal + mreza + podcast)\ncred <- cred |>\n  mutate(tip_medija = if_else(\n    news_source %in% c(\"TV\", \"tisak\"), \"tradicionalni\", \"digitalni\"\n  ))\n\nt.test(credibility ~ tip_medija, data = cred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  credibility by tip_medija\nt = -8.9741, df = 278.64, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group digitalni and group tradicionalni is not equal to 0\n95 percent confidence interval:\n -1.436806 -0.919861\nsample estimates:\n    mean in group digitalni mean in group tradicionalni \n                   3.971667                    5.150000 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cohenov d za ovu usporedbu\ntrad <- cred |> filter(tip_medija == \"tradicionalni\") |> pull(credibility)\ndig <- cred |> filter(tip_medija == \"digitalni\") |> pull(credibility)\ns_p <- sqrt(((length(trad)-1)*sd(trad)^2 + (length(dig)-1)*sd(dig)^2) / (length(trad)+length(dig)-2))\nd_td <- (mean(trad) - mean(dig)) / s_p\n\ncat(\"Tradicionalni M:\", round(mean(trad), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTradicionalni M: 5.15 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Digitalni M:\", round(mean(dig), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDigitalni M: 3.97 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Cohenov d:\", round(d_td, 2), \"(veliki ucinak)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCohenov d: 1.03 (veliki ucinak)\n```\n\n\n:::\n:::\n\n\nPlanirana usporedba (tradicionalni vs digitalni) daje jasnu sliku: tradicionalni mediji imaju značajno višu percipiranu vjerodostojnost od digitalnih.\n\n---\n\n## Kruskal-Wallisov test {#sec-kruskal}\n\n**Kruskal-Wallisov test** je neparametrijska alternativa jednosmjernoj ANOVA-i. Koristi rangove umjesto izvornih vrijednosti i ne pretpostavlja normalnost.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Kruskal-Wallis test\nkw_test <- kruskal.test(credibility ~ news_source, data = cred)\nkw_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  credibility by news_source\nKruskal-Wallis chi-squared = 70.893, df = 4, p-value = 1.471e-14\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usporedba ANOVA i Kruskal-Wallis\ncat(\"Klasicna ANOVA:    F = \", round(summary(model)[[1]]$`F value`[1], 2), \n    \", p < 0.001\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKlasicna ANOVA:    F = 24.52, p < 0.001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Kruskal-Wallis:    H = \", round(kw_test$statistic, 2), \n    \", p < 0.001\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKruskal-Wallis:    H = 70.89, p < 0.001\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nOba testa daju isti zakljucak.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nOba testa daju isti zakljucak.\n```\n\n\n:::\n:::\n\n\n### Post-hoc za Kruskal-Wallis: Dunn test\n\nKruskal-Wallis test je omnibus. Za identifikaciju specifičnih razlika koristimo **Dunnov test** (neparametrijski ekvivalent Tukeyu).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pairwise Wilcoxon s Bonferroni korekcijom (ugraden u R)\npw_wilcox <- pairwise.wilcox.test(cred$credibility, cred$news_source, \n                                   p.adjust.method = \"BH\")\npw_wilcox\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  cred$credibility and cred$news_source \n\n           drustvena_mreza podcast tisak   TV     \npodcast    0.02530         -       -       -      \ntisak      3.0e-08         0.00019 -       -      \nTV         7.3e-11         1.8e-06 0.40500 -      \nweb_portal 0.00128         0.40500 0.00048 3.4e-06\n\nP value adjustment method: BH \n```\n\n\n:::\n:::\n\n\n---\n\n## Potpuna analiza: izvještaj {#sec-analiza}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Kompletna opisna statistika\ncred |>\n  group_by(news_source) |>\n  summarise(\n    n = n(),\n    M = round(mean(credibility), 2),\n    SD = round(sd(credibility), 2),\n    Median = median(credibility),\n    SE = round(sd(credibility) / sqrt(n()), 2),\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(M))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 6\n  news_source         n     M    SD Median    SE\n  <chr>           <int> <dbl> <dbl>  <dbl> <dbl>\n1 TV                 65  5.23  0.98   5.4   0.12\n2 tisak              55  5.06  1.12   5.1   0.15\n3 web_portal         65  4.29  1.05   4.3   0.13\n4 podcast            55  4.12  1.17   4     0.16\n5 drustvena_mreza    60  3.49  1.27   3.65  0.16\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Moderacija: medijska pismenost\ncred |>\n  mutate(\n    news_source = fct_reorder(news_source, credibility),\n    media_literacy = factor(media_literacy, levels = c(\"niska\", \"srednja\", \"visoka\"))\n  ) |>\n  group_by(news_source, media_literacy) |>\n  summarise(M = mean(credibility), SE = sd(credibility)/sqrt(n()), .groups = \"drop\") |>\n  ggplot(aes(x = news_source, y = M, color = media_literacy, group = media_literacy)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 3) +\n  geom_errorbar(aes(ymin = M - 1.96 * SE, ymax = M + 1.96 * SE), width = 0.15) +\n  scale_color_manual(values = c(\"niska\" = \"#e76f51\", \"srednja\" = \"#e9c46a\", \"visoka\" = \"#2a9d8f\")) +\n  labs(\n    title = \"Vjerodostojnost po izvoru i razini medijske pismenosti\",\n    subtitle = \"Medijski pismeniji ispitanici manje vjeruju drustvenim mrezama\",\n    x = NULL,\n    y = \"Percipirana vjerodostojnost (1-7)\",\n    color = \"Medijska pismenost\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](week-13_files/figure-html/analiza-moderacija-1.png){width=960}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA unutar svake dobne skupine\ncred |>\n  group_by(age_group) |>\n  summarise(\n    F_val = round(summary(aov(credibility ~ news_source))[[1]]$`F value`[1], 2),\n    p = summary(aov(credibility ~ news_source))[[1]]$`Pr(>F)`[1],\n    eta2 = {\n      a <- summary(aov(credibility ~ news_source))[[1]]\n      round(a$`Sum Sq`[1] / sum(a$`Sum Sq`), 3)\n    },\n    .groups = \"drop\"\n  ) |>\n  mutate(p = format(p, scientific = TRUE, digits = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  age_group F_val p        eta2\n  <chr>     <dbl> <chr>   <dbl>\n1 18-29      6.36 1.6e-04 0.233\n2 30-44     10.1  6.5e-07 0.286\n3 45-59      6.2  2.8e-04 0.276\n4 60+        3.49 1.9e-02 0.317\n```\n\n\n:::\n:::\n\n\nEfekt izvora na vjerodostojnost je značajan u svim dobnim skupinama, ali eta-kvadrat varira. Ovo sugerira da je obrazac (TV > tisak > portal > podcast > mreža) konzistentan, ali jačina razlika može varirati po dobi.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"================================================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   APA IZVJESTAJ: PERCIPIRANA VJERODOSTOJNOST PO IZVORU\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   APA IZVJESTAJ: PERCIPIRANA VJERODOSTOJNOST PO IZVORU\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"================================================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Jednosmjerna ANOVA pokazala je statisticki znacajnu razliku u\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nJednosmjerna ANOVA pokazala je statisticki znacajnu razliku u\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"percipiranoj vjerodostojnosti vijesti ovisno o izvoru,\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npercipiranoj vjerodostojnosti vijesti ovisno o izvoru,\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"F(\", k-1, \", \", nrow(cred)-k, \") = \", \n    round(summary(model)[[1]]$`F value`[1], 2), \n    \", p < .001, eta2 = \", round(eta2, 2), \".\\n\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nF(4, 295) = 24.52, p < .001, eta2 = 0.25.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Tukey HSD post-hoc testovi pokazali su da:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTukey HSD post-hoc testovi pokazali su da:\n```\n\n\n:::\n\n```{.r .cell-code}\nznac <- tukey_df |> filter(znacajno)\nfor (i in 1:nrow(znac)) {\n  r <- znac[i, ]\n  cat(\"  \", r$par, \": razlika = \", r$razlika, \n      \", 95% CI [\", r$CI_lo, \", \", r$CI_hi, \"], p = \", \n      if_else(r$p < 0.001, \"< .001\", as.character(round(r$p, 3))), \"\\n\", sep = \"\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  tisak-drustvena_mreza: razlika = 1.57, 95% CI [0.99, 2.14], p = < .001\n  TV-drustvena_mreza: razlika = 1.74, 95% CI [1.19, 2.29], p = < .001\n  TV-podcast: razlika = 1.11, 95% CI [0.55, 1.67], p = < .001\n  web_portal-TV: razlika = -0.94, 95% CI [-1.48, -0.4], p = < .001\n  tisak-podcast: razlika = 0.94, 95% CI [0.35, 1.52], p = < .001\n  web_portal-drustvena_mreza: razlika = 0.8, 95% CI [0.25, 1.35], p = < .001\n  web_portal-tisak: razlika = -0.76, 95% CI [-1.33, -0.2], p = 0.002\n  podcast-drustvena_mreza: razlika = 0.63, 95% CI [0.06, 1.2], p = 0.023\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nTV (M = \", round(mean(cred$credibility[cred$news_source == \"TV\"]), 2), \n    \") i tisak (M = \", round(mean(cred$credibility[cred$news_source == \"tisak\"]), 2),\n    \") imaju\\nnajvisu vjerodostojnost. Drustvena mreza (M = \", \n    round(mean(cred$credibility[cred$news_source == \"drustvena_mreza\"]), 2),\n    \") ima najnizu.\\n\", sep = \"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nTV (M = 5.23) i tisak (M = 5.06) imaju\nnajvisu vjerodostojnost. Drustvena mreza (M = 3.49) ima najnizu.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Medijska pismenost moderira efekt: visoko pismeni\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMedijska pismenost moderira efekt: visoko pismeni\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"ispitanici manje vjeruju vijestima s drustvenih mreza.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nispitanici manje vjeruju vijestima s drustvenih mreza.\n```\n\n\n:::\n:::\n\n\n---\n\n## Dijagram odlučivanja: ANOVA ili nešto drugo? {#sec-dijagram}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntribble(\n  ~situacija, ~test,\n  \"Dvije nezavisne grupe\", \"Nezavisni t-test (tjedan 12)\",\n  \"Dvije uparene grupe\", \"Upareni t-test (tjedan 12)\",\n  \"Tri+ nezavisne grupe, normalni podaci\", \"Jednosmjerna ANOVA + Tukey HSD\",\n  \"Tri+ nezavisne grupe, nejednake varijance\", \"Welchova ANOVA + Games-Howell\",\n  \"Tri+ nezavisne grupe, nenormalni/ordinalni\", \"Kruskal-Wallis + Dunn\",\n  \"Tri+ uparene grupe\", \"Repeated measures ANOVA (napredno)\",\n  \"Dva faktora istovremeno\", \"Dvosmjerna ANOVA (napredno)\",\n  \"Kategoricka x kategoricka varijabla\", \"Hi-kvadrat test (tjedan 11)\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 2\n  situacija                                  test                              \n  <chr>                                      <chr>                             \n1 Dvije nezavisne grupe                      Nezavisni t-test (tjedan 12)      \n2 Dvije uparene grupe                        Upareni t-test (tjedan 12)        \n3 Tri+ nezavisne grupe, normalni podaci      Jednosmjerna ANOVA + Tukey HSD    \n4 Tri+ nezavisne grupe, nejednake varijance  Welchova ANOVA + Games-Howell     \n5 Tri+ nezavisne grupe, nenormalni/ordinalni Kruskal-Wallis + Dunn             \n6 Tri+ uparene grupe                         Repeated measures ANOVA (napredno)\n7 Dva faktora istovremeno                    Dvosmjerna ANOVA (napredno)       \n8 Kategoricka x kategoricka varijabla        Hi-kvadrat test (tjedan 11)       \n```\n\n\n:::\n:::\n\n\n---\n\n::: {.callout-important}\n## Ključni zaključci\n\n1. ANOVA uspoređuje prosjeke tri ili više grupa jednim testom, kontrolirajući grešku tipa I. Višestruki t-testovi inflacioniraju alfa i nisu prihvatljivi.\n\n2. F statistika = MS_between / MS_within. Velik F znači da su razlike između grupa veće od varijabilnosti unutar grupa.\n\n3. Dekompozicija varijance: SS_total = SS_between + SS_within. ANOVA testira je li SS_between dovoljno velik u odnosu na SS_total.\n\n4. ANOVA je omnibus test: govori da razlika postoji, ali ne govori KOJE se grupe razlikuju. Post-hoc testovi identificiraju specifične parove.\n\n5. Tukey HSD (`TukeyHSD(model)`) uspoređuje sve parove uz kontrolu ukupne greške tipa I. Daje razlike, CI i prilagođene p-vrijednosti za svaki par.\n\n6. Eta-kvadrat = SS_between / SS_total. Proporcija varijabilnosti objašnjena grupom. Smjernice: 0.01 mali, 0.06 srednji, 0.14 veliki učinak. Omega-kvadrat je manje pristrana alternativa.\n\n7. Pretpostavke: nezavisnost, normalnost unutar grupa (ili n > 30), homogenost varijance. Welchova ANOVA (`oneway.test(var.equal = FALSE)`) ne zahtijeva jednake varijance.\n\n8. Kruskal-Wallisov test (`kruskal.test()`) je neparametrijska alternativa. Koristi rangove. Post-hoc: `pairwise.wilcox.test()` s BH korekcijom.\n\n9. Planirane usporedbe (contrasts) su snažniji pristup kad unaprijed znate koje grupe želite usporediti (npr. tradicionalni vs digitalni mediji).\n\n10. APA format za ANOVA-u: F(df_between, df_within) = vrijednost, p, eta2. Post-hoc razlike s CI.\n\n11. Moderacijska analiza (ANOVA po podgrupama treće varijable) otkriva je li obrazac konzistentan ili varira ovisno o nekoj trećoj varijabli (npr. medijska pismenost, dob).\n\n12. Za dva faktora istovremeno (npr. izvor x dob) koristite dvosmjernu ANOVA-u. Za uparena mjerenja kroz tri+ uvjeta koristite repeated measures ANOVA-u. Ovo su napredni pristupi izvan dosega ovog kolegija.\n:::\n\n---\n\n## Zadaci za pripremu\n\n1. Učitajte `news_credibility.csv`. Provedite jednosmjernu ANOVA-u za varijablu `trust_general` po `news_source`. Izračunajte eta-kvadrat i provedite Tukey HSD. Koji se parovi izvora značajno razlikuju?\n\n2. Provedite Kruskal-Wallisov test za `share_intent` po `news_source`. Usporedite rezultat s klasičnom ANOVA-om. Jesu li zaključci konzistentni?\n\n3. Testirajte planiranu usporedbu: razlikuje li se `credibility` između tri razine medijske pismenosti (`media_literacy`)? Koji par se razlikuje prema Tukey HSD testu?\n\n---\n\n## Dodatno čitanje\n\n**Obavezno**\n\nNavarro, D. (2018). *Learning Statistics with R*, Chapter 14 (Comparing Several Means). Besplatno dostupno na [learningstatisticswithr.com](https://learningstatisticswithr.com/lsr-0.6.pdf). Pokriva jednosmjernu ANOVA-u, post-hoc testove i veličinu učinka.\n\n**Preporučeno**\n\nField, A. (2018). *Discovering Statistics Using R*. SAGE. Poglavlje 10. Detaljna obrada ANOVA-e s dijagnostikom i vizualizacijama.\n\nMaxwell, S. E., Delaney, H. D., & Kelley, K. (2018). *Designing Experiments and Analyzing Data* (3rd edition). Routledge. Referentni udžbenik za eksperimentalne dizajne i ANOVA-u.\n\n---\n\n## Pojmovnik\n\n| Pojam | Objašnjenje |\n|---|---|\n| ANOVA | Analysis of Variance. Omnibus test za usporedbu prosjeka tri ili više grupa. |\n| Jednosmjerna ANOVA | ANOVA s jednim faktorom (jednom nezavisnom varijablom). |\n| F statistika | Omjer MS_between / MS_within. F >> 1 sugerira značajne razlike između grupa. |\n| SS (Sum of Squares) | Mjera varijabilnosti. SS_total = SS_between + SS_within. |\n| MS (Mean Square) | SS / df. MS_between = SS_between / (k-1). MS_within = SS_within / (N-k). |\n| Omnibus test | Test koji detektira da razlika postoji negdje, ali ne govori gdje specifično. |\n| Post-hoc test | Test koji se provodi NAKON značajne ANOVA-e za identifikaciju specifičnih razlika. |\n| Tukey HSD | Post-hoc test koji uspoređuje sve parove grupa uz kontrolu ukupne greške tipa I. |\n| Eta-kvadrat | SS_between / SS_total. Proporcija varijabilnosti objašnjena grupnom pripadnošću. 0.01/0.06/0.14 mali/srednji/veliki. |\n| Omega-kvadrat | Manje pristrana alternativa eta-kvadratu. Preporučena za publikacije. |\n| Inflacija alfa | Porast greške tipa I pri višestrukim usporedbama. ANOVA to kontrolira. |\n| Homogenost varijance | Pretpostavka jednakih varijanci u svim grupama. Levenov test je provjerava. |\n| Welchova ANOVA | `oneway.test(var.equal = FALSE)`. ANOVA koja ne zahtijeva jednake varijance. |\n| Kruskal-Wallisov test | Neparametrijska alternativa jednosmjernoj ANOVA-i. Koristi rangove. `kruskal.test()`. |\n| Dunnov test | Post-hoc test za Kruskal-Wallis. Neparametrijski ekvivalent Tukeyu. |\n| Planirane usporedbe | Unaprijed definirane specifične usporedbe. Snažniji od post-hoc testova jer testiraju manje hipoteza. |\n| `aov()` | R funkcija za klasičnu ANOVA-u. `aov(y ~ grupa, data = ...)`. |\n| `TukeyHSD()` | R funkcija za Tukey post-hoc test. Prima `aov()` objekt. |\n| `oneway.test()` | R funkcija za Welchovu ANOVA-u. `var.equal = FALSE` za robusnu verziju. |\n| `kruskal.test()` | R funkcija za Kruskal-Wallisov test. Sintaksa kao `aov()`. |\n| `pairwise.wilcox.test()` | R funkcija za parwise Wilcoxon testove s korekcijom p-vrijednosti. |\n",
    "supporting": [
      "week-13_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}